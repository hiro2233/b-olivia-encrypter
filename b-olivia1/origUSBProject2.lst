MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 
                      00002 ; PICBASIC PRO(TM) Compiler 2.60, (c) 1998, 2009 microEngineering Labs, Inc. All Rights Reserved. 
  00000001            00003 _USED                   EQU     1
                      00004 
                      00005         INCLUDE "C:\PBP\18F2550.INC"
                      00001 ;****************************************************************
                      00002 ;*  18F2550.INC                                                 *
                      00003 ;*                                                              *
                      00004 ;*  By        : Leonard Zerman, Jeff Schmoyer                   *
                      00005 ;*  Notice    : Copyright (c) 2009 microEngineering Labs, Inc.  *
                      00006 ;*              All Rights Reserved                             *
                      00007 ;*  Date      : 03/20/09                                        *
                      00008 ;*  Version   : 2.60                                            *
                      00009 ;*  Notes     :                                                 *
                      00010 ;****************************************************************
                      00017         LIST
                      00018         LIST p = 18F2550, r = dec, w = -311, w = -230, f = inhx32
                      00019         INCLUDE "P18F2550.INC"  ; MPASM  Header
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC18F2550 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2007 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01486         LIST
                      00020         __CONFIG    _CONFIG1L, _PLLDIV_5_1L & _CPUDIV_OSC1_PLL2_1L & _USBDIV_2_1L
300000 3EE4           00021         __CONFIG    _CONFIG1H, _FOSC_HSPLL_HS_1H & _FCMEN_OFF_1H & _IESO_OFF_1H
                      00022         __CONFIG    _CONFIG2L, _PWRT_OFF_2L & _BOR_ON_2L & _BORV_3_2L & _VREGEN_ON_2L
300002 F3FF           00023         __CONFIG    _CONFIG2H, _WDT_ON_2H & _WDTPS_512_2H
300004 F9FF           00024         __CONFIG    _CONFIG3H, _CCP2MX_ON_3H & _PBADEN_OFF_3H & _LPT1OSC_OFF_3H & _MCLRE_ON_3H
300006 FFBB           00025         __CONFIG    _CONFIG4L, _STVREN_ON_4L & _LVP_OFF_4L & _XINST_OFF_4L
                      00028         LIST
  00F00000            00029 EEPROM_START    EQU     0F00000h
  00000020            00030 BLOCK_SIZE      EQU     32
                      00006 
                      00007 
                      00008 ; Define statements.
                      00009 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00010   DEFINE OSC 48
                      00010 #define         OSC              48
                      00011 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00011   DEFINE RESET_ORG 1000h
                      00012 #define         RESET_ORG                1000h
                      00013 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00029   DEFINE DEBUG_REG PORTA 
                      00014 #define         DEBUG_REG                PORTA 
                      00015 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00032   DEFINE DEBUG_BIT 0 
                      00016 #define         DEBUG_BIT                0 
                      00017 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00035   DEFINE DEBUG_BAUD 9600
                      00018 #define         DEBUG_BAUD               9600
                      00019 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00038   DEFINE DEBUG_MODE 1
                      00020 #define         DEBUG_MODE               1
                      00021 
  00000000            00022 RAM_START                       EQU     00000h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000007FF            00023 RAM_END                         EQU     007FFh
  00000008            00024 RAM_BANKS                       EQU     00008h
  00000060            00025 BANK0_START                     EQU     00060h
  000000FF            00026 BANK0_END                       EQU     000FFh
  00000100            00027 BANK1_START                     EQU     00100h
  000001FF            00028 BANK1_END                       EQU     001FFh
  00000200            00029 BANK2_START                     EQU     00200h
  000002FF            00030 BANK2_END                       EQU     002FFh
  00000300            00031 BANK3_START                     EQU     00300h
  000003FF            00032 BANK3_END                       EQU     003FFh
  00000400            00033 BANK4_START                     EQU     00400h
  000004FF            00034 BANK4_END                       EQU     004FFh
  00000500            00035 BANK5_START                     EQU     00500h
  000005FF            00036 BANK5_END                       EQU     005FFh
  00000600            00037 BANK6_START                     EQU     00600h
  000006FF            00038 BANK6_END                       EQU     006FFh
  00000700            00039 BANK7_START                     EQU     00700h
  000007FF            00040 BANK7_END                       EQU     007FFh
  00000000            00041 BANKA_START                     EQU     00000h
  0000005F            00042 BANKA_END                       EQU     0005Fh
                      00043 
                      00044 ; C:\PBP\PBPPIC18.RAM           00028   A00000  FLAGS   VAR     BYTE BANKA SYSTEM       ' Static flags
  00000000            00045 FLAGS                           EQU     RAM_START + 000h
                      00046 ; C:\PBP\PBPPIC18.RAM           00012   A00001  R0      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000001            00047 R0                              EQU     RAM_START + 001h
                      00048 ; C:\PBP\PBPPIC18.RAM           00013   A00003  R1      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000003            00049 R1                              EQU     RAM_START + 003h
                      00050 ; C:\PBP\PBPPIC18.RAM           00014   A00005  R2      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000005            00051 R2                              EQU     RAM_START + 005h
                      00052 ; C:\PBP\PBPPIC18.RAM           00015   A00007  R3      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000007            00053 R3                              EQU     RAM_START + 007h
                      00054 ; C:\PBP\PBPPIC18.RAM           00016   A00009  R4      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000009            00055 R4                              EQU     RAM_START + 009h
                      00056 ; C:\PBP\PBPPIC18.RAM           00017   A0000B  R5      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  0000000B            00057 R5                              EQU     RAM_START + 00Bh
                      00058 ; C:\PBP\PBPPIC18.RAM           00018   A0000D  R6      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  0000000D            00059 R6                              EQU     RAM_START + 00Dh
                      00060 ; C:\PBP\PBPPIC18.RAM           00019   A0000F  R7      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  0000000F            00061 R7                              EQU     RAM_START + 00Fh
                      00062 ; C:\PBP\PBPPIC18.RAM           00020   A00011  R8      VAR     WORD BANKA SYSTEM       ' System Registe
                            r
  00000011            00063 R8                              EQU     RAM_START + 011h
                      00064 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00001   A00013  ' ******************************
                            ******************************
  00000013            00065 T1                              EQU     RAM_START + 013h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00066 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00001   A00015  ' ******************************
                            ******************************
  00000015            00067 T2                              EQU     RAM_START + 015h
                      00068 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00001   A00017  ' ******************************
                            ******************************
  00000017            00069 T3                              EQU     RAM_START + 017h
                      00070 ; C:\PBP\PBPPIC18.RAM           00027   A00019  GOP     VAR     BYTE BANKA SYSTEM       ' Gen Op Paramet
                            er
  00000019            00071 GOP                             EQU     RAM_START + 019h
                      00072 ; C:\PBP\PBPPIC18.RAM           00023   A0001A  RM1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Mask
  0000001A            00073 RM1                             EQU     RAM_START + 01Ah
                      00074 ; C:\PBP\PBPPIC18.RAM           00026   A0001B  RM2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Mask
  0000001B            00075 RM2                             EQU     RAM_START + 01Bh
                      00076 ; C:\PBP\PBPPIC18.RAM           00021   A0001C  RR1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Register
  0000001C            00077 RR1                             EQU     RAM_START + 01Ch
                      00078 ; C:\PBP\PBPPIC18.RAM           00024   A0001D  RR2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Register
  0000001D            00079 RR2                             EQU     RAM_START + 01Dh
                      00080 ; C:\PBP\PBPPIC18.RAM           00022   A0001E  RS1     VAR     BYTE BANKA SYSTEM       ' Pin 1 Bank
  0000001E            00081 RS1                             EQU     RAM_START + 01Eh
                      00082 ; C:\PBP\PBPPIC18.RAM           00025   A0001F  RS2     VAR     BYTE BANKA SYSTEM       ' Pin 2 Bank
  0000001F            00083 RS2                             EQU     RAM_START + 01Fh
                      00084 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00001   A00020  ' ******************************
                            ******************************
  00000020            00085 PB01                            EQU     RAM_START + 020h
                      00086 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00048   A00021  aux var byte
  00000021            00087 _aux                            EQU     RAM_START + 021h
                      00088 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00045   A00022  i var byte
  00000022            00089 _i                              EQU     RAM_START + 022h
                      00090 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00051   A00023  pos var byte
  00000023            00091 _pos                            EQU     RAM_START + 023h
                      00092 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00050   A00024  sw1 var byte
  00000024            00093 _sw1                            EQU     RAM_START + 024h
                      00094 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00047   A00025  temp var byte
  00000025            00095 _temp                           EQU     RAM_START + 025h
                      00096 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00026   A00026  USBBufferCount   Var Byte 
  00000026            00097 _USBBufferCount                 EQU     RAM_START + 026h
                      00098 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00049   A00027  var1 var byte
  00000027            00099 _var1                           EQU     RAM_START + 027h
                      00100 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00025   A00028  USBBuffer        Var Byte[USBBuf
                            ferSizeMax] 
  00000028            00101 _USBBuffer                      EQU     RAM_START + 028h
                      00102 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00024   A00030  USBBufferaux        Var Byte[USB
                            BufferSizeMax + 1]
  00000030            00103 _USBBufferaux                   EQU     RAM_START + 030h
                      00104 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\DESCUSBPROJECT.BAS 00005   A00400  USBReservedMemory Var Byte[USBME
                            MORYSIZE] USBMEMORYADDRESS      ' Reserve memory used by USB assembler code
  00000400            00105 _USBReservedMemory              EQU     RAM_START + 00400h
                      00106 ; C:\PBP\18F2550.BAS            00026   PORTL   VAR     PORTB
  00000F81            00107 _PORTL                          EQU      PORTB
                      00108 ; C:\PBP\18F2550.BAS            00027   PORTH   VAR     PORTC
  00000F82            00109 _PORTH                          EQU      PORTC
                      00110 ; C:\PBP\18F2550.BAS            00028   TRISL   VAR     TRISB
  00000F93            00111 _TRISL                          EQU      TRISB
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00112 ; C:\PBP\18F2550.BAS            00029   TRISH   VAR     TRISC
  00000F94            00113 _TRISH                          EQU      TRISC
                      00114 #define _pin1                    PB01, 000h
                      00115 #define _PORTB??3                PORTB, 003h
                      00116 #define _PORTB??2                PORTB, 002h
                      00117 #define _PORTB??1                PORTB, 001h
                      00118 #define _PORTB??0                PORTB, 000h
                      00119 #define _PORTB??4                PORTB, 004h
                      00120 #define _PORTB??5                PORTB, 005h
                      00121 #define _PORTB??6                PORTB, 006h
                      00122 #define _PORTB??7                PORTB, 007h
                      00123 
                      00124 ; Constants.
  00000400            00125 _USBMEMORYADDRESS               EQU     00400h
  00000100            00126 _USBMEMORYSIZE                  EQU     00100h
  00000008            00127 _USBBufferSizeMax               EQU     00008h
  00000008            00128 _USBBufferSizeTX                EQU     00008h
  00000008            00129 _USBBufferSizeRX                EQU     00008h
                      00130 
                      00131 ; EEPROM data.
                      00132 
                      00133 
                      00134         INCLUDE "ORIGUS~1.MAC"
                      00001 
                      00408         LIST
                      00135         INCLUDE "C:\PBP\PBPPIC18.LIB"
                      00001 ;******************************************************************
                      00002 ;*  PBPPIC18.LIB                                                  *
                      00003 ;*                                                                *
                      00004 ;*  By        : Leonard Zerman, Jeff Schmoyer                     *
                      00005 ;*  Notice    : Copyright (c) 2009 microEngineering Labs, Inc.    *
                      00006 ;*              All Rights Reserved                               *
                      00007 ;*  Date      : 07/08/09                                          *
                      00008 ;*  Version   : 2.60                                              *
                      00009 ;*  Notes     :                                                   *
                      00010 ;******************************************************************
                      00128   LIST
                      00129 ; Oscillator is 48MHz
                      01182   LIST
001000                01183     ORG RESET_ORG               ; Reset vector at 0
                      01192   LIST
001000 EFB9 F008      01193         goto    INIT            ; Finish initialization
                      01634   LIST
001004 50E9           01635 DEBUGJ  movf    FSR0L, W        ; Jumpman entry
                      01641   LIST
001006 6E03           01642 DEBUG   movwf   R1              ; Save data to send
001008 9092           01643         bcf     (DEBUG_REG) + 12h, DEBUG_BIT    ; Set pin to output
00100A 0E09           01644         movlw   9               ; 1 start bit + 8 data bits
00100C 6E04           01645         movwf   R1 + 1
00100E 90D8           01646         bcf     STATUS, C       ; Start bit low
001010 D808           01647 debugloop rcall debugbit        ; 9 (13) Send the bit
001012 3203           01648         rrcf    R1, F           ; 1 Move to next bit
001014 2E04           01649         decfsz  R1 + 1, F       ; 1 / 2 Do next bit, if any
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001016 D7FC           01650         bra     debugloop       ; 2 / 0
001018 80D8           01651         bsf     STATUS, C       ; 1 Stop bit high
00101A D803           01652         rcall   debugbit        ; 9 Send stop bit
                      01653       ifdef DEBUG_PACING
                      01654         movlw   (DEBUG_PACING) >> 8
                      01655         movwf   R0 + 1
                      01656         movlw   low (DEBUG_PACING)
                      01657         call    PAUSEUSL        ; Delay for character pacing
                      01658       endif
00101C 80D8           01659         bsf     STATUS, C       ; Set no timeout for Serout2mod
00101E EFB6 F008      01660         goto    DUNN
                      01661 
001022 B0D8           01662 debugbit btfsc  STATUS, C       ; 1 / 2 (7) Bit on or off?
001024 D003           01663         bra     debugbh         ; 2
001026 0000           01664         nop                     ; 1 Nominalize time
                      01665       if (DEBUG_MODE == 1)
001028 8080           01666         bsf     DEBUG_REG, DEBUG_BIT    ; 1 Set inverted low bit
                      01667       else
                      01668         bcf     DEBUG_REG, DEBUG_BIT    ; 1 Set true low bit
                      01669       endif
00102A D002           01670         bra     debugdelay      ; 3 Delay rest of bit time
00102C                01671 debugbh
                      01672       if (DEBUG_MODE == 1)
00102C 9080           01673         bcf     DEBUG_REG, DEBUG_BIT    ; 1 Set inverted high bit
                      01674       else
                      01675         bsf     DEBUG_REG, DEBUG_BIT    ; 1 Set true high bit
                      01676       endif
00102E D000           01677         bra     debugdelay      ; 3 Delay rest of bit time
                      01783   LIST
001030 0E00           01784 debugdelay movlw (DEBUG_DELAY) >> 8     ; 1 (1) Delay rest of bit time
001032 6E02           01785         movwf   R0 + 1          ; 1
001034 0E67           01786         movlw   low (DEBUG_DELAY)       ; 1
001036 EF4E F008      01787         goto    PAUSEUSL        ; -2 (PAUSEUSL gives you 2 less than you ask for)
                      05075   LIST
00103A 9E19           05076 SEROUT2HEX bcf  GOP, 7          ; Blanking off
00103C 500A           05077         movf    R4 + 1, W       ; If 0 digits called for then blanking on
00103E B4D8           05078         btfsc   STATUS, Z
001040 8E19           05079         bsf     GOP, 7          ; Blanking on
001042 0E04           05080         movlw   4               ; 4 nibbles max to do
001044 6E09           05081         movwf   R4
001046 3806           05082         swapf   R2 + 1, W       ; Get first nibble
001048 D805           05083         rcall   serout2hdig
                      05084       ifdef SEROUT2TO_USED
                      05085         btfss   STATUS, C       ; Timed out?
                      05086         return                  ; Yes
                      05087       endif
00104A 5006           05088         movf    R2 + 1, W       ; Get second nibble
00104C D803           05089         rcall   serout2hdig
                      05090       ifdef SEROUT2TO_USED
                      05091         btfss   STATUS, C       ; Timed out?
                      05092         return                  ; Yes
                      05093       endif
00104E 3805           05094         swapf   R2, W           ; Get third nibble
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001050 D801           05095         rcall   serout2hdig
                      05096       ifdef SEROUT2TO_USED
                      05097         btfss   STATUS, C       ; Timed out?
                      05098         return                  ; Yes
                      05099       endif
001052 5005           05100         movf    R2, W           ; Get final nibble and fall through
                      05101 
001054 0B0F           05102 serout2hdig andlw 0fh           ; Isolate lower nibble
001056 0FF6           05103         addlw   -10             ; Change to 0 - F
001058 B0D8           05104         btfsc   STATUS, C
00105A 0F07           05105         addlw   7               ; Bump to A - F
00105C 0F0A           05106         addlw   10
00105E D000           05107         bra     SEROUT2SEND     ; Send nibble
                      05212   LIST
001060 6E01           05213 SEROUT2SEND movwf R0            ; Save char for a moment
001062 4E09           05214         dcfsnz  R4, F           ; Bump down count while we're here
001064 9E19           05215         bcf     GOP, 7
001066 500A           05216         movf    R4 + 1, W       ; Get number of digits to send
001068 E003           05217         bz      serout2send1    ; If zero digits skip count compare
00106A 5C09           05218         subwf   R4, W           ; Send if within count
00106C B0D8           05219         btfsc   STATUS, C
00106E 0012           05220         return                  ; Carry set for no timeout
001070 5001           05221 serout2send1 movf  R0, W        ; Get char back
                      05222       ifdef SEROUT2TO_USED
                      05223         bsf     STATUS, C       ; Set carry for no timeout in case of blanking
                      05224       endif
001072 A4D8           05225         btfss   STATUS, Z       ; If char zero, goto blank check
001074 9E19           05226         bcf     GOP, 7          ; Not zero so clear blank
001076 BE19           05227         btfsc   GOP, 7          ; If blanking on, don't send
001078 0012           05228         return
00107A 0F30           05229         addlw   '0'             ; Add ASCII offset
00107C EFB0 F008      05230         goto    JUMPMAN         ; Send it
                      06318   LIST
001080 6A04           06319 PAUSE   clrf    R1 + 1
001082 6E03           06320 PAUSEL  movwf   R1
001084 6AE8           06321 pauseloop clrf  WREG            ; 1 (8) Clear W for subtracts
001086 0603           06322         decf    R1, F           ; 1
001088 5A04           06323         subwfb  R1 + 1, F       ; 1
00108A A0D8           06324         btfss   STATUS, C       ; 2
00108C EFB6 F008      06325         goto    DUNN
001090 0E03           06326         movlw   (PAUSE_DELAY) >> 8      ; 1
001092 6E02           06327         movwf   R0 + 1          ; 1
001094 0EE7           06328         movlw   low (PAUSE_DELAY)       ; 1
001096 D802           06329         rcall   PAUSEUSL        ; -2 (PAUSEUSL gives you 2 less than you ask for)
001098 D7F5           06330         bra     pauseloop       ; 2
                      06712   LIST
00109A 6A02           06713 PAUSEUS clrf    R0 + 1          ; 1
00109C 0FFE           06714 PAUSEUSL addlw  -2              ; 1 Subtract overhead
00109E 6E01           06715         movwf   R0              ; 1
                      06716 pauseusloop CLRWDT?NOP          ; 1
                          M     ifndef NO_CLRWDT
0010A0 0004               M         clrwdt
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         nop
                          M     endif
0010A2 6AE8           06717         clrf    WREG            ; 1
0010A4 5A02           06718         subwfb  R0 + 1, F       ; 1
0010A6 A0D8           06719         btfss   STATUS, C       ; 1 / 2
0010A8 0012           06720         return                  ; 2 + 3 (call + setup)
0010AA 0601           06721         decf    R0, F           ; 1
0010AC D000           06722         bra     $ + 2           ; 2
0010AE D000           06723         bra     $ + 2           ; 2
0010B0 D7F7           06724         bra     pauseusloop     ; 2
                      07284   LIST
0010B2 6A02           07285 CMPGEB  clrf    R0 + 1
                      07291   LIST
0010B4 6A04           07292 CMPGEW  clrf    R1 + 1
                      07298   LIST
0010B6 6E03           07299 CMPGE   movwf   R1
0010B8 0E03           07300         movlw   3               ; Mask for = >
0010BA D005           07301         bra     CMP
                      07350   LIST
0010BC 6A02           07351 CMPLEB  clrf    R0 + 1
                      07357   LIST
0010BE 6A04           07358 CMPLEW  clrf    R1 + 1
                      07364   LIST
0010C0 6E03           07365 CMPLE   movwf   R1
0010C2 0E06           07366         movlw   6               ; Mask for < =
0010C4 D000           07367         bra     CMP
                      07449   LIST
0010C6 6E09           07450 CMP     movwf   R4              ; Save compare state
0010C8 5004           07451         movf    R1 + 1, W       ; Flags = MSB(R0) - MSB(R1)
0010CA 5C02           07452         subwf   R0 + 1, W
0010CC E102           07453         bnz     cmpnoteq        ; If unequal then done
0010CE 5003           07454         movf    R1, W           ; Flags = LSB(R0) - LSB(R1)
0010D0 5C01           07455         subwf   R0, W
0010D2 0E04           07456 cmpnoteq movlw  4               ; W = 4 if R0 < R1
0010D4 B0D8           07457         btfsc   STATUS, C
0010D6 0E01           07458         movlw   1               ; W = 1 if R0 > R1
0010D8 B4D8           07459         btfsc   STATUS, Z
0010DA 0E02           07460         movlw   2               ; W = 2 if R0 == R1
0010DC 1409           07461         andwf   R4, W           ; Mask for compare state
0010DE A4D8           07462         btfss   STATUS, Z
0010E0 0EFF           07463         movlw   -1
0010E2 EFB6 F008      07464         goto    DUNN
                      07484   LIST
0010E6 66E8           07485 LAND    tstfsz  WREG
0010E8 0EFF           07486         movlw   -1
0010EA 1401           07487         andwf   R0, W
0010EC A4D8           07488         btfss   STATUS, Z
0010EE 0EFF           07489         movlw   -1
0010F0 EFB6 F008      07490         goto    DUNN
                      07674   LIST
0010F4 6A06           07675 DIV     clrf    R2 + 1
0010F6 6A05           07676         clrf    R2
                      07677 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010F8 0E10           07678 DIV32DIV movlw   16
0010FA 6E07           07679         movwf   R3
                      07680 
0010FC 3402           07681 divloop rlcf    R0 + 1, W
0010FE 3605           07682         rlcf    R2, F
001100 3606           07683         rlcf    R2 + 1, F
001102 5003           07684         movf    R1, W
001104 5E05           07685         subwf   R2, F
001106 5004           07686         movf    R1 + 1, W
001108 5A06           07687         subwfb  R2 + 1, F
                      07688 
00110A E205           07689         bc      divok
00110C 5003           07690         movf    R1, W
00110E 2605           07691         addwf   R2, F
001110 5004           07692         movf    R1 + 1, W
001112 2206           07693         addwfc  R2 + 1, F
                      07694 
001114 90D8           07695         bcf     STATUS, C
                      07696 
001116 3601           07697 divok   rlcf    R0, F
001118 3602           07698         rlcf    R0 + 1, F
                      07699 
00111A 2E07           07700         decfsz  R3, F
00111C D7EF           07701         bra     divloop
00111E 5001           07702         movf    R0, W           ; Get low byte to W
001120 EFB6 F008      07703         goto    DUNN
                      07720   LIST
001124 5003           07721 MUL     movf    R1, W
001126 0207           07722         mulwf   R3              ; R1 * R3 = PRODHL
001128 CFF3 F005      07723         movff   PRODL, R2
00112C CFF4 F006      07724         movff   PRODH, R2 + 1
                      07725 
001130 5004           07726         movf    R1 + 1, W
001132 0208           07727         mulwf   R3 + 1          ; R1 + 1 * R3 + 1 = PRODHL
001134 CFF3 F001      07728         movff   PRODL, R0
001138 CFF4 F002      07729         movff   PRODH, R0 + 1
                      07730 
                      07731 ;       movf    R1 + 1, W       ; W still has R1 + 1 from above
00113C 0207           07732         mulwf   R3              ; R1 + 1 * R3 = PRODHL
00113E 50F3           07733         movf    PRODL, W        ; Add cross products
001140 2606           07734         addwf   R2 + 1, F
001142 50F4           07735         movf    PRODH, W
001144 2201           07736         addwfc  R0, F
001146 6AE8           07737         clrf    WREG
001148 2202           07738         addwfc  R0 + 1, F
                      07739 
00114A 5003           07740         movf    R1, W
00114C 0208           07741         mulwf   R3 + 1          ; R1 * R3 + 1 = PRODHL
00114E 50F3           07742         movf    PRODL, W        ; Add cross products
001150 2606           07743         addwf   R2 + 1, F
001152 50F4           07744         movf    PRODH, W
001154 2201           07745         addwfc  R0, F
001156 6AE8           07746         clrf    WREG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001158 2202           07747         addwfc  R0 + 1, F
                      07748 
00115A 5005           07749         movf    R2, W           ; Get low byte to W
00115C EFB6 F008      07750         goto    DUNN
                      07766   LIST
001160 6EE9           07767 JUMPMAN movwf   FSR0L
001162 6AFB           07768         clrf    PCLATU
001164 5012           07769         movf    R8 + 1, W
001166 6EFA           07770         movwf   PCLATH
001168 5011           07771         movf    R8, W
00116A 6EF9           07772         movwf   PCL
                      07786   LIST
00116C 0100           07787 DUNN    movlb   0               ; 1 Reset banks to 0
                      07788 DUNN5   CLRWDT?NOP              ; 1 Hit Watchdog timer
                          M     ifndef NO_CLRWDT
00116E 0004               M         clrwdt
                          M     else
                          M         nop
                          M     endif
001170 0012           07789         return                  ; 2 Done
                      07802   LIST
001172                07803 INIT
                      07839   LIST
001172                07840 main
                      00136 
                      00137 
                      00138 ; C:\PBP\18F2550.BAS            00012   BANKA   $0000, $005F
                      00139 ; C:\PBP\18F2550.BAS            00013   BANK0   $0060, $00FF
                      00140 ; C:\PBP\18F2550.BAS            00014   BANK1   $0100, $01FF
                      00141 ; C:\PBP\18F2550.BAS            00015   BANK2   $0200, $02FF
                      00142 ; C:\PBP\18F2550.BAS            00016   BANK3   $0300, $03FF
                      00143 ; C:\PBP\18F2550.BAS            00017   BANK4   $0400, $04FF
                      00144 ; C:\PBP\18F2550.BAS            00018   BANK5   $0500, $05FF
                      00145 ; C:\PBP\18F2550.BAS            00019   BANK6   $0600, $06FF
                      00146 ; C:\PBP\18F2550.BAS            00020   BANK7   $0700, $07FF
                      00147 ; C:\PBP\18F2550.BAS            00022   LIBRARY "PBPPIC18"
                      00148 
                      00149 ; C:\PBP\18F2550.BAS            00024           include "PIC18EXT.BAS"
                      00150 
                      00151 ; C:\PBP\18F2550.BAS            00031           include "PBPPIC18.RAM"
                      00152 ; C:\PBP\18F2550.BAS            00032   USBMEMORYADDRESS Con    $400    ' USB RAM starts here
                      00153 
                      00154 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00006   include "DESCUSBProject.bas"
                      00155 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\DESCUSBPROJECT.BAS 00004   USBMEMORYSIZE   Con     256     ' USB RA
                            M size in bytes
                      00156 
                      00157 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\DESCUSBPROJECT.BAS 00007   goto    hid_desc_end    ' Skip over all 
                            of the USB assembler code
                      00158         GOTO?L  _hid_desc_end
                          M         L?GOTO  _hid_desc_end
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ($ == (_hid_desc_end))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _hid_desc_end
                          M     else
                          M       if ((_hid_desc_end) < 1)
                          M         goto    _hid_desc_end
                          M       else
                          M         if ((_hid_desc_end) > $)
001172 EF6A F00D          M         goto    _hid_desc_end
                          M         else
                          M           if ((_hid_desc_end) < ($ - 3ffh))
                          M         goto    _hid_desc_end
                          M           else
                          M         bra     _hid_desc_end
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00159 
                      00160 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\DESCUSBPROJECT.BAS 00008   asm
                      00161 
                      00162         ASM?
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                      00163 
                      00164 
                      00165 #define USB_EP0_BUFF_SIZE       64      ; 8, 16, 32, or 64
                      00166 #define USB_MAX_NUM_INT         1       ; For tracking Alternate Setting
                      00167 #define USB_MAX_EP_NUMBER       1       ; UEP1
                      00168 #define NUM_CONFIGURATIONS      1
                      00169 #define NUM_INTERFACES          1
                      00170 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00171 #define UCFG_VAL        USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_FULL_SPEED|USB_PING_PONG__NO_PING
                            _PONG
                      00172 ;#define UCFG_VAL       USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_LOW_SPEED|USB_PING_PONG__NO_PING_
                            PONG
                      00173 
                      00174 ;#define USE_SELF_POWER_SENSE_IO
                      00175 ;#define USE_USB_BUS_SENSE_IO
                      00176 
                      00177 #define USB_POLLING
                      00178 
                      00179 ; HID
                      00180 ; Endpoints Allocation
                      00181 #define HID_INTF_ID               0x00
                      00182 #define HID_EP                    1
                      00183 #define HID_INT_OUT_EP_SIZE       64
                      00184 #define HID_INT_IN_EP_SIZE        64
                      00185 #define HID_NUM_OF_DSC            1
                      00186 
                      00187    include      "usb_hid.asm"   ; Include rest of USB files, starting with HID class code
                      00001 ; usb_hid.asm
                      00002 ; 10/08/08 microEngineering Labs, Inc.
                      00003 
                      00004         include "usb_hid.inc"   ; Include our header file
                      00001 ; usb_hid.inc
                      00002 ; 6/30/08 microEngineering Labs, Inc.
                      00003 
                      00004 ;/*******************************************************************************
                      00005 
                      00006 ;    USB HID class header file
                      00007 
                      00008 ;This file, with its associated C source file, provides the interface required
                      00009 ;to talk to the USB host through the Human Interface Device (HID) class.  
                      00010 
                      00011 ;******************************************************************************/
                      00012 ;//DOM-IGNORE-BEGIN
                      00013 ;/******************************************************************************
                      00014 ; FileName:             usb_function_hid.h
                      00015 ; Dependencies: See INCLUDES section
                      00016 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00017 ; Hardware:             The code is natively intended to be used on the following
                      00018 ;                               hardware platforms: PICDEM™ FS USB Demo Board, 
                      00019 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00020 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00021 ;                               modified for use on other USB platforms by editing the
                      00022 ;                               HardwareProfile.h file.
                      00023 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00024 ; Company:              Microchip Technology, Inc.
                      00025 
                      00026 ; Software License Agreement:
                      00027 
                      00028 ; The software supplied herewith by Microchip Technology Incorporated
                      00029 ; (the “Company”) for its PIC® Microcontroller is intended and
                      00030 ; supplied to you, the Company’s customer, for use solely and
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00031 ; exclusively on Microchip PIC Microcontroller products. The
                      00032 ; software is owned by the Company and/or its supplier, and is
                      00033 ; protected under applicable copyright laws. All rights are reserved.
                      00034 ; Any use in violation of the foregoing restrictions may subject the
                      00035 ; user to criminal sanctions under applicable laws, as well as to
                      00036 ; civil liability for the breach of the terms and conditions of this
                      00037 ; license.
                      00038 
                      00039 ; THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,
                      00040 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
                      00041 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00042 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00043 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00044 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00045 
                      00046 ;********************************************************************
                      00047 ; Change History:
                      00048 ;  Rev   Date         Description
                      00049 ;  1.0   11/19/2004   Initial release
                      00050 ;  2.1   02/26/2007   Updated for simplicity and to use common
                      00051 ;                     coding style
                      00052 ;*******************************************************************/
                      00053 ;#ifndef HID_H
                      00054 ;#define HID_H
                      00055 ;//DOM-IGNORE-END
                      00056 
                      00057 ;/** INCLUDES *******************************************************/
                      00058 
                      00059 ;/** DEFINITIONS ****************************************************/
                      00060 
                      00061 ; DEVICE CLASS USAGE
                      00062 #define USB_USE_HID
                      00063 
                      00064 ; Class-Specific Requests
                      00065 #define GET_REPORT      0x01
                      00066 #define GET_IDLE        0x02
                      00067 #define GET_PROTOCOL    0x03
                      00068 #define SET_REPORT      0x09
                      00069 #define SET_IDLE        0x0A
                      00070 #define SET_PROTOCOL    0x0B
                      00071 
                      00072 ; Class Descriptor Types
                      00073 #define DSC_HID         0x21
                      00074 #define DSC_RPT         0x22
                      00075 #define DSC_PHY         0x23
                      00076 
                      00077 ; Protocol Selection
                      00078 #define BOOT_PROTOCOL   0x00
                      00079 #define RPT_PROTOCOL    0x01
                      00080 
                      00081 ; HID Interface Class Code
                      00082 #define HID_INTF        0x03
                      00083 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00084 ; HID Interface Class SubClass Codes
                      00085 #define BOOT_INTF_SUBCLASS      0x01
                      00086 
                      00087 ; HID Interface Class Protocol Codes
                      00088 #define HID_PROTOCOL_NONE       0x00
                      00089 #define HID_PROTOCOL_KEYBOARD   0x01
                      00090 #define HID_PROTOCOL_MOUSE      0x02
                      00091 
                      00092 
                      00093 ;/********************************************************************
                      00094 ; * Macro:           BYTE mHIDGetRptRxLength(void)
                      00095 ; *
                      00096 ; * Description:     mHIDGetRptRxLength is used to retrieve the number
                      00097 ; *                  of bytes copied to user's buffer by the most
                      00098 ; *                  recent call to HIDRxReport function.
                      00099 ; * Input:           
                      00100 ; *     None :
                      00101 ; *
                      00102 ; * Output:          
                      00103 ; *     BYTE : mHIDGetRptRxLength returns hid_rpt_rx_len
                      00104 ; *
                      00105 ; *******************************************************************/
                      00106 ;#define mHIDGetRptRxLength()        hid_rpt_rx_len
                      00107 
                      00108 ;#define HIDTxHandleBusy USBHandleBusy
                      00109 ;#define HIDRxHandleBusy USBHandleBusy
                      00110 ;#define HIDTxPacket USBTxOnePacket
                      00111 ;#define HIDRxPacket USBRxOnePacket
                      00112 
                      00113 ;// Section: STRUCTURES *********************************************/
                      00114 
                      00115 ;//USB HID Descriptor header as detailed in section 
                      00116 ;//"6.2.1 HID Descriptor" of the HID class definition specification
                      00117 ;typedef struct _USB_HID_DSC_HEADER
                      00118 ;{
                      00119 ;    BYTE bDescriptorType;      //offset 9
                      00120 ;    WORD wDscLength;           //offset 10
                      00121 ;} USB_HID_DSC_HEADER;
                      00122 
                      00123 ;//USB HID Descriptor header as detailed in section 
                      00124 ;//"6.2.1 HID Descriptor" of the HID class definition specification
                      00125 ;typedef struct _USB_HID_DSC
                      00126 ;{
                      00127 ;    BYTE bLength;                      //offset 0 
                      00128 ;       BYTE bDescriptorType;   //offset 1
                      00129 ;       WORD bcdHID;                    //offset 2
                      00130 ;    BYTE bCountryCode;         //offset 4
                      00131 ;       BYTE bNumDsc;                   //offset 5
                      00132 
                      00133 
                      00134 ;    //USB_HID_DSC_HEADER hid_dsc_header[HID_NUM_OF_DSC];
                      00135 ;    /* HID_NUM_OF_DSC is defined in usbcfg.h */
                      00136     
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00137 ;} USB_HID_DSC;
                      00138 
                      00139 ;/** EXTERNS ********************************************************/
                      00140 ;extern BYTE hid_rpt_rx_len;
                      00141 
                      00142 ;/** PUBLIC PROTOTYPES **********************************************/
                      00143 ;#if defined(USB_DYNAMIC_EP_CONFIG)
                      00144 ;    #define HIDInitEP()
                      00145 ;#else
                      00146 ;       /********************************************************************
                      00147 ;        * Function:        void HIDInitEP(void)
                      00148 ;        *
                      00149 ;        * PreCondition:    None
                      00150 ;        *
                      00151 ;        * Input:           None
                      00152 ;        *
                      00153 ;        * Output:          None
                      00154 ;        *
                      00155 ;        * Side Effects:    None;
                      00156 ;        *
                      00157 ;        * Overview:        HIDInitEP initializes HID endpoints, buffer
                      00158 ;        *                  descriptors, internal state-machine, and
                      00159 ;        *                  variables. It should be called after the USB
                      00160 ;        *                  host has sent out a SET_CONFIGURATION request.
                      00161 ;        *                  See USBStdSetCfgHandler() in usbd.c for examples.
                      00162 ;        *
                      00163 ;        * Note:            None
                      00164 ;        *******************************************************************/
                      00165 ;    void HIDInitEP(void);
                      00166 ;#endif
                      00167 ;       /********************************************************************
                      00168 ; * Function:        void USBCheckHIDRequest(void)
                      00169 ; *
                      00170 ; * PreCondition:    None
                      00171 ; *
                      00172 ; * Input:           None
                      00173 ; *
                      00174 ; * Output:          None
                      00175 ; *
                      00176 ; * Side Effects:    None
                      00177 ; *
                      00178 ; * Overview:        This routine checks the setup data packet to see
                      00179 ; *                  if it knows how to handle it
                      00180 ; *
                      00181 ; * Note:            None
                      00182 ; *******************************************************************/
                      00183 ;void USBCheckHIDRequest(void);
                      00184 
                      00185 ;#endif //HID_H
                      00005         include "usb_dev.asm"   ; Include the main USB routines
                      00001 ; usb_dev.asm
                      00002 ; 10/07/08 microEngineering Labs, Inc.
                      00003 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00004         include "usb_dev.inc"   ; Include our header file
                      00001 ; usb_dev.inc
                      00002 ; 7/7/08 microEngineering Labs, Inc.
                      00003 
                      00004 ; Buffer Descriptor Status Register Initialization Parameters
                      00005 #define _BSTALL         0x04            ; Buffer Stall enable
                      00006 #define _DTSEN          0x08            ; Data Toggle Synch enable
                      00007 #define _INCDIS         0x10            ; Address increment disable
                      00008 #define _KEN            0x20            ; SIE keeps buff descriptors enable
                      00009 #define _DAT0           0x00            ; DATA0 packet expected next
                      00010 #define _DAT1           0x40            ; DATA1 packet expected next
                      00011 #define _DTSMASK        0x40            ; DTS Mask
                      00012 #define _USIE           0x80            ; SIE owns buffer
                      00013 #define _UCPU           0x00            ; CPU owns buffer
                      00014 
                      00015 ;#define _STAT_MASK     0xFF
                      00016 
                      00017 ; PIC Endpoint Definitions
                      00018 ; PIC Endpoint Address Format: X:EP3:EP2:EP1:EP0:DIR:PPBI:X
                      00019 ; This is used when checking the value read from USTAT
                      00020 ; NOTE: These definitions are not used in the descriptors.
                      00021 ; EP addresses used in the descriptors have different format.
                      00022 #define USTAT_EP0_PP_MASK        ~0x02
                      00023 #define USTAT_EP_MASK           0x7E
                      00024 #define USTAT_EP0_OUT           0x00
                      00025 #define USTAT_EP0_IN            0x04
                      00026 
                      00027 #define UEP_STALL       0x0001
                      00028 
                      00029 ; USB Endpoint Definitions
                      00030 ; USB Standard EP Address Format: DIR:X:X:X:EP3:EP2:EP1:EP0
                      00031 ; This is used in the descriptors.
                      00032 ; NOTE: Do not use these values for checking against USTAT.
                      00033 #define _EP_IN          0x80
                      00034 #define _EP_OUT         0x00
                      00035 ;#define _EP01_OUT      0x01
                      00036 ;#define _EP01_IN       0x81
                      00037 ;#define _EP02_OUT      0x02
                      00038 ;#define _EP02_IN       0x82
                      00039 ;#define _EP03_OUT      0x03
                      00040 ;#define _EP03_IN       0x83
                      00041 ;#define _EP04_OUT      0x04
                      00042 ;#define _EP04_IN       0x84
                      00043 ;#define _EP05_OUT      0x05
                      00044 ;#define _EP05_IN       0x85
                      00045 ;#define _EP06_OUT      0x06
                      00046 ;#define _EP06_IN       0x86
                      00047 ;#define _EP07_OUT      0x07
                      00048 ;#define _EP07_IN       0x87
                      00049 ;#define _EP08_OUT      0x08
                      00050 ;#define _EP08_IN       0x88
                      00051 ;#define _EP09_OUT      0x09
                      00052 ;#define _EP09_IN       0x89
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00053 ;#define _EP10_OUT      0x0A
                      00054 ;#define _EP10_IN       0x8A
                      00055 ;#define _EP11_OUT      0x0B
                      00056 ;#define _EP11_IN       0x8B
                      00057 ;#define _EP12_OUT      0x0C
                      00058 ;#define _EP12_IN       0x8C
                      00059 ;#define _EP13_OUT      0x0D
                      00060 ;#define _EP13_IN       0x8D
                      00061 ;#define _EP14_OUT      0x0E
                      00062 ;#define _EP14_IN       0x8E
                      00063 ;#define _EP15_OUT      0x0F
                      00064 ;#define _EP15_IN       0x8F
                      00065 
                      00066 ; Configuration Attributes
                      00067 #define _DEFAULT        (0x01<<7)       ; Default Value (Bit 7 is set)
                      00068 #define _SELF           (0x01<<6)       ; Self-powered (Supports if set)
                      00069 #define _RWU            (0x01<<5)       ; Remote Wakeup (Supports if set)
                      00070 
                      00071 ; Endpoint Transfer Type
                      00072 #define _CTRL           0x00            ; Control Transfer
                      00073 #define _ISO            0x01            ; Isochronous Transfer
                      00074 #define _BULK           0x02            ; Bulk Transfer
                      00075 #define _INT            0x03            ; Interrupt Transfer
                      00076 
                      00077 ;#define _ROM           USB_INPIPES_ROM
                      00078 ;#define _RAM           USB_INPIPES_RAM
                      00079 
                      00080 ; Various options for setting the PIPES
                      00081 #define USB_INPIPES_ROM         0x00    ; Data comes from RAM
                      00082 #define USB_INPIPES_RAM         0x01    ; Data comes from ROM
                      00083 #define USB_INPIPES_BUSY        0x80    ; The PIPE is busy
                      00084 #define USB_INPIPES_INCLUDE_ZERO 0x40   ; Include a trailing zero packet
                      00085 #define USB_INPIPES_NO_DATA     0x00    ; No data to send
                      00086 #define USB_INPIPES_NO_OPTIONS  0x00    ; No options set
                      00087 
                      00088 #define USB_EP0_ROM             USB_INPIPES_ROM
                      00089 #define USB_EP0_RAM             USB_INPIPES_RAM
                      00090 #define USB_EP0_BUSY            USB_INPIPES_BUSY
                      00091 #define USB_EP0_INCLUDE_ZERO    USB_INPIPES_INCLUDE_ZERO
                      00092 #define USB_EP0_NO_DATA         USB_INPIPES_NO_DATA
                      00093 #define USB_EP0_NO_OPTIONS      USB_INPIPES_NO_OPTIONS
                      00094 
                      00095 ; Standard Request Codes
                      00096 ; USB 2.0 Spec Ref Table 9-4
                      00097 #define GET_STATUS      0
                      00098 #define CLR_FEATURE     1
                      00099 #define SET_FEATURE     3
                      00100 #define SET_ADR         5
                      00101 #define GET_DSC         6
                      00102 #define SET_DSC         7
                      00103 #define GET_CFG         8
                      00104 #define SET_CFG         9
                      00105 #define GET_INTF        10
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00106 #define SET_INTF        11
                      00107 #define SYNCH_FRAME     12
                      00108 
                      00109 ; Standard Feature Selectors
                      00110 #define DEVICE_REMOTE_WAKEUP    0x01
                      00111 #define ENDPOINT_HALT           0x00
                      00112 
                      00113 ; USB Device States - To be used with [USBDeviceState]
                      00114 #define DETACHED_STATE          0x00
                      00115 #define ATTACHED_STATE          0x01
                      00116 #define POWERED_STATE           0x02
                      00117 #define DEFAULT_STATE           0x04
                      00118 #define ADR_PENDING_STATE       0x08
                      00119 #define ADDRESS_STATE           0x10
                      00120 #define CONFIGURED_STATE        0x20
                      00121 
                      00122 #define USB_PING_PONG__NO_PING_PONG     0x00    ; 0b00
                      00123 #define USB_PING_PONG__EP0_OUT_ONLY     0x01    ; 0b01
                      00124 #define USB_PING_PONG__FULL_PING_PONG   0x02    ; 0b10
                      00125 #define USB_PING_PONG__ALL_BUT_EP0      0x03    ; 0b11
                      00126 
                      00127 ; UCFG Initialization Parameters
                      00128 #define USB_PULLUP_ENABLE               0x10
                      00129 #define USB_PULLUP_DISABLED             0x00
                      00130     
                      00131 #define USB_INTERNAL_TRANSCEIVER        0x00
                      00132 #define USB_EXTERNAL_TRANSCEIVER        0x08
                      00133     
                      00134 #define USB_FULL_SPEED                  0x04
                      00135 #define USB_LOW_SPEED                   0x00
                      00136 
                      00137 ; UEPn Initialization Parameters
                      00138 #define EP_CTRL         0x06            ; Cfg Control pipe for this ep
                      00139 #define EP_OUT          0x0C            ; Cfg OUT only pipe for this ep
                      00140 #define EP_IN           0x0A            ; Cfg IN only pipe for this ep
                      00141 #define EP_OUT_IN       0x0E            ; Cfg both OUT & IN pipes for this ep
                      00142 
                      00143 ; Handshake should be disable for isoch
                      00144 #define USB_HANDSHAKE_ENABLED   0x10
                      00145 #define USB_HANDSHAKE_DISABLED  0x00
                      00146 
                      00147 #define USB_OUT_ENABLED         0x04
                      00148 #define USB_OUT_DISABLED        0x00
                      00149 
                      00150 #define USB_IN_ENABLED          0x02
                      00151 #define USB_IN_DISABLED         0x00
                      00152 
                      00153 #define USB_ALLOW_SETUP         0x00
                      00154 #define USB_DISALLOW_SETUP      0x08
                      00155 
                      00156 #define USB_STALL_ENDPOINT      0x01
                      00157 
                      00158 ; Control Transfer States
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00159 #define WAIT_SETUP      0
                      00160 #define CTRL_TRF_TX     1
                      00161 #define CTRL_TRF_RX     2
                      00162 
                      00163 ; Short Packet States - Used by Control Transfer Read  - CTRL_TRF_TX
                      00164 #define SHORT_PKT_NOT_USED      0
                      00165 #define SHORT_PKT_PENDING       1
                      00166 #define SHORT_PKT_SENT          2
                      00167 
                      00168 ; USB PID: Token Types - See chapter 8 in the USB specification
                      00169 #define SETUP_TOKEN     0x0D            ; 0b00001101
                      00170 #define OUT_TOKEN       0x01            ; 0b00000001
                      00171 #define IN_TOKEN        0x09            ; 0b00001001
                      00172 
                      00173 ; bmRequestType Definitions
                      00174 #define HOST_TO_DEV     0
                      00175 #define DEV_TO_HOST     1
                      00176 
                      00177 #define STANDARD        0x00
                      00178 #define CLASS           0x01
                      00179 #define VENDOR          0x02
                      00180 
                      00181 #define RCPT_DEV        0
                      00182 #define RCPT_INTF       1
                      00183 #define RCPT_EP         2
                      00184 #define RCPT_OTH        3
                      00185 
                      00186 ; Section: USB Descriptors
                      00187 #define USB_DESCRIPTOR_DEVICE           0x01    ; bDescriptorType for a Device Descriptor.
                      00188 #define USB_DESCRIPTOR_CONFIGURATION    0x02    ; bDescriptorType for a Configuration Descriptor.
                      00189 #define USB_DESCRIPTOR_STRING           0x03    ; bDescriptorType for a String Descriptor.
                      00190 #define USB_DESCRIPTOR_INTERFACE        0x04    ; bDescriptorType for an Interface Descriptor.
                      00191 #define USB_DESCRIPTOR_ENDPOINT         0x05    ; bDescriptorType for an Endpoint Descriptor.
                      00192 #define USB_DESCRIPTOR_DEVICE_QUALIFIER 0x06    ; bDescriptorType for a Device Qualifier.
                      00193 #define USB_DESCRIPTOR_OTHER_SPEED      0x07    ; bDescriptorType for a Other Speed Configuration.
                      00194 #define USB_DESCRIPTOR_INTERFACE_POWER  0x08    ; bDescriptorType for Interface Power.
                      00195 #define USB_DESCRIPTOR_OTG              0x09    ; bDescriptorType for an OTG Descriptor.
                      00005         include "usb_mem.asm"   ; Include memory allocation
                      00001 ; usb_mem.asm
                      00002 ; 03/20/09 microEngineering Labs, Inc.
                      00003 
                      00004 ; Buffer Descriptor Byte Aliases
                      00005 #define Stat            0               ; Buffer Descriptor Status Register
                      00006 #define Cnt             1               ; Buffer Count
                      00007 ;#define ADR            2               ; Buffer Address
                      00008 #define ADRL            2               ; Buffer Address Low
                      00009 #define ADRH            3               ; Buffer Address High
                      00010 
                      00011 ; Stat Bit Aliases
                      00012 ;#define BC8            0               ; Upper Count Bit
                      00013 ;#define BC9            1               ; Upper Count Bit
                      00014 #define BSTALL          2               ; Buffer Stall Enable
                      00015 #define DTSEN           3               ; Data Toggle Synch Enable
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00016 #define INCDIS          4               ; Address Increment Disable
                      00017 #define KEN             5               ; BD Keep Enable
                      00018 #define DTS             6               ; Data Toggle Synch Value
                      00019 #define UOWN            7               ; USB Ownership
                      00020 #define PID             2               ; Packet Identifier (4 bits)
                      00021 
                      00022 
                      00023         cblock  _USBMEMORYADDRESS       ; Point to BDT RAM
                      00024         endc
                      00025 
                      00026 ; Buffer Descriptor Table (BDT) RAM
                      00027 
                      00028 #if(0 <= USB_MAX_EP_NUMBER)
                      00029         cblock
  00000400            00030                 ep0Bo:4                 ; Endpoint #0 BD Out
  00000404            00031                 ep0Bi:4                 ; Endpoint #0 BD In
                      00032         endc
                      00033 #endif
                      00034 
                      00035 #if(1 <= USB_MAX_EP_NUMBER)
                      00036         cblock
  00000408            00037                 ep1Bo:4                 ; Endpoint #1 BD Out
  0000040C            00038                 ep1Bi:4                 ; Endpoint #1 BD In
                      00039         endc
                      00040 #endif
                      00041 
                      00042 #if(2 <= USB_MAX_EP_NUMBER)
                      00043         cblock
                      00044                 ep2Bo:4                 ; Endpoint #2 BD Out
                      00045                 ep2Bi:4                 ; Endpoint #2 BD In
                      00046         endc
                      00047 #endif
                      00048 
                      00049 #if(3 <= USB_MAX_EP_NUMBER)
                      00050         cblock
                      00051                 ep3Bo:4                 ; Endpoint #3 BD Out
                      00052                 ep3Bi:4                 ; Endpoint #3 BD In
                      00053         endc
                      00054 #endif
                      00055 
                      00056 #if(4 <= USB_MAX_EP_NUMBER)
                      00057         cblock
                      00058                 ep4Bo:4                 ; Endpoint #4 BD Out
                      00059                 ep4Bi:4                 ; Endpoint #4 BD In
                      00060         endc
                      00061 #endif
                      00062 
                      00063 #if(5 <= USB_MAX_EP_NUMBER)
                      00064         cblock
                      00065                 ep5Bo:4                 ; Endpoint #5 BD Out
                      00066                 ep5Bi:4                 ; Endpoint #5 BD In
                      00067         endc
                      00068 #endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00069 
                      00070 #if(6 <= USB_MAX_EP_NUMBER)
                      00071         cblock
                      00072                 ep6Bo:4                 ; Endpoint #6 BD Out
                      00073                 ep6Bi:4                 ; Endpoint #6 BD In
                      00074         endc
                      00075 #endif
                      00076 
                      00077 #if(7 <= USB_MAX_EP_NUMBER)
                      00078         cblock
                      00079                 ep7Bo:4                 ; Endpoint #7 BD Out
                      00080                 ep7Bi:4                 ; Endpoint #7 BD In
                      00081         endc
                      00082 #endif
                      00083 
                      00084 #if(8 <= USB_MAX_EP_NUMBER)
                      00085         cblock
                      00086                 ep8Bo:4                 ; Endpoint #8 BD Out
                      00087                 ep8Bi:4                 ; Endpoint #8 BD In
                      00088         endc
                      00089 #endif
                      00090 
                      00091 #if(9 <= USB_MAX_EP_NUMBER)
                      00092         cblock
                      00093                 ep9Bo:4                 ; Endpoint #9 BD Out
                      00094                 ep9Bi:4                 ; Endpoint #9 BD In
                      00095         endc
                      00096 #endif
                      00097 
                      00098 #if(10 <= USB_MAX_EP_NUMBER)
                      00099         cblock
                      00100                 ep10Bo:4                ; Endpoint #10 BD Out
                      00101                 ep10Bi:4                ; Endpoint #10 BD In
                      00102         endc
                      00103 #endif
                      00104 
                      00105 #if(11 <= USB_MAX_EP_NUMBER)
                      00106         cblock
                      00107                 ep11Bo:4                ; Endpoint #11 BD Out
                      00108                 ep11Bi:4                ; Endpoint #11 BD In
                      00109         endc
                      00110 #endif
                      00111 
                      00112 #if(12 <= USB_MAX_EP_NUMBER)
                      00113         cblock
                      00114                 ep12Bo:4                ; Endpoint #12 BD Out
                      00115                 ep12Bi:4                ; Endpoint #12 BD In
                      00116         endc
                      00117 #endif
                      00118 
                      00119 #if(13 <= USB_MAX_EP_NUMBER)
                      00120         cblock
                      00121                 ep13Bo:4                ; Endpoint #13 BD Out
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00122                 ep13Bi:4                ; Endpoint #13 BD In
                      00123         endc
                      00124 #endif
                      00125 
                      00126 #if(14 <= USB_MAX_EP_NUMBER)
                      00127         cblock
                      00128                 ep14Bo:4                ; Endpoint #14 BD Out
                      00129                 ep14Bi:4                ; Endpoint #14 BD In
                      00130         endc
                      00131 #endif
                      00132 
                      00133 #if(15 <= USB_MAX_EP_NUMBER)
                      00134         cblock
                      00135                 ep15Bo:4                ; Endpoint #15 BD Out
                      00136                 ep15Bi:4                ; Endpoint #15 BD In
                      00137         endc
                      00138 #endif
                      00139 
                      00140 ; General RAM (in _USBMEMORYADDRESS bank)
                      00141         cblock
  00000410            00142                 usb_temp:2              ; Temporary storage
  00000412            00143                 pSrc:3                  ; Source pointer
  00000415            00144                 pDst:2                  ; Destination pointer
  00000417            00145                 USBDeviceState:1        ; Device States: DETACHED, ATTACHED, ...
  00000418            00146                 USBActiveConfiguration:1        ; Value of current configuration
  00000419            00147                 USBAlternateInterface:USB_MAX_NUM_INT   ; Array to keep track of the current alternate s
                            etting for each interface ID
  0000041A            00148                 controlTransferState:1  ; Control Transfer State
  0000041B            00149                 inCount:2               ; In data counter
  0000041D            00150                 outCount:2              ; Out data counter
  0000041F            00151                 shortPacketStatus:1     ; Flag used by Control Transfer Read
  00000420            00152                 USTATcopy:1
  00000421            00153                 lastDTS:1
  00000422            00154                 bTRNIFCount:1
  00000423            00155                 info:1
  00000424            00156                 outfo:1
  00000425            00157                 RemoteWakeup:1
                      00158         endc
                      00159 
                      00160 ; info bit aliases
                      00161 #define ctrl_trf_mem    0               ; [0]RAM      [1]ROM
                      00162 ;#define        RemoteWakeup    1               ; [0]Disabled [1]Enabled
                      00163 ;#define        cdc_mem_type    2               ; [0]RAM      [1]ROM
                      00164 #define includeZero     6
                      00165 #define busy            7
                      00166 
                      00167 ; Endpoint 0 buffers
                      00168         cblock
  00000426            00169                 SetupPkt:USB_EP0_BUFF_SIZE
  00000466            00170                 CtrlTrfData:USB_EP0_BUFF_SIZE
                      00171         endc
                      00172 
                      00173 ; SetupPkt Byte and Bit Aliases
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00174 #define bmRequestType   0
                      00175 #define bRequest        1
                      00176 #define wValue          2
                      00177 #define wIndex          4
                      00178 #define wLength         6
                      00179 
                      00180 #define Recipient       0               ; Device,Interface,Endpoint,Other (5 bits)
                      00181 #define RequestType     5               ; Standard,Class,Vendor,Reserved (2 bits)
                      00182 #define DataDir         7               ; Host-to-device,Device-to-host
                      00183 #define bFeature        2               ; DEVICE_REMOTE_WAKEUP,ENDPOINT_HALT
                      00184 
                      00185 #define bReportID       2               ; In a SET_REPORT or GET_REPORT request
                      00186 #define bReportType     3               ; In a SET_REPORT or GET_REPORT request
                      00187 
                      00188 #define bDscIndex       2               ; For Configuration and String DSC Only
                      00189 #define bDescriptorType 3               ; Device,Configuration,String
                      00190 #define wLangID         4               ; Language ID
                      00191 
                      00192 #define bDevADR         2               ; Device Address 0-127
                      00193 #define bDevADRH        3               ; Must equal zero
                      00194 
                      00195 #define bConfigurationValue 2           ; Configuration Value 0-255
                      00196 #define bCfgRSD         3               ; Must equal zero (Reserved)
                      00197 
                      00198 #define bAltID          2               ; Alternate Setting Value 0-255
                      00199 #define bAltID_H        3               ; Must equal zero (Reserved)
                      00200 #define bIntfID         4               ; Interface Number Value 0-255
                      00201 #define bIntfID_H       5               ; Must equal zero
                      00202 
                      00203 #define bEPID           4               ; Endpoint ID (Number & Direction)
                      00204 #define bEPID_H         5               ; Must equal zero
                      00205 
                      00206 #define EPNum           0               ; Endpoint Number 0-15 (4 bits)
                      00207 #define EPDir           7               ; Endpoint Direction: 0-OUT, 1-IN
                      00208 
                      00209 
                      00210 ; HID RAM (in _USBMEMORYADDRESS bank)
                      00211 
                      00212 #ifdef USB_USE_HID
                      00213         cblock
  000004A6            00214                 idle_rate:1
  000004A7            00215                 active_protocol:1       ; [0] Boot Protocol [1] Report Protocol
                      00216         endc
                      00217 #endif
                      00218 
                      00219 
                      00220 ; CDC RAM (in _USBMEMORYADDRESS bank)
                      00221 
                      00222 #ifdef USB_USE_CDC
                      00223         cblock
                      00224                 line_coding:LINE_CODING_LENGTH
                      00225                 control_signal_bitmap:1
                      00226                 dummy_encapsulated_cmd_response:dummy_length
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00227         endc
                      00228 
                      00229 ; line_coding Byte and Bit Aliases
                      00230 #define dwDTERate       0               ; Complex data structure
                      00231 #define bCharFormat     4
                      00232 #define bParityType     5
                      00233 #define bDataBits       6
                      00234 
                      00235 ; control_signal_bitmap Byte and Bit Aliases
                      00236 #define DTE_PRESENT     0               ; [0] Not Present  [1] Present
                      00237 #define CARRIER_CONTROL 1               ; [0] Deactivate   [1] Activate
                      00238 #endif
                      00239 
                      00240 
                      00241 ; All previous RAM must be in _USBMEMORYADDRESS bank
                      00242 ; The following buffers may be in any dual-port RAM bank
                      00243 
                      00244 ; Generic Buffer RAM
                      00245 
                      00246 #ifdef USB_USE_GEN
                      00247         cblock
                      00248                 gen_data_rx:USBGEN_EP_SIZE + 1  ; +1 for size at front
                      00249                 gen_data_tx:USBGEN_EP_SIZE + 1  ; +1 for size at front
                      00250         endc
                      00251 #endif
                      00252 
                      00253 
                      00254 ; HID Buffer RAM
                      00255 
                      00256 #ifdef USB_USE_HID
                      00257         cblock
  000004A8            00258                 hid_report_out:HID_INT_OUT_EP_SIZE + 1  ; +1 for size at front
  000004E9            00259                 hid_report_in:HID_INT_IN_EP_SIZE + 1    ; +1 for size at front
                      00260         endc
                      00261 #endif
                      00262 
                      00263 
                      00264 ; CDC Buffer RAM
                      00265         
                      00266 #ifdef USB_USE_CDC
                      00267         cblock
                      00268                 cdc_notice:CDC_COMM_IN_EP_SIZE + 1      ; +1 for size at front
                      00269                 cdc_data_rx:CDC_DATA_OUT_EP_SIZE + 1    ; +1 for size at front
                      00270                 cdc_data_tx:CDC_DATA_IN_EP_SIZE + 1     ; +1 for size at front
                      00271         endc
                      00272 #endif
                      00006 
                      00007 ;/********************************************************************
                      00008 ; FileName:             usb_device.c
                      00009 ; Dependencies: See INCLUDES section
                      00010 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00011 ; Hardware:             The code is natively intended to be used on the following
                      00012 ;                               hardware platforms: PICDEM™ FS USB Demo Board, 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00013 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00014 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00015 ;                               modified for use on other USB platforms by editing the
                      00016 ;                               HardwareProfile.h file.
                      00017 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00018 ; Company:              Microchip Technology, Inc.
                      00019 ;
                      00020 ; Software License Agreement:
                      00021 ;
                      00022 ; The software supplied herewith by Microchip Technology Incorporated
                      00023 ; (the “Company”) for its PIC® Microcontroller is intended and
                      00024 ; supplied to you, the Company’s customer, for use solely and
                      00025 ; exclusively on Microchip PIC Microcontroller products. The
                      00026 ; software is owned by the Company and/or its supplier, and is
                      00027 ; protected under applicable copyright laws. All rights are reserved.
                      00028 ; Any use in violation of the foregoing restrictions may subject the
                      00029 ; user to criminal sanctions under applicable laws, as well as to
                      00030 ; civil liability for the breach of the terms and conditions of this
                      00031 ; license.
                      00032 
                      00033 ; THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,
                      00034 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
                      00035 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00036 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00037 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00038 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00039 
                      00040 ;********************************************************************/
                      00041 
                      00042 ;/** INCLUDES *******************************************************/
                      00043 ;#include "GenericTypeDefs.h"
                      00044 ;#include "Compiler.h"
                      00045 ;#include "./USB/usb_ch9.h"
                      00046 ;#include "./USB/USB.h"
                      00047 ;#include "./USB/usb_device.h"
                      00048 ;#include "HardwareProfile.h"
                      00049 ;#include "usb_config.h"
                      00050 
                      00051 ;#if defined(USB_USE_MSD)
                      00052 ;    #include "./USB/usb_function_msd.h"
                      00053 ;#endif
                      00054 
                      00055 ;/** VARIABLES ******************************************************/
                      00056 ;#pragma udata
                      00057 
                      00058 ;USB_VOLATILE BYTE USBDeviceState;
                      00059 ;USB_VOLATILE BYTE USBActiveConfiguration;
                      00060 ;USB_VOLATILE BYTE USBAlternateInterface[USB_MAX_NUM_INT];
                      00061 ;volatile BDT_ENTRY *pBDTEntryEP0OutCurrent;
                      00062 ;volatile BDT_ENTRY *pBDTEntryEP0OutNext;
                      00063 ;volatile BDT_ENTRY *pBDTEntryOut[USB_MAX_EP_NUMBER+1];
                      00064 ;volatile BDT_ENTRY *pBDTEntryIn[USB_MAX_EP_NUMBER+1];
                      00065 ;USB_VOLATILE BYTE shortPacketStatus;
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00066 ;USB_VOLATILE BYTE controlTransferState;
                      00067 ;USB_VOLATILE IN_PIPE inPipes[1];
                      00068 ;USB_VOLATILE OUT_PIPE outPipes[1];
                      00069 ;USB_VOLATILE BYTE *pDst;
                      00070 ;USB_VOLATILE BOOL RemoteWakeup;
                      00071 ;USB_VOLATILE BYTE USTATcopy;
                      00072 ;USB_VOLATILE WORD USBInMaxPacketSize[USB_MAX_EP_NUMBER]; 
                      00073 ;USB_VOLATILE BYTE *USBInData[USB_MAX_EP_NUMBER];
                      00074 
                      00075 ;/** USB FIXED LOCATION VARIABLES ***********************************/
                      00076 ;#if defined(__18CXX)
                      00077 ;    #if defined(__18F14K50) || defined(__18F13K50) || defined(__18LF14K50) || defined(__18LF13K50)
                      00078 ;        #pragma udata USB_BDT=0x200     //See Linker Script,usb2:0x200-0x2FF(256-byte)
                      00079 ;    #else
                      00080 ;        #pragma udata USB_BDT=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)
                      00081 ;    #endif
                      00082 ;#endif
                      00083 
                      00084 ;/********************************************************************
                      00085 ; * Section A: Buffer Descriptor Table
                      00086 ; * - 0x400 - 0x4FF(max)
                      00087 ; * - USB_MAX_EP_NUMBER is defined in usb_config.h
                      00088 ; *******************************************************************/
                      00089 ;#if (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      00090 ;    volatile BDT_ENTRY BDT[(USB_MAX_EP_NUMBER + 1) * 2] __attribute__ ((aligned (512)));
                      00091 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      00092 ;    volatile BDT_ENTRY BDT[((USB_MAX_EP_NUMBER + 1) * 2)+1] __attribute__ ((aligned (512)));
                      00093 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG)
                      00094 ;    volatile BDT_ENTRY BDT[(USB_MAX_EP_NUMBER + 1) * 4] __attribute__ ((aligned (512)));
                      00095 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)
                      00096 ;    volatile BDT_ENTRY BDT[((USB_MAX_EP_NUMBER + 1) * 4)-2] __attribute__ ((aligned (512)));
                      00097 ;#else
                      00098 ;    #error "No ping pong mode defined."
                      00099 ;#endif
                      00100 
                      00101 ;//#if defined(__18CXX)
                      00102 ;//#pragma udata usbram5=0x400     //See Linker Script,usb5:0x500-0x5FF(256-byte)
                      00103 ;//#endif
                      00104 
                      00105 ;/********************************************************************
                      00106 ; * Section B: EP0 Buffer Space
                      00107 ; *******************************************************************/
                      00108 ;volatile CTRL_TRF_SETUP SetupPkt;           // 8-byte only
                      00109 ;volatile BYTE CtrlTrfData[USB_EP0_BUFF_SIZE];
                      00110 
                      00111 ;/********************************************************************
                      00112 ; * Section C: non-EP0 Buffer Space
                      00113 ; *******************************************************************/
                      00114 ;// Can provide compile time option to do software pingpong
                      00115 ;#if defined(USB_USE_HID)
                      00116 ;volatile unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];
                      00117 ;volatile unsigned char hid_report_in[HID_INT_IN_EP_SIZE];
                      00118 ;#endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00119 
                      00120 ;#if defined(USB_USE_MSD)
                      00121 ;       //volatile far USB_MSD_CBW_CSW msd_cbw_csw;
                      00122 ;       volatile USB_MSD_CBW msd_cbw;
                      00123 ;       volatile USB_MSD_CSW msd_csw;
                      00124 ;       //#pragma udata
                      00125 
                      00126 ;       #if defined(__18CXX)
                      00127 ;               #pragma udata myMSD=MSD_BUFFER_ADDRESS
                      00128 ;       #endif
                      00129 ;       volatile char msd_buffer[512];
                      00130 ;#endif
                      00131 
                      00132 ;#if defined(__18CXX)
                      00133 ;#pragma udata
                      00134 ;#endif
                      00135 
                      00136 ;/** DECLARATIONS ***************************************************/
                      00137 ;#pragma code
                      00138 
                      00139 ; Put Address into source pointer
                      00140 mSetSourcePointer macro Address
                      00141         movlw   low (Address)
                      00142         movwf   pSrc
                      00143         movlw   high (Address)
                      00144         movwf   pSrc + 1
                      00145         movlw   upper (Address)
                      00146         movwf   pSrc + 2
                      00147         endm
                      00148 
                      00149 ; Put Address into destination pointer
                      00150 mSetDestinationPointer macro Address
                      00151         movlw   low (Address)
                      00152         movwf   pDst
                      00153         movlw   high (Address)
                      00154         movwf   pDst + 1
                      00155         endm
                      00156 
                      00157 ; Get count from first location of ROM table pointed to by pSrc
                      00158 mGetRomTableCount macro
                      00159         movff   pSrc, TBLPTRL           ; Set source address
                      00160         movff   pSrc + 1, TBLPTRH
                      00161         movff   pSrc + 2, TBLPTRU
                      00162         tblrd   *                       ; Read count
                      00163         movff   TABLAT, inCount
                      00164         clrf    inCount + 1
                      00165         endm
                      00166 
                      00167 ;//DOM-IGNORE-BEGIN
                      00168 ;/****************************************************************************
                      00169 ;  Function:
                      00170 ;    void USBDeviceInit(void)
                      00171 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00172 ;  Description:
                      00173 ;    This function initializes the device stack
                      00174 ;    it in the default state
                      00175 
                      00176 ;  Precondition:
                      00177 ;    None
                      00178 
                      00179 ;  Parameters:
                      00180 ;    None
                      00181 
                      00182 ;  Return Values:
                      00183 ;    None
                      00184 
                      00185 ;  Remarks:
                      00186 ;    The USB module will be completely reset including
                      00187 ;    all of the internal variables, registers, and
                      00188 ;    interrupt flags.
                      00189 ;  ***************************************************************************/
                      00190 ;//DOM-IGNORE-END
                      00191 ;void USBDeviceInit(void)
001176                00192 USBDeviceInit
                      00193 ;{
                      00194 ;    BYTE i;
                      00195 
                      00196 ;    // Clear all USB error flags
                      00197 ;    USBClearInterruptRegister(U1EIR);
                      00198 #if (UEIR < 0xf60)
                      00199         BANKSEL UEIR
                      00200 #endif
001176 6A6A           00201         clrf    UEIR                    ; Clear all USB error flags
                      00202 
                      00203 ;    // Clears all USB interrupts     
                      00204 ;    USBClearInterruptRegister(U1IR);
001178 6A68           00205         clrf    UIR                     ; Clear all USB interrupts
                      00206 
                      00207 ;    U1EIE = 0x9F;                   // Unmask all USB error interrupts
                      00208 #if (UEIE < 0xf60)
                      00209         BANKSEL UEIE
                      00210 #endif
00117A 0E9F           00211         movlw   0x9f                    ; Unmask all USB error interrupts
00117C 6E6B           00212         movwf   UEIE
                      00213 ;    U1IE = 0xFB;                    // Enable all interrupts except ACTVIE
                      00214 ;#if (UIE < 0xf60)
                      00215 ;       BANKSEL UIE
                      00216 ;#endif
00117E 0EFB           00217         movlw   0xfb                    ; Enable all interrupts except ACTVIE
001180 6E69           00218         movwf   UIE
                      00219 
                      00220 ;    //power up the module
                      00221 ;    USBPowerModule();
                      00222 ;       rcall   USBPowerModule          ; Does nothing
                      00223 
                      00224 ;    //set the address of the BDT (if applicable)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00225 ;    USBSetBDTAddress(BDT);
                      00226 ;       rcall   USBSetBDTAddress        ; Does nothing
                      00227 
                      00228 ;    // Reset all of the Ping Pong buffers
                      00229 ;    USBPingPongBufferReset = 1;
                      00230 ;       bsf     USBPingPongBufferReset
                      00231 ;    USBPingPongBufferReset = 0;
                      00232 ;       bcf     USBPingPongBufferReset
                      00233 
                      00234 ;    // Reset to default address
                      00235 ;    U1ADDR = 0x00;
                      00236 ;#if (UADDR < 0xf60)
                      00237 ;       BANKSEL UADDR
                      00238 ;#endif
001182 6A6E           00239         clrf    UADDR                   ; Reset to default address
                      00240 
                      00241 ;    //Clear all of the endpoint control registers
                      00242 ;    memset((void*)&U1EP1,0x00,(USB_MAX_EP_NUMBER-1));
001184 EE2F F071      00243         lfsr    2, UEP1                 ; Clear all of the endpoint control registers
001188 0E01           00244         movlw   USB_MAX_EP_NUMBER
00118A                00245 USBDeviceInitEPLoop
00118A 6ADE           00246         clrf    POSTINC2
00118C 2EE8           00247         decfsz  WREG, F
00118E D7FD           00248         bra     USBDeviceInitEPLoop
                      00249 
                      00250 ;    //Clear all of the BDT entries
                      00251 ;    for(i=0;i<(sizeof(BDT)/sizeof(BDT_ENTRY));i++)
                      00252 ;    {
                      00253 ;        BDT[i].Val = 0x00;
                      00254 ;    }
                      00255 
                      00256 ;    // Initialize EP0 as a Ctrl EP
                      00257 ;    U1EP0 = EP_CTRL|USB_HANDSHAKE_ENABLED;
                      00258 ;#if (UEP0 < 0xf60)
                      00259 ;       BANKSEL UEP0
                      00260 ;#endif
001190 0E16           00261         movlw   EP_CTRL|USB_HANDSHAKE_ENABLED   ; Initialize EP0 as a Ctrl EP
001192 6E70           00262         movwf   UEP0
                      00263 
                      00264 ;    // Flush any pending transactions
                      00265 ;    while(USBTransactionCompleteIF == 1)
                      00266 ;    {
                      00267 ;        USBClearInterruptFlag(USBTransactionCompleteIFReg,USBTransactionCompleteIFBitNum);
                      00268 ;    }
001194 D007           00269         bra     USBDeviceInitFlush1     ; Simulate while
001196                00270 USBDeviceInitFlushLoop
001196 9668           00271         bcf     UIR, TRNIF              ; Flush any pending transactions
001198 0000           00272         nop
00119A 0000           00273         nop
00119C 0000           00274         nop
00119E 0000           00275         nop
0011A0 0000           00276         nop
0011A2 0000           00277         nop
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0011A4                00278 USBDeviceInitFlush1
0011A4 B668           00279         btfsc   UIR, TRNIF
0011A6 D7F7           00280         bra     USBDeviceInitFlushLoop
                      00281 
                      00282 ;    //clear all of the internal pipe information
                      00283 ;    inPipes[0].info.Val = 0;
0011A8 0104           00284         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0011AA 6B23           00285         clrf    info
                      00286 ;    outPipes[0].info.Val = 0;
0011AC 6B24           00287         clrf    outfo
                      00288 ;    outPipes[0].wCount.Val = 0;
0011AE 6B1D           00289         clrf    outCount
0011B0 6B1E           00290         clrf    outCount + 1
                      00291 
0011B2 6B25           00292         clrf    RemoteWakeup
                      00293 
                      00294 ;    // Make sure packet processing is enabled
                      00295 ;    USBPacketDisable = 0;
0011B4 986D           00296         bcf     UCON, PKTDIS            ; Make sure packet processing is enabled
                      00297 
                      00298 ;    //Get ready for the first packet
                      00299 ;    pBDTEntryIn[0] = (volatile BDT_ENTRY*)&BDT[EP0_IN_EVEN];
                      00300 
                      00301 ;    // Clear active configuration
                      00302 ;    USBActiveConfiguration = 0;
0011B6 6B18           00303         clrf    USBActiveConfiguration  ; Clear active configuration
                      00304 
                      00305 ;    //Indicate that we are now in the detached state
                      00306 ;    USBDeviceState = DETACHED_STATE;
0011B8 0E00           00307         movlw   DETACHED_STATE          ; Indicate that we are now in the detached state
0011BA 6F17           00308         movwf   USBDeviceState
0011BC 0012           00309         return
                      00310 ;}
                      00311 
                      00312 ;//DOM-IGNORE-BEGIN
                      00313 ;/****************************************************************************
                      00314 ;  Function:
                      00315 ;    void USBDeviceTasks(void)
                      00316 
                      00317 ;  Description:
                      00318 ;    This function is the main state machine of the 
                      00319 ;    USB device side stack.  This function should be
                      00320 ;    called periodically to receive and transmit
                      00321 ;    packets through the stack.  This function should
                      00322 ;    be called  preferably once every 100us 
                      00323 ;    during the enumeration process.  After the
                      00324 ;    enumeration process this function still needs to
                      00325 ;    be called periodically to respond to various
                      00326 ;    situations on the bus but is more relaxed in its
                      00327 ;    time requirements.  This function should also
                      00328 ;    be called at least as fast as the OUT data
                      00329 ;    expected from the PC.
                      00330 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00331 ;  Precondition:
                      00332 ;    None
                      00333 
                      00334 ;  Parameters:
                      00335 ;    None
                      00336 
                      00337 ;  Return Values:
                      00338 ;    None
                      00339 
                      00340 ;  Remarks:
                      00341 ;    None
                      00342 ;  ***************************************************************************/
                      00343 ;//DOM-IGNORE-END
                      00344 ;void USBDeviceTasks(void)
0011BE                00345 USBDeviceTasks
                      00346 ;{
                      00347 ;       BYTE i;
                      00348 
0011BE 0104           00349         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00350 #ifdef USE_USB_BUS_SENSE_IO
                      00351 ;    //If we aren't attached to the bus
                      00352 ;    if(USB_BUS_SENSE != 1)
                      00353         btfsc   USB_BUS_SENSE           ; If we aren't attached to the bus
                      00354         bra     USBDeviceTasksCheckDetached
                      00355 ;    {
                      00356 ;        // Disable module & detach from bus
                      00357 ;        U1CON = 0;
                      00358         clrf    UCON                    ; Disable module & detach from bus
                      00359 
                      00360 ;        // Mask all USB interrupts
                      00361 ;        U1IE = 0;
                      00362 #if (UIE < 0xf60)
                      00363         BANKSEL UIE
                      00364 #endif
                      00365         clrf    UIE                     ; Mask all USB interrupts
                      00366 
                      00367 ;        //Move to the detached state
                      00368 ;        USBDeviceState = DETACHED_STATE;
                      00369         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00370         movlw   DETACHED_STATE          ; Move to the detached state
                      00371         movwf   USBDeviceState
                      00372 
                      00373 ;        //return so that we don't go through the rest of 
                      00374 ;        //the state machine
                      00375 ;        return;
                      00376         return                          ; Return so that we don't go through the rest of the state machi
                            ne
                      00377 ;    }
                      00378 #endif
                      00379 
0011C0                00380 USBDeviceTasksCheckDetached
                      00381 ;    //if we are in the detached state
                      00382 ;    if(USBDeviceState == DETACHED_STATE)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0011C0 0E00           00383         movlw   DETACHED_STATE
0011C2 6317           00384         cpfseq  USBDeviceState
0011C4 D00A           00385         bra     USBDeviceTasksCheckAttached
                      00386 ;    {
                      00387 ;        //#if defined(__18CXX)
                      00388 ;            U1CON = 0;                           // Disable module & detach from bus
0011C6 6A6D           00389         clrf    UCON                    ; Disable module & detach from bus
                      00390 ;        //#else
                      00391 ;        //#endif
                      00392 
                      00393 ;        // Mask all USB interrupts
                      00394 ;        U1IE = 0;
                      00395 #if (UIE < 0xf60)
                      00396         BANKSEL UIE
                      00397 #endif
0011C8 6A69           00398         clrf    UIE                     ; Mask all USB interrupts
                      00399 
                      00400 ;        // Enable module & attach to bus
                      00401 ;        while(!U1CONbits.USBEN){U1CONbits.USBEN = 1;}
0011CA                00402 USBDeviceTasksCDLoop
0011CA 866D           00403         bsf     UCON, USBEN             ; Enable module & attach to bus
0011CC A66D           00404         btfss   UCON, USBEN
0011CE D7FD           00405         bra     USBDeviceTasksCDLoop
                      00406 
                      00407 ;        //moved to the attached state
                      00408 ;        USBDeviceState = ATTACHED_STATE;
0011D0 0104           00409         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0011D2 0E01           00410         movlw   ATTACHED_STATE
0011D4 6F17           00411         movwf   USBDeviceState
                      00412 
                      00413 ;        //Enable/set things like: pull ups, full/low-speed mode,
                      00414 ;        //set the ping pong mode, and set internal transceiver
                      00415 ;        SetConfigurationOptions();
                      00416 #if (UCFG < 0xf60)
                      00417         BANKSEL UCFG
                      00418 #endif
0011D6 0E14           00419         movlw   UCFG_VAL                ; Enable/set things like: pull ups, full/low-speed mode...
0011D8 6E6F           00420         movwf   UCFG
                      00421 ;    }
                      00422 
0011DA                00423 USBDeviceTasksCheckAttached
                      00424 ;    if(USBDeviceState == ATTACHED_STATE)
0011DA 0E01           00425         movlw   ATTACHED_STATE
0011DC 6317           00426         cpfseq  USBDeviceState
0011DE D009           00427         bra     USBDeviceTasksA
                      00428 ;    {
                      00429 ;        /*
                      00430 ;         * After enabling the USB module, it takes some time for the
                      00431 ;         * voltage on the D+ or D- line to rise high enough to get out
                      00432 ;         * of the SE0 condition. The USB Reset interrupt should not be
                      00433 ;         * unmasked until the SE0 condition is cleared. This helps
                      00434 ;         * prevent the firmware from misinterpreting this unique event
                      00435 ;         * as a USB bus reset from the USB host.
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00436 ;         */
                      00437 
                      00438 ;        if(!USBSE0Event)
0011E0 BA6D           00439         btfsc   UCON, SE0
0011E2 D007           00440         bra     USBDeviceTasksA
                      00441 ;        {
                      00442 ;            USBClearInterruptRegister(U1IR);// Clear all USB interrupts
0011E4 6A68           00443         clrf    UIR                     ; Clear all USB interrupts
                      00444 ;            U1IE=0;                        // Mask all USB interrupts
                      00445 #if (UIE < 0xf60)
                      00446         BANKSEL UIE
                      00447 #endif
0011E6 6A69           00448         clrf    UIE                     ; Mask all USB interrupts
                      00449 ;            USBResetIE = 1;             // Unmask RESET interrupt
0011E8 8069           00450         bsf     UIE, URSTIE             ; Unmask RESET interrupt
                      00451 ;            USBIdleIE = 1;             // Unmask IDLE interrupt
0011EA 8869           00452         bsf     UIE, IDLEIE             ; Unmask IDLE interrupt
                      00453 ;            USBDeviceState = POWERED_STATE;
0011EC 0104           00454         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0011EE 0E02           00455         movlw   POWERED_STATE
0011F0 6F17           00456         movwf   USBDeviceState
                      00457 ;        }
                      00458 ;    }
                      00459 
0011F2                00460 USBDeviceTasksA
                      00461 ;    /*
                      00462 ;     * Task A: Service USB Activity Interrupt
                      00463 ;     */
                      00464 ;    if(USBActivityIF && USBActivityIE)
0011F2 A468           00465         btfss   UIR, ACTVIF
0011F4 D002           00466         bra     USBDeviceTasks1
                      00467 #if (UIE < 0xf60)
                      00468         BANKSEL UIE
                      00469 #endif
0011F6 B469           00470         btfsc   UIE, ACTVIE
                      00471 ;    {
                      00472 ;        USBWakeFromSuspend();
0011F8 D84C           00473         rcall   USBWakeFromSuspend
                      00474 ;    }
                      00475 
0011FA                00476 USBDeviceTasks1
                      00477 ;    /*
                      00478 ;     * Pointless to continue servicing if the device is in suspend mode.
                      00479 ;     */
                      00480 ;    if(USBSuspendControl==1)
0011FA B26D           00481         btfsc   UCON, SUSPND            ; Are we suspended?
                      00482 ;    {
                      00483 ;        return;
0011FC 0012           00484         return                          ; Pointless to continue servicing if the device is in suspend mo
                            de.
                      00485 ;    }
                      00486 
                      00487 ;    /*
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00488 ;     * Task B: Service USB Bus Reset Interrupt.
                      00489 ;     * When bus reset is received during suspend, ACTVIF will be set first,
                      00490 ;     * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.
                      00491 ;     * This is why URSTIF is checked after ACTVIF.
                      00492 ;     *
                      00493 ;     * The USB reset flag is masked when the USB state is in
                      00494 ;     * DETACHED_STATE or ATTACHED_STATE, and therefore cannot
                      00495 ;     * cause a USB reset event during these two states.
                      00496 ;     */
                      00497 ;    if(USBResetIF && USBResetIE)
0011FE A068           00498         btfss   UIR, URSTIF             ; USB Bus Reset Interrupt?
001200 D00E           00499         bra     USBDeviceTasks2
                      00500 #if (UIE < 0xf60)
                      00501         BANKSEL UIE
                      00502 #endif
001202 A069           00503         btfss   UIE, URSTIE
001204 D00C           00504         bra     USBDeviceTasks2
                      00505 ;    {
                      00506 ;        USBDeviceInit();
001206 DFB7           00507         rcall   USBDeviceInit
                      00508 ;        USBDeviceState = DEFAULT_STATE;
001208 0104           00509         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00120A 0E04           00510         movlw   DEFAULT_STATE
00120C 6F17           00511         movwf   USBDeviceState
                      00512 
                      00513 ;        /********************************************************************
                      00514 ;        Bug Fix: Feb 26, 2007 v2.1 (#F1)
                      00515 ;        *********************************************************************
                      00516 ;        In the original firmware, if an OUT token is sent by the host
                      00517 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      00518 ;        This is not a correct response, the firmware should have sent a STALL.
                      00519 ;        This is a minor non-compliance since a compliant host should not
                      00520 ;        send an OUT before sending a SETUP token. The fix allows a SETUP
                      00521 ;        transaction to be accepted while stalling OUT transactions.
                      00522 ;        ********************************************************************/
                      00523 ;        BDT[EP0_OUT_EVEN].ADR = (BYTE*)&SetupPkt;
00120E 0E26           00524         movlw   low SetupPkt
001210 6F02           00525         movwf   ep0Bo + ADRL
001212 0E04           00526         movlw   high SetupPkt
001214 6F03           00527         movwf   ep0Bo + ADRH
                      00528 ;        BDT[EP0_OUT_EVEN].CNT = USB_EP0_BUFF_SIZE;
001216 0E40           00529         movlw   USB_EP0_BUFF_SIZE
001218 6F01           00530         movwf   ep0Bo + Cnt
                      00531 ;        BDT[EP0_OUT_EVEN].STAT.Val &= ~_STAT_MASK;
                      00532 ;       movf    ep0Bo + Stat, W
                      00533 ;       andlw   ~_STAT_MASK
                      00534 ;        BDT[EP0_OUT_EVEN].STAT.Val |= _USIE|_DAT0|_DTSEN|_BSTALL;
                      00535 ;       iorlw   _USIE|_DAT0|_DTSEN|_BSTALL
00121A 0E8C           00536         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
00121C 6F00           00537         movwf   ep0Bo + Stat
                      00538 ;    }
                      00539 
00121E                00540 USBDeviceTasks2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00541 ;    /*
                      00542 ;     * Task C: Service other USB interrupts
                      00543 ;     */
                      00544 ;    if(USBIdleIF && USBIdleIE)
00121E A868           00545         btfss   UIR, IDLEIF
001220 D004           00546         bra     USBDeviceTasks3
                      00547 #if (UIE < 0xf60)
                      00548         BANKSEL UIE
                      00549 #endif
001222 A869           00550         btfss   UIE, IDLEIE
001224 D002           00551         bra     USBDeviceTasks3
                      00552 ;    {
                      00553 ;        USBSuspend();
001226 D831           00554         rcall   USBSuspend
                      00555 ;        USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
001228 9868           00556         bcf     UIR, IDLEIF
                      00557 ;    }
                      00558 
00122A                00559 USBDeviceTasks3
                      00560 ;    if(USBSOFIF && USBSOFIE)
00122A AC68           00561         btfss   UIR, SOFIF
00122C D004           00562         bra     USBDeviceTasks4
                      00563 #if (UIE < 0xf60)
                      00564         BANKSEL UIE
                      00565 #endif
00122E AC69           00566         btfss   UIE, SOFIE
001230 D002           00567         bra     USBDeviceTasks4
                      00568 ;    {
                      00569 ;        USBCB_SOF_Handler();    // Required callback, see usbcallbacks.c
001232 DB96           00570         rcall   USBCB_SOF_Handler
                      00571 ;        USBClearInterruptFlag(USBSOFIFReg,USBSOFIFBitNum);
001234 9C68           00572         bcf     UIR, SOFIF
                      00573 ;    }
                      00574 
001236                00575 USBDeviceTasks4
                      00576  ;   if(USBStallIF && USBStallIE)
001236 AA68           00577         btfss   UIR, STALLIF
001238 D002           00578         bra     USBDeviceTasks5
                      00579 #if (UIE < 0xf60)
                      00580         BANKSEL UIE
                      00581 #endif
00123A BA69           00582         btfsc   UIE, STALLIE
                      00583 ;    {
                      00584 ;        USBStallHandler();
00123C D818           00585         rcall   USBStallHandler
                      00586 ;    }
                      00587 
00123E                00588 USBDeviceTasks5
                      00589 ;    if(USBErrorIF && USBErrorIE)
00123E A268           00590         btfss   UIR, UERRIF
001240 D004           00591         bra     USBDeviceTasks6
                      00592 #if (UIE < 0xf60)
                      00593         BANKSEL UIE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00594 #endif
001242 A269           00595         btfss   UIE, UERRIE
001244 D002           00596         bra     USBDeviceTasks6
                      00597 ;    {
                      00598 ;        USBCBErrorHandler();    // Required callback, see usbcallbacks.c
001246 DB8D           00599         rcall   USBCBErrorHandler
                      00600 ;        USBClearInterruptRegister(U1EIR);               // This clears UERRIF
001248 6A68           00601         clrf    UIR                     ; This clears UERRIF
                      00602 ;    }
                      00603 
00124A                00604 USBDeviceTasks6
                      00605 ;    /*
                      00606 ;     * Pointless to continue servicing if the host has not sent a bus reset.
                      00607 ;     * Once bus reset is received, the device transitions into the DEFAULT
                      00608 ;     * state and is ready for communication.
                      00609 ;     */
                      00610 ;    if(USBDeviceState < DEFAULT_STATE) return;
00124A 0104           00611         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00124C 0E04           00612         movlw   DEFAULT_STATE
00124E 5D17           00613         subwf   USBDeviceState, W
001250 E30D           00614         bnc     USBDriverTasksExit
                      00615 
                      00616 ;    /*
                      00617 ;     * Task D: Servicing USB Transaction Complete Interrupt
                      00618 ;     */
                      00619 ;    if(USBTransactionCompleteIE)
                      00620 #if (UIE < 0xf60)
                      00621         BANKSEL UIE
                      00622 #endif
001252 A669           00623         btfss   UIE, TRNIE
001254 0012           00624         return
                      00625 ;    {
                      00626 ;           for(i = 0; i < 4; i++)      //Drain or deplete the USAT FIFO entries.  If the USB FIFO ever 
                            gets full, USB bandwidth 
                      00627 ;               {                                               //utilization can be compromised, and th
                            e device won't be able to receive SETUP packets.
001256 0104           00628         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
001258 0E04           00629         movlw   4                       ; Drain or deplete the USAT FIFO entries.  If the USB FIFO ever 
                            gets full, USB bandwidth
00125A 6F22           00630         movwf   bTRNIFCount             ; utilization can be compromised, and the device won't be able t
                            o receive SETUP packets.
00125C                00631 USBDeviceTasks7
                      00632 ;                   if(USBTransactionCompleteIF)
00125C A668           00633         btfss   UIR, TRNIF
00125E 0012           00634         return
                      00635 ;                   {
                      00636 ;                       USTATcopy = U1STAT;
001260 506C           00637         movf    USTAT, W
001262 6F20           00638         movwf   USTATcopy
                      00639 
                      00640 ;                       USBClearInterruptFlag(USBTransactionCompleteIFReg,USBTransactionCompleteIFBitNum
                            );
001264 9668           00641         bcf     UIR, TRNIF
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00642 
                      00643 ;                       /*
                      00644 ;                        * USBCtrlEPService only services transactions over EP0.
                      00645 ;                        * It ignores all other EP transactions.
                      00646 ;                        */
                      00647 ;                       USBCtrlEPService();
001266 D81C           00648         rcall   USBCtrlEPService
                      00649 ;                   }//end if(USBTransactionCompleteIF)
                      00650 ;                   else
                      00651 ;                       break;  //USTAT FIFO must be empty.
                      00652 ;               }//end for()
001268 2F22           00653         decfsz  bTRNIFCount, F
00126A D7F8           00654         bra     USBDeviceTasks7
                      00655 ;       }//end if(USBTransactionCompleteIE)
00126C                00656 USBDriverTasksExit
00126C 0012           00657         return
                      00658 
                      00659 ;}//end of USBDeviceTasks()
                      00660 
                      00661 ;/********************************************************************
                      00662 ; * Function:        void USBStallHandler(void)
                      00663 ; *
                      00664 ; * PreCondition:    None
                      00665 ; *
                      00666 ; * Input:           None
                      00667 ; *
                      00668 ; * Output:          None
                      00669 ; *
                      00670 ;; * Side Effects:    
                      00671 ; *
                      00672 ; * Overview:        This function handles the event of a STALL 
                      00673 ; *                  occuring on the bus
                      00674 ; *
                      00675 ; * Note:            None
                      00676 ; *******************************************************************/
                      00677 ;void USBStallHandler(void)
00126E                00678 USBStallHandler
                      00679 ;{
                      00680 ;    /*
                      00681 ;     * Does not really have to do anything here,
                      00682 ;     * even for the control endpoint.
                      00683 ;     * All BDs of Endpoint 0 are owned by SIE right now,
                      00684 ;     * but once a Setup Transaction is received, the ownership
                      00685 ;     * for EP0_OUT will be returned to CPU.
                      00686 ;     * When the Setup Transaction is serviced, the ownership
                      00687 ;     * for EP0_IN will then be forced back to CPU by firmware.
                      00688 ;     */
                      00689 ;
                      00690 ;    /* v2b fix */
                      00691 ;    if(U1EP0bits.EPSTALL == 1)
                      00692 #if (UEP0 < 0xf60)
                      00693         BANKSEL UEP0
                      00694 #endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00126E A070           00695         btfss   UEP0, EPSTALL
001270 D00A           00696         bra     USBStallHandlerExit
                      00697 ;    {
                      00698 ;        // UOWN - if 0, owned by CPU, if 1, owned by SIE
                      00699 ;        if((pBDTEntryEP0OutCurrent->STAT.Val == _USIE) && (pBDTEntryIn[0]->STAT.Val == (_USIE|_BSTALL))
                            )
001272 0104           00700         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
001274 0E80           00701         movlw   _USIE                   ; UOWN - if 0, owned by CPU, if 1, owned by SIE
001276 6300           00702         cpfseq  ep0Bo + Stat
001278 D006           00703         bra     USBStallHandlerExit
00127A 0E84           00704         movlw   _USIE|_BSTALL
00127C 6304           00705         cpfseq  ep0Bi + Stat
00127E D003           00706         bra     USBStallHandlerExit
                      00707 ;        {
                      00708 ;            // Set ep0Bo to stall also
                      00709 ;            pBDTEntryEP0OutCurrent->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
001280 0E8C           00710         movlw   _USIE|_DAT0|_DTSEN|_BSTALL      ; Set ep0Bo to stall also
001282 6F00           00711         movwf   ep0Bo + Stat
                      00712 ;        }//end if
                      00713 ;        U1EP0bits.EPSTALL = 0;               // Clear stall status
                      00714 #if (UEP0 < 0xf60)
                      00715         BANKSEL UEP0
                      00716 #endif
001284 9070           00717         bcf     UEP0, EPSTALL           ; Clear stall status
                      00718 ;    }//end if
                      00719 
001286                00720 USBStallHandlerExit
                      00721 ;    USBClearInterruptFlag(USBSTALLIFReg,USBSTALLIFBitNum);
001286 9A68           00722         bcf     UIR, STALLIF
001288 0012           00723         return
                      00724 ;}
                      00725 
                      00726 ;/********************************************************************
                      00727 ; * Function:        void USBSuspend(void)
                      00728 ; *
                      00729 ; * PreCondition:    None
                      00730 ; *
                      00731 ; * Input:           None
                      00732 ; *
                      00733 ; * Output:          None
                      00734 ; *
                      00735 ; * Side Effects:    
                      00736 ; *
                      00737 ; * Overview:        This function handles if the host tries to 
                      00738 ; *                  suspend the device
                      00739 ; *
                      00740 ; * Note:            None
                      00741 ; *******************************************************************/
                      00742 ;void USBSuspend(void)
00128A                00743 USBSuspend
                      00744 ;{
                      00745 ;    /*
                      00746 ;     * NOTE: Do not clear UIRbits.ACTVIF here!
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00747 ;     * Reason:
                      00748 ;     * ACTVIF is only generated once an IDLEIF has been generated.
                      00749 ;     * This is a 1:1 ratio interrupt generation.
                      00750 ;     * For every IDLEIF, there will be only one ACTVIF regardless of
                      00751 ;     * the number of subsequent bus transitions.
                      00752 ;     *
                      00753 ;     * If the ACTIF is cleared here, a problem could occur when:
                      00754 ;     * [       IDLE       ][bus activity ->
                      00755 ;     * <--- 3 ms ----->     ^
                      00756 ;     *                ^     ACTVIF=1
                      00757 ;     *                IDLEIF=1
                      00758 ;     *  #           #           #           #   (#=Program polling flags)
                      00759 ;     *                          ^
                      00760 ;     *                          This polling loop will see both
                      00761 ;     *                          IDLEIF=1 and ACTVIF=1.
                      00762 ;     *                          However, the program services IDLEIF first
                      00763 ;     *                          because ACTIVIE=0.
                      00764 ;     *                          If this routine clears the only ACTIVIF,
                      00765 ;     *                          then it can never get out of the suspend
                      00766 ;     *                          mode.
                      00767 ;     */
                      00768 ;    USBActivityIE = 1;                     // Enable bus activity interrupt
                      00769 #if (UIE < 0xf60)
                      00770         BANKSEL UIE
                      00771 #endif
00128A 8469           00772         bsf     UIE, ACTVIE             ; Enable bus activity interrupt
                      00773 ;    USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
00128C 9868           00774         bcf     UIR, IDLEIF
                      00775 
                      00776 ;#if defined(__18CXX)
                      00777 ;    U1CONbits.SUSPND = 1;                   // Put USB module in power conserve
00128E 826D           00778         bsf     UCON, SUSPND            ; Put USB module in power conserve
                      00779                                         ; mode, SIE clock inactive
                      00780 ;#endif
                      00781 
                      00782 
                      00783 ;    /*
                      00784 ;     * At this point the PIC can go into sleep,idle, or
                      00785 ;     * switch to a slower clock, etc.  This should be done in the
                      00786 ;     * USBCBSuspend() if necessary.
                      00787 ;     */
                      00788 ;    USBCBSuspend();             // Required callback, see usbcallbacks.c
001290 D365           00789         bra     USBCBSuspend
                      00790 ;}
                      00791 
                      00792 ;/********************************************************************
                      00793 ; * Function:        void USBWakeFromSuspend(void)
                      00794 ; *
                      00795 ; * PreCondition:    None
                      00796 ; *
                      00797 ; * Input:           None
                      00798 ; *
                      00799 ; * Output:          None
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00800 ; *
                      00801 ; * Side Effects:    None
                      00802 ; *
                      00803 ; * Overview:
                      00804 ; *
                      00805 ; * Note:            None
                      00806 ; *******************************************************************/
                      00807 ;void USBWakeFromSuspend(void)
001292                00808 USBWakeFromSuspend
                      00809 ;{
                      00810 ;    #if defined(__18CXX)
                      00811 ;    U1CONbits.SUSPND = 0;                   // Bring USB module out of power conserve
                      00812 ;                                            // mode.
001292 926D           00813         bcf     UCON, SUSPND            ; Bring USB module out of power conserve mode
                      00814 ;    #endif
                      00815 
                      00816 ;    /*
                      00817 ;     * If using clock switching, the place to restore the original
                      00818 ;     * microcontroller core clock frequency is in the USBCBWakeFromSuspend() callback
                      00819 ;     */
                      00820 ;    USBCBWakeFromSuspend(); // Required callback, see usbcallbacks.c
001294 DB64           00821         rcall   USBCBWakeFromSuspend
                      00822 
                      00823 ;    USBActivityIE = 0;
                      00824 #if (UIE < 0xf60)
                      00825         BANKSEL UIE
                      00826 #endif
001296 9469           00827         bcf     UIE, ACTVIE
                      00828 
                      00829 ;    /********************************************************************
                      00830 ;    Bug Fix: Feb 26, 2007 v2.1
                      00831 ;    *********************************************************************
                      00832 ;    The ACTVIF bit cannot be cleared immediately after the USB module wakes
                      00833 ;    up from Suspend or while the USB module is suspended. A few clock cycles
                      00834 ;    are required to synchronize the internal hardware state machine before
                      00835 ;    the ACTIVIF bit can be cleared by firmware. Clearing the ACTVIF bit
                      00836 ;    before the internal hardware is synchronized may not have an effect on
                      00837 ;    the value of ACTVIF. Additonally, if the USB module uses the clock from
                      00838 ;    the 96 MHz PLL source, then after clearing the SUSPND bit, the USB
                      00839 ;    module may not be immediately operational while waiting for the 96 MHz
                      00840 ;    PLL to lock.
                      00841 ;    ********************************************************************/
                      00842 
                      00843 ;    // UIRbits.ACTVIF = 0;                      // Removed
                      00844 ;    #if defined(__18CXX)
                      00845 ;    while(USBActivityIF)
001298                00846 USBWakeFromSuspendLoop
001298 A468           00847         btfss   UIR, ACTVIF
00129A 0012           00848         return
                      00849 ;    #endif
                      00850 ;    {
                      00851 ;        USBClearInterruptFlag(USBActivityIFReg,USBActivityIFBitNum);
00129C 9468           00852         bcf     UIR, ACTVIF
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00853 ;    }  // Added
00129E D7FC           00854         bra     USBWakeFromSuspendLoop
                      00855 
                      00856 ;}//end USBWakeFromSuspend
                      00857 
                      00858 ;/********************************************************************
                      00859 ; * Function:        void USBCtrlEPService(void)
                      00860 ; *
                      00861 ; * PreCondition:    USTAT is loaded with a valid endpoint address.
                      00862 ; *
                      00863 ; * Input:           None
                      00864 ; *
                      00865 ; * Output:          None
                      00866 ; *
                      00867 ; * Side Effects:    None
                      00868 ; *
                      00869 ; * Overview:        USBCtrlEPService checks for three transaction
                      00870 ; *                  types that it knows how to service and services
                      00871 ; *                  them:
                      00872 ; *                  1. EP0 SETUP
                      00873 ; *                  2. EP0 OUT
                      00874 ; *                  3. EP0 IN
                      00875 ; *                  It ignores all other types (i.e. EP1, EP2, etc.)
                      00876 ; *
                      00877 ; * Note:            None
                      00878 ; *******************************************************************/
                      00879 ;void USBCtrlEPService(void)
0012A0                00880 USBCtrlEPService
                      00881 ;{
0012A0 0104           00882         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00883 ;       //If the last packet was a EP0 OUT packet
                      00884 ;    if((USTATcopy & USTAT_EP0_PP_MASK) == USTAT_EP0_OUT_EVEN)
0012A2 5120           00885         movf    USTATcopy, W
0012A4 0BFD           00886         andlw   USTAT_EP0_PP_MASK
0012A6 0800           00887         sublw   USTAT_EP0_OUT
0012A8 E105           00888         bnz     USBCtrlEPService1
                      00889 ;    {
                      00890 ;               //Point to the EP0 OUT buffer of the buffer that arrived
                      00891 ;        #if defined(__18CXX)
                      00892 ;            pBDTEntryEP0OutCurrent = (volatile BDT_ENTRY*)&BDT[(USTATcopy & USTAT_EP_MASK)>>1];
                      00893 ;        #elif defined(__C30__)
                      00894 ;            pBDTEntryEP0OutCurrent = (volatile BDT_ENTRY*)&BDT[(USTATcopy & USTAT_EP_MASK)>>2];
                      00895 ;        #else
                      00896 ;            #error "unimplemented"
                      00897 ;        #endif
                      00898 
                      00899 ;               //Set the next out to the current out packet
                      00900 ;        pBDTEntryEP0OutNext = pBDTEntryEP0OutCurrent;
                      00901 ;               //Toggle it to the next ping pong buffer (if applicable)
                      00902 ;        ((BYTE_VAL*)&pBDTEntryEP0OutNext)->Val ^= USB_NEXT_EP0_OUT_PING_PONG;
                      00903 
                      00904 ;               //If the current EP0 OUT buffer has a SETUP token
                      00905 ;        if(pBDTEntryEP0OutCurrent->STAT.PID == SETUP_TOKEN)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012AA 5100           00906         movf    ep0Bo + Stat, W
0012AC 0B3C           00907         andlw   0x3c                    ; Mask to PID
0012AE 0834           00908         sublw   (SETUP_TOKEN) << 2
                      00909 ;        {
                      00910 ;                       //Handle the control transfer
                      00911 ;            USBCtrlTrfSetupHandler();
0012B0 E006           00912         bz      USBCtrlTrfSetupHandler
                      00913 ;        }
                      00914 ;        else
                      00915 ;        {
                      00916 ;                       //Handle the DATA transfer
                      00917 ;            USBCtrlTrfOutHandler();
0012B2 D013           00918         bra     USBCtrlTrfOutHandler
                      00919 ;        }
                      00920 ;    }
                      00921 ;    else if((USTATcopy & USTAT_EP0_PP_MASK) == USTAT_EP0_IN)
0012B4                00922 USBCtrlEPService1
0012B4 5120           00923         movf    USTATcopy, W
0012B6 0BFD           00924         andlw   USTAT_EP0_PP_MASK
0012B8 0804           00925         sublw   USTAT_EP0_IN
                      00926 ;    {
                      00927 ;               //Otherwise the transmission was and EP0 IN
                      00928 ;               //  so take care of the IN transfer
                      00929 ;        USBCtrlTrfInHandler();
0012BA E014           00930         bz      USBCtrlTrfInHandler
                      00931 ;    }
0012BC 0012           00932         return
                      00933 
                      00934 ;}//end USBCtrlEPService
                      00935 
                      00936 ;/********************************************************************
                      00937 ; * Function:        void USBCtrlTrfSetupHandler(void)
                      00938 ; *
                      00939 ; * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data
                      00940 ; *
                      00941 ; * Input:           None
                      00942 ; *
                      00943 ; * Output:          None
                      00944 ; *
                      00945 ; * Side Effects:    None
                      00946 ; *
                      00947 ; * Overview:        This routine is a task dispatcher and has 3 stages.
                      00948 ; *                  1. It initializes the control transfer state machine.
                      00949 ; *                  2. It calls on each of the module that may know how to
                      00950 ; *                     service the Setup Request from the host.
                      00951 ; *                     Module Example: USBD, HID, CDC, MSD, ...
                      00952 ; *                     A callback function, USBCBCheckOtherReq(),
                      00953 ; *                     is required to call other module handlers.
                      00954 ; *                  3. Once each of the modules has had a chance to check if
                      00955 ; *                     it is responsible for servicing the request, stage 3
                      00956 ; *                     then checks direction of the transfer to determine how
                      00957 ; *                     to prepare EP0 for the control transfer.
                      00958 ; *                     Refer to USBCtrlEPServiceComplete() for more details.
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00959 ; *
                      00960 ; * Note:            Microchip USB Firmware has three different states for
                      00961 ; *                  the control transfer state machine:
                      00962 ; *                  1. WAIT_SETUP
                      00963 ; *                  2. CTRL_TRF_TX
                      00964 ; *                  3. CTRL_TRF_RX
                      00965 ; *                  Refer to firmware manual to find out how one state
                      00966 ; *                  is transitioned to another.
                      00967 ; *
                      00968 ; *                  A Control Transfer is composed of many USB transactions.
                      00969 ; *                  When transferring data over multiple transactions,
                      00970 ; *                  it is important to keep track of data source, data
                      00971 ; *                  destination, and data count. These three parameters are
                      00972 ; *                  stored in pSrc,pDst, and wCount. A flag is used to
                      00973 ; *                  note if the data source is from ROM or RAM.
                      00974 ; *
                      00975 ; *******************************************************************/
                      00976 ;void USBCtrlTrfSetupHandler(void)
0012BE                00977 USBCtrlTrfSetupHandler
                      00978 ;{
0012BE 0104           00979         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00980 ;       //if the SIE currently owns the buffer
                      00981 ;    if(pBDTEntryIn[0]->STAT.UOWN != 0)
                      00982 ;    {
                      00983 ;               //give control back to the CPU
                      00984 ;               //  Compensate for after a STALL
                      00985 ;        pBDTEntryIn[0]->STAT.Val = _UCPU;           
                      00986 ;    }
0012C0 0E00           00987         movlw   _UCPU
0012C2 BF04           00988         btfsc   ep0Bi + Stat, UOWN
0012C4 6F04           00989         movwf   ep0Bi + Stat
                      00990 
                      00991 ;       //Keep track of if a short packet has been sent yet or not
                      00992 ;    shortPacketStatus = SHORT_PKT_NOT_USED;
0012C6 0E00           00993         movlw   SHORT_PKT_NOT_USED
0012C8 6F1F           00994         movwf   shortPacketStatus
                      00995 
                      00996 ;    /* Stage 1 */
                      00997 ;    controlTransferState = WAIT_SETUP;
0012CA 0E00           00998         movlw   WAIT_SETUP
0012CC 6F1A           00999         movwf   controlTransferState
                      01000 
                      01001 ;    inPipes[0].wCount.Val = 0;
0012CE 6B1B           01002         clrf    inCount
0012D0 6B1C           01003         clrf    inCount + 1
                      01004 ;    inPipes[0].info.Val = 0;
0012D2 6B23           01005         clrf    info
                      01006 
                      01007 ;    /* Stage 2 */
                      01008 ;    USBCheckStdRequest();
0012D4 D854           01009         rcall   USBCheckStdRequest
                      01010 ;    USBCBCheckOtherReq();   // Required callback, see usbcallbacks.c
0012D6 DB46           01011         rcall   USBCBCheckOtherReq      ; Class request
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01012 
                      01013 ;    /* Stage 3 */
                      01014 ;    USBCtrlEPServiceComplete();
0012D8 D15C           01015         bra     USBCtrlEPServiceComplete
                      01016 
                      01017 ;}//end USBCtrlTrfSetupHandler
                      01018 
                      01019 ;/******************************************************************************
                      01020 ; * Function:        void USBCtrlTrfOutHandler(void)
                      01021 ; *
                      01022 ; * PreCondition:    None
                      01023 ; *
                      01024 ; * Input:           None
                      01025 ; *
                      01026 ; * Output:          None
                      01027 ; *
                      01028 ; * Side Effects:    None
                      01029 ; *
                      01030 ; * Overview:        This routine handles an OUT transaction according to
                      01031 ; *                  which control transfer state is currently active.
                      01032 ; *
                      01033 ; * Note:            Note that if the the control transfer was from
                      01034 ; *                  host to device, the session owner should be notified
                      01035 ; *                  at the end of each OUT transaction to service the
                      01036 ; *                  received data.
                      01037 ; *
                      01038 ; *****************************************************************************/
                      01039 ;void USBCtrlTrfOutHandler(void)
0012DA                01040 USBCtrlTrfOutHandler
                      01041 ;{
0012DA 0104           01042         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01043 ;    if(controlTransferState == CTRL_TRF_RX)
0012DC 0E02           01044         movlw   CTRL_TRF_RX
0012DE 631A           01045         cpfseq  controlTransferState
0012E0 D023           01046         bra     USBPrepareForNextSetupTrf
                      01047 ;    {
                      01048 ;        USBCtrlTrfRxService();
0012E2 D1F5           01049         bra     USBCtrlTrfRxService
                      01050 
                      01051 ;    }
                      01052 ;    else    // CTRL_TRF_TX
                      01053 ;    {
                      01054 ;        USBPrepareForNextSetupTrf();
                      01055 ;    }
                      01056 ;}
                      01057 
                      01058 ;/******************************************************************************
                      01059 ; * Function:        void USBCtrlTrfInHandler(void)
                      01060 ; *
                      01061 ; * PreCondition:    None
                      01062 ; *
                      01063 ; * Input:           None
                      01064 ; *
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01065 ; * Output:          None
                      01066 ; *
                      01067 ; * Side Effects:    None
                      01068 ; *
                      01069 ; * Overview:        This routine handles an IN transaction according to
                      01070 ; *                  which control transfer state is currently active.
                      01071 ; *
                      01072 ; *
                      01073 ; * Note:            A Set Address Request must not change the acutal address
                      01074 ; *                  of the device until the completion of the control
                      01075 ; *                  transfer. The end of the control transfer for Set Address
                      01076 ; *                  Request is an IN transaction. Therefore it is necessary
                      01077 ; *                  to service this unique situation when the condition is
                      01078 ; *                  right. Macro mUSBCheckAdrPendingState is defined in
                      01079 ; *                  usb9.h and its function is to specifically service this
                      01080 ; *                  event.
                      01081 ; *****************************************************************************/
                      01082 ;void USBCtrlTrfInHandler(void)
0012E4                01083 USBCtrlTrfInHandler
                      01084 ;{
0012E4 0104           01085         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01086 ;    BYTE lastDTS;
                      01087 
                      01088 ;    lastDTS = pBDTEntryIn[0]->STAT.DTS;
0012E6 6B21           01089         clrf    lastDTS
0012E8 BD04           01090         btfsc   ep0Bi + Stat, DTS
0012EA 6921           01091         setf    lastDTS
                      01092 
                      01093 ;    //switch to the next ping pong buffer
                      01094 ;    ((BYTE_VAL*)&pBDTEntryIn[0])->Val ^= USB_NEXT_EP0_IN_PING_PONG;
                      01095 
                      01096 ;    //mUSBCheckAdrPendingState();       // Must check if in ADR_PENDING_STATE
                      01097 ;    if(USBDeviceState == ADR_PENDING_STATE)
0012EC 0E08           01098         movlw   ADR_PENDING_STATE       ; Must check if in ADR_PENDING_STATE
0012EE 6317           01099         cpfseq  USBDeviceState
0012F0 D007           01100         bra     USBCtrlTrfInHandler1
                      01101 ;    {
                      01102 ;        U1ADDR = SetupPkt.bDevADR.Val;
0012F2 5128           01103         movf    SetupPkt + bDevADR, W
                      01104 #if (UADDR < 0xf60)
                      01105         BANKSEL UADDR
                      01106 #endif
0012F4 6E6E           01107         movwf   UADDR
                      01108 ;        if(U1ADDR > 0)
                      01109 ;        {
                      01110 ;            USBDeviceState=ADDRESS_STATE;
                      01111 ;        }
                      01112 ;        else
                      01113 ;        {
                      01114 ;            USBDeviceState=DEFAULT_STATE;
                      01115 ;        }
0012F6 0104           01116         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0012F8 0E10           01117         movlw   ADDRESS_STATE           ; If UADDR > 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012FA B4D8           01118         btfsc   STATUS, Z               ; Set from above
0012FC 0E04           01119         movlw   DEFAULT_STATE
0012FE 6F17           01120         movwf   USBDeviceState
                      01121 ;    }//end if
                      01122 
                      01123 
001300                01124 USBCtrlTrfInHandler1
                      01125 ;    if(controlTransferState == CTRL_TRF_TX)
001300 0E01           01126         movlw   CTRL_TRF_TX
001302 631A           01127         cpfseq  controlTransferState
001304 D011           01128         bra     USBPrepareForNextSetupTrf
                      01129 ;    {
                      01130 ;        pBDTEntryIn[0]->ADR = (BYTE *)CtrlTrfData;
001306 0E66           01131         movlw   low CtrlTrfData
001308 6F06           01132         movwf   ep0Bi + ADRL
00130A 0E04           01133         movlw   high CtrlTrfData
00130C 6F07           01134         movwf   ep0Bi + ADRH
                      01135 ;        USBCtrlTrfTxService();
00130E D990           01136         rcall   USBCtrlTrfTxService
                      01137 
                      01138 ;        /* v2b fix */
                      01139 ;        if(shortPacketStatus == SHORT_PKT_SENT)
001310 0104           01140         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
001312 0E02           01141         movlw   SHORT_PKT_SENT
001314 631F           01142         cpfseq  shortPacketStatus
001316 D003           01143         bra     USBCtrlTrfInHandler2
                      01144 ;        {
                      01145 ;            // If a short packet has been sent, don't want to send any more,
                      01146 ;            // stall next time if host is still trying to read.
                      01147 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL;
001318 0E84           01148         movlw   _USIE|_BSTALL           ; If a short packet has been sent, don't want to send any more,
00131A 6F04           01149         movwf   ep0Bi + Stat            ; stall next time if host is still trying to read.
00131C 0012           01150         return
                      01151 ;        }
                      01152 ;        else
00131E                01153 USBCtrlTrfInHandler2
                      01154 ;        {
                      01155 ;            if(lastDTS == 0)
                      01156 ;            {
                      01157 ;                pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
                      01158 ;            }
                      01159 ;            else
                      01160 ;            {
                      01161 ;                pBDTEntryIn[0]->STAT.Val = _USIE|_DAT0|_DTSEN;
                      01162 ;            }
00131E 0EC8           01163         movlw   _USIE|_DAT1|_DTSEN
001320 6721           01164         tstfsz  lastDTS
001322 0E88           01165         movlw   _USIE|_DAT0|_DTSEN
001324 6F04           01166         movwf   ep0Bi + Stat
001326 0012           01167         return
                      01168 ;        }//end if(...)else
                      01169 ;    }
                      01170 ;    else // CTRL_TRF_RX
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01171 ;    {
                      01172 ;        USBPrepareForNextSetupTrf();
                      01173 ;    }
                      01174 ;}
                      01175 
                      01176 ;/********************************************************************
                      01177 ; * Function:        void USBPrepareForNextSetupTrf(void)
                      01178 ; *
                      01179 ; * PreCondition:    None
                      01180 ; *
                      01181 ; * Input:           None
                      01182 ; *
                      01183 ; * Output:          None
                      01184 ; *
                      01185 ; * Side Effects:    None
                      01186 ; *
                      01187 ; * Overview:        The routine forces EP0 OUT to be ready for a new
                      01188 ; *                  Setup transaction, and forces EP0 IN to be owned
                      01189 ; *                  by CPU.
                      01190 ; *
                      01191 ; * Note:            None
                      01192 ; *******************************************************************/
                      01193 ;void USBPrepareForNextSetupTrf(void)
001328                01194 USBPrepareForNextSetupTrf
                      01195 ;{
001328 0104           01196         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01197 ;    /********************************************************************
                      01198 ;    Bug Fix: Feb 26, 2007 v2.1
                      01199 ;    *********************************************************************
                      01200 ;    Facts:
                      01201 ;    A Setup Packet should never be stalled. (USB 2.0 Section 8.5.3)
                      01202 ;    If a Setup PID is detected by the SIE, the DTSEN setting is ignored.
                      01203 ;    This causes a problem at the end of a control write transaction.
                      01204 ;    In USBCtrlEPServiceComplete(), during a control write (Host to Device),
                      01205 ;    the EP0_OUT is setup to write any data to the CtrlTrfData buffer.
                      01206 ;    If <SETUP[0]><IN[1]> is completed and USBCtrlTrfInHandler() is not
                      01207 ;    called before the next <SETUP[0]> is received, then the latest Setup
                      01208 ;    data will be written to the CtrlTrfData buffer instead of the SetupPkt
                      01209 ;    buffer.
                      01210 ;
                      01211 ;    If USBCtrlTrfInHandler() was called before the latest <SETUP[0]> is
                      01212 ;    received, then there would be no problem,
                      01213 ;    because USBPrepareForNextSetupTrf() would have been called and updated
                      01214 ;    ep0Bo.ADR to point to the SetupPkt buffer.
                      01215 ;
                      01216 ;    Work around:
                      01217 ;    Check for the problem as described above and copy the Setup data from
                      01218 ;    CtrlTrfData to SetupPkt.
                      01219 ;    ********************************************************************/
                      01220 ;    if((controlTransferState == CTRL_TRF_RX) &&
00132A 0E02           01221         movlw   CTRL_TRF_RX
00132C 631A           01222         cpfseq  controlTransferState
00132E D019           01223         bra     USBPrepareForNextSetupTrf1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01224 ;       (USBPacketDisable == 1) &&
001330 A86D           01225         btfss   UCON, PKTDIS
001332 D017           01226         bra     USBPrepareForNextSetupTrf1
                      01227 ;       (pBDTEntryEP0OutCurrent->CNT == sizeof(CTRL_TRF_SETUP)) &&
001334 0E40           01228         movlw   USB_EP0_BUFF_SIZE
001336 6301           01229         cpfseq  ep0Bo + Cnt
001338 D014           01230         bra     USBPrepareForNextSetupTrf1
                      01231 ;       (pBDTEntryEP0OutCurrent->STAT.PID == SETUP_TOKEN) &&
00133A 5100           01232         movf    ep0Bo + Stat, W
00133C 0B3C           01233         andlw   0x3c                    ; Mask to PID
00133E 0834           01234         sublw   (SETUP_TOKEN) << 2
001340 E110           01235         bnz     USBPrepareForNextSetupTrf1
                      01236 ;       (pBDTEntryEP0OutNext->STAT.UOWN == 0))
001342 BF00           01237         btfsc   ep0Bo + Stat, UOWN
001344 D00E           01238         bra     USBPrepareForNextSetupTrf1
                      01239 ;    {
                      01240 ;        unsigned char setup_cnt;
                      01241 
                      01242 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
001346 0E26           01243         movlw   low SetupPkt
001348 6F02           01244         movwf   ep0Bo + ADRL
00134A 0E04           01245         movlw   high SetupPkt
00134C 6F03           01246         movwf   ep0Bo + ADRH
                      01247 
                      01248 ;        // The Setup data was written to the CtrlTrfData buffer, must copy
                      01249 ;        // it back to the SetupPkt buffer so that it can be processed correctly
                      01250 ;        // by USBCtrlTrfSetupHandler().
                      01251 ;        for(setup_cnt = 0; setup_cnt < sizeof(CTRL_TRF_SETUP); setup_cnt++)
                      01252 ;        {
                      01253 ;            *(((BYTE*)&SetupPkt)+setup_cnt) = *(((BYTE*)&CtrlTrfData)+setup_cnt);
                      01254 ;        }//end for
00134E EE14 F066      01255         lfsr    1, CtrlTrfData
001352 EE24 F026      01256         lfsr    2, SetupPkt
001356 0E40           01257         movlw   USB_EP0_BUFF_SIZE
001358                01258 USBPrepareForNextSetupTrfLoop
001358 CFE6 FFDE      01259         movff   POSTINC1, POSTINC2
00135C 2EE8           01260         decfsz  WREG, F
00135E D7FC           01261         bra     USBPrepareForNextSetupTrfLoop
001360 D00C           01262         bra     USBPrepareForNextSetupTrf2
                      01263 ;    }
                      01264 ;    /* End v3b fix */
                      01265 ;    else
001362                01266 USBPrepareForNextSetupTrf1
                      01267 ;    {
                      01268 ;        controlTransferState = WAIT_SETUP;
001362 0E00           01269         movlw   WAIT_SETUP
001364 6F1A           01270         movwf   controlTransferState
                      01271 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;      // Defined in usb_config.h
001366 0E40           01272         movlw   USB_EP0_BUFF_SIZE
001368 6F01           01273         movwf   ep0Bo + Cnt
                      01274 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
00136A 0E26           01275         movlw   low SetupPkt
00136C 6F02           01276         movwf   ep0Bo + ADRL
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00136E 0E04           01277         movlw   high SetupPkt
001370 6F03           01278         movwf   ep0Bo + ADRH
                      01279 
                      01280 ;        /********************************************************************
                      01281 ;        Bug Fix: Feb 26, 2007 v2.1 (#F1)
                      01282 ;        *********************************************************************
                      01283 ;        In the original firmware, if an OUT token is sent by the host
                      01284 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      01285 ;        This is not a correct response, the firmware should have sent a STALL.
                      01286 ;        This is a minor non-compliance since a compliant host should not
                      01287 ;        send an OUT before sending a SETUP token. The fix allows a SETUP
                      01288 ;        transaction to be accepted while stalling OUT transactions.
                      01289 ;        ********************************************************************/
                      01290 ;        //ep0Bo.Stat.Val = _USIE|_DAT0|_DTSEN;        // Removed
                      01291 ;        pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;  //Added #F1
001372 0E8C           01292         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
001374 6F00           01293         movwf   ep0Bo + Stat
                      01294 
                      01295 ;        /********************************************************************
                      01296 ;        Bug Fix: Feb 26, 2007 v2.1 (#F3)
                      01297 ;        *********************************************************************
                      01298 ;        In the original firmware, if an IN token is sent by the host
                      01299 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      01300 ;        This is not a correct response, the firmware should have sent a STALL.
                      01301 ;        This is a minor non-compliance since a compliant host should not
                      01302 ;        send an IN before sending a SETUP token.
                      01303 
                      01304 ;        Comment why this fix (#F3) is interfering with fix (#AF1).
                      01305 ;        ********************************************************************/
                      01306 ;        pBDTEntryIn[0]->STAT.Val = _UCPU;             // Should be removed
                      01307 
                      01308 ;        {
                      01309 ;            BDT_ENTRY* p;
                      01310 
                      01311 ;            p = (BDT_ENTRY*)(((unsigned int)pBDTEntryIn[0])^USB_NEXT_EP0_IN_PING_PONG);
                      01312 ;            p->STAT.Val = _UCPU;
001376 0E00           01313         movlw   _UCPU                   ; EP0 IN buffer initialization
001378 6F04           01314         movwf   ep0Bi + Stat
                      01315 ;        }
                      01316 
                      01317 ;        //ep0Bi.Stat.Val = _USIE|_BSTALL;   // Should be added #F3
                      01318 ;    }
                      01319 
00137A                01320 USBPrepareForNextSetupTrf2
                      01321 ;    //if someone is still expecting data from the control transfer
                      01322 ;    //  then make sure to terminate that request and let them know that
                      01323 ;    //  they are done
                      01324 ;    if(outPipes[0].info.bits.busy == 1)
                      01325 ;    {
                      01326 ;        if(outPipes[0].pFunc != NULL)
                      01327 ;        {
                      01328 ;            outPipes[0].pFunc();
                      01329 ;        }
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01330 ;        outPipes[0].info.bits.busy = 0;
00137A 9F24           01331         bcf     outfo, busy
                      01332 ;    }
00137C 0012           01333         return
                      01334 
                      01335 ;}//end USBPrepareForNextSetupTrf
                      01336 
                      01337 ;/********************************************************************
                      01338 ; * Function:        void USBCheckStdRequest(void)
                      01339 ; *
                      01340 ; * PreCondition:    None
                      01341 ; *
                      01342 ; * Input:           None
                      01343 ; *
                      01344 ; * Output:          None
                      01345 ; *
                      01346 ; * Side Effects:    None
                      01347 ; *
                      01348 ; * Overview:        This routine checks the setup data packet to see
                      01349 ; *                  if it knows how to handle it
                      01350 ; *
                      01351 ; * Note:            None
                      01352 ; *******************************************************************/
                      01353 ;void USBCheckStdRequest(void)
00137E                01354 USBCheckStdRequest
                      01355 ;{
00137E 0104           01356         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01357 ;    if(SetupPkt.RequestType != STANDARD) return;
001380 5126           01358         movf    SetupPkt, W             ; RequestType = STANDARD?
001382 0B60           01359         andlw   0x60                    ; Mask to proper bits
001384 0800           01360         sublw   (STANDARD) << 5
001386 E106           01361         bnz     USBCheckStdRequestExit  ; No
                      01362 
                      01363 ;    switch(SetupPkt.bRequest)
                      01364 ;    {
                      01365 ;        case SET_ADR:
001388 0E05           01366         movlw   SET_ADR                 ; Handle request
00138A 6327           01367         cpfseq  SetupPkt + bRequest
00138C D004           01368         bra     USBCheckStdRequest1
                      01369 ;            inPipes[0].info.bits.busy = 1;            // This will generate a zero length packet
00138E 8F23           01370         bsf     info, busy
                      01371 ;            USBDeviceState = ADR_PENDING_STATE;       // Update state only
001390 0E08           01372         movlw   ADR_PENDING_STATE       ; Update state only
001392 6F17           01373         movwf   USBDeviceState
                      01374 ;            /* See USBCtrlTrfInHandler() for the next step */
                      01375 ;            break;
001394                01376 USBCheckStdRequestExit
001394 0012           01377         return
001396                01378 USBCheckStdRequest1
                      01379 ;        case GET_DSC:
001396 0E06           01380         movlw   GET_DSC
001398 5D27           01381         subwf   SetupPkt + bRequest, W
00139A E06E           01382         bz      USBStdGetDscHandler
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01383 ;       cpfseq  SetupPkt + bRequest
                      01384 ;       bra     USBCheckStdRequest2
                      01385 ;            USBStdGetDscHandler();
                      01386 ;       bra     USBStdGetDscHandler
                      01387 ;            break;
                      01388 ;USBCheckStdRequest2
                      01389 ;        case SET_CFG:
00139C 0E09           01390         movlw   SET_CFG
00139E 6327           01391         cpfseq  SetupPkt + bRequest
0013A0 D001           01392         bra     USBCheckStdRequest3
                      01393 ;            USBStdSetCfgHandler();
0013A2 D1C3           01394         bra     USBStdSetCfgHandler
                      01395 ;            break;
0013A4                01396 USBCheckStdRequest3
                      01397 ;        case GET_CFG:
0013A4 0E08           01398         movlw   GET_CFG
0013A6 6327           01399         cpfseq  SetupPkt + bRequest
0013A8 D00C           01400         bra     USBCheckStdRequest4
                      01401 ;            inPipes[0].pSrc.bRam = (BYTE*)&USBActiveConfiguration;         // Set Source
                      01402         mSetSourcePointer USBActiveConfiguration
0013AA 0E18               M         movlw   low (USBActiveConfiguration)
0013AC 6F12               M         movwf   pSrc
0013AE 0E04               M         movlw   high (USBActiveConfiguration)
0013B0 6F13               M         movwf   pSrc + 1
0013B2 0E00               M         movlw   upper (USBActiveConfiguration)
0013B4 6F14               M         movwf   pSrc + 2
                      01403 ;            inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
0013B6 8123           01404         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01405 ;            inPipes[0].wCount.v[0] = 1;                         // Set data count
0013B8 0E01           01406         movlw   1
0013BA 6F1B           01407         movwf   inCount
0013BC 6B1C           01408         clrf    inCount + 1
                      01409 ;            inPipes[0].info.bits.busy = 1;
0013BE 8F23           01410         bsf     info, busy
                      01411 ;            break;
0013C0 0012           01412         return
0013C2                01413 USBCheckStdRequest4
                      01414 ;        case GET_STATUS:
0013C2 0E00           01415         movlw   GET_STATUS
0013C4 6327           01416         cpfseq  SetupPkt + bRequest
0013C6 D001           01417         bra     USBCheckStdRequest5
                      01418 ;            USBStdGetStatusHandler();
0013C8 D0BC           01419         bra     USBStdGetStatusHandler
                      01420 ;            break;
0013CA                01421 USBCheckStdRequest5
                      01422 ;        case CLR_FEATURE:
0013CA 0E01           01423         movlw   CLR_FEATURE
0013CC 5D27           01424         subwf   SetupPkt + bRequest, W
0013CE E022           01425         bz      USBStdFeatureReqHandler
                      01426 ;       cpfseq  SetupPkt + bRequest
                      01427 ;       bra     USBCheckStdRequest6
                      01428 ;       bra     USBStdFeatureReqHandler
                      01429 ;USBCheckStdRequest6
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01430 ;        case SET_FEATURE:
0013D0 0E03           01431         movlw   SET_FEATURE
0013D2 5D27           01432         subwf   SetupPkt + bRequest, W
0013D4 E01F           01433         bz      USBStdFeatureReqHandler
                      01434 ;       cpfseq  SetupPkt + bRequest
                      01435 ;       bra     USBCheckStdRequest7
                      01436 ;            USBStdFeatureReqHandler();
                      01437 ;       bra     USBStdFeatureReqHandler
                      01438 ;            break;
                      01439 ;USBCheckStdRequest7
                      01440 ;        case GET_INTF:
0013D6 0E0A           01441         movlw   GET_INTF
0013D8 6327           01442         cpfseq  SetupPkt + bRequest
0013DA D00E           01443         bra     USBCheckStdRequest8
                      01444 ;            inPipes[0].pSrc.bRam = (BYTE*)&USBAlternateInterface+SetupPkt.bIntfID;  // Set source
                      01445         mSetSourcePointer USBAlternateInterface
0013DC 0E19               M         movlw   low (USBAlternateInterface)
0013DE 6F12               M         movwf   pSrc
0013E0 0E04               M         movlw   high (USBAlternateInterface)
0013E2 6F13               M         movwf   pSrc + 1
0013E4 0E00               M         movlw   upper (USBAlternateInterface)
0013E6 6F14               M         movwf   pSrc + 2
0013E8 512A           01446         movf    SetupPkt + bIntfID, W
0013EA 2712           01447         addwf   pSrc, F
                      01448 ;            inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
0013EC 8123           01449         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01450 ;            inPipes[0].wCount.v[0] = 1;                         // Set data count
0013EE 0E01           01451         movlw   1
0013F0 6F1B           01452         movwf   inCount
0013F2 6B1C           01453         clrf    inCount + 1
                      01454 ;            inPipes[0].info.bits.busy = 1;
0013F4 8F23           01455         bsf     info, busy
                      01456 ;            break;
0013F6 0012           01457         return
0013F8                01458 USBCheckStdRequest8
                      01459 ;        case SET_INTF:
0013F8 0E0B           01460         movlw   SET_INTF
0013FA 6327           01461         cpfseq  SetupPkt + bRequest
0013FC D007           01462         bra     USBCheckStdRequest9
                      01463 ;            inPipes[0].info.bits.busy = 1;
0013FE 8F23           01464         bsf     info, busy
                      01465 ;            USBAlternateInterface[SetupPkt.bIntfID] = SetupPkt.bAltID;
001400 EE24 F019      01466         lfsr    2, USBAlternateInterface
001404 512A           01467         movf    SetupPkt + bIntfID, W
001406 C428 FFDB      01468         movff   SetupPkt + bAltID, PLUSW2
                      01469 ;            break;
00140A 0012           01470         return
00140C                01471 USBCheckStdRequest9
                      01472 ;        case SET_DSC:
00140C 0E07           01473         movlw   SET_DSC
00140E 6327           01474         cpfseq  SetupPkt + bRequest
001410 0012           01475         return
                      01476 ;            USBCBStdSetDscHandler();
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001412 D2A9           01477         bra     USBCBStdSetDscHandler
                      01478 ;            break;
                      01479 ;        case SYNCH_FRAME:
                      01480 ;        default:
                      01481 ;            break;
                      01482 ;    }//end switch
                      01483 ;}//end USBCheckStdRequest
                      01484 
                      01485 ;/********************************************************************
                      01486 ; * Function:        void USBStdFeatureReqHandler(void)
                      01487 ; *
                      01488 ; * PreCondition:    None
                      01489 ; *
                      01490 ; * Input:           None
                      01491 ; *
                      01492 ; * Output:          None
                      01493 ; *
                      01494 ; * Side Effects:    None
                      01495 ; *
                      01496 ; * Overview:        This routine handles the standard SET & CLEAR
                      01497 ; *                  FEATURES requests
                      01498 ; *
                      01499 ; * Note:            None
                      01500 ; *******************************************************************/
                      01501 ;void USBStdFeatureReqHandler(void)
001414                01502 USBStdFeatureReqHandler
                      01503 ;{
001414 0104           01504         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01505 ;    BDT_ENTRY *p;
                      01506 ;    unsigned int* pUEP;             
                      01507 
                      01508 ;    if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&
001416 0E01           01509         movlw   DEVICE_REMOTE_WAKEUP    ; If Feature = DEVICE_REMOTE_WAKEUP &
001418 6328           01510         cpfseq  SetupPkt + bFeature
00141A D009           01511         bra     USBStdFeatureReqHandler1
                      01512 ;       (SetupPkt.Recipient == RCPT_DEV))
00141C 5126           01513         movf    SetupPkt, W             ; Recipient = RCPT_DEV?
00141E 0B1F           01514         andlw   0x1f                    ; Mask to lower 5 bits
001420 0800           01515         sublw   RCPT_DEV
001422 E105           01516         bnz     USBStdFeatureReqHandler1        ; No
                      01517 ;    {
                      01518 ;        inPipes[0].info.bits.busy = 1;
001424 8F23           01519         bsf     info, busy
                      01520 ;        if(SetupPkt.bRequest == SET_FEATURE)
                      01521 ;            RemoteWakeup = TRUE;
                      01522 ;        else
                      01523 ;            RemoteWakeup = FALSE;
001426 6925           01524         setf    RemoteWakeup            ; Preset RemoteWakeup to 1
001428 0E03           01525         movlw   SET_FEATURE             ; Request = SET_FEATURE?
00142A 6327           01526         cpfseq  SetupPkt + bRequest
00142C 6B25           01527         clrf    RemoteWakeup            ; No, RemoteWakeup = 0
                      01528 ;    }//end if
                      01529 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00142E                01530 USBStdFeatureReqHandler1
                      01531 ;    if((SetupPkt.bFeature == ENDPOINT_HALT)&&
00142E 0E00           01532         movlw   ENDPOINT_HALT           ; If Feature = ENDPOINT_HALT &
001430 6328           01533         cpfseq  SetupPkt + bFeature
001432                01534 USBStdFeatureReqHandlerExit
001432 0012           01535         return
                      01536 ;       (SetupPkt.Recipient == RCPT_EP)&&
001434 5126           01537         movf    SetupPkt, W             ; Recepient = RCPT_EP &
001436 0B1F           01538         andlw   0x1f                    ; Mask to lower 5 bits
001438 0802           01539         sublw   RCPT_EP
00143A E1FB           01540         bnz     USBStdFeatureReqHandlerExit
                      01541 ;       (SetupPkt.EPNum != 0))
00143C 512A           01542         movf    SetupPkt + bEPID, W     ; EPNum != 0
00143E 0B0F           01543         andlw   0x0f                    ; Mask to EPNum
001440 E0F8           01544         bz      USBStdFeatureReqHandlerExit
                      01545 ;    {
                      01546 ;        BYTE i;
                      01547 
                      01548 ;        inPipes[0].info.bits.busy = 1;
001442 8F23           01549         bsf     info, busy
                      01550 ;        /* Must do address calculation here */
                      01551 
                      01552 ;               //loop for each of the possible ping-pong buffers
                      01553 ;        for(i=0; i<2; i++)
                      01554 ;        {
                      01555 ;                       //point to the first EP0 OUT ping pong buffer
                      01556 ;            p = (BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      01557 
                      01558 ;                       //jump from this endpoint to the requested endpoint
                      01559 ;            p += EP(SetupPkt.EPNum,SetupPkt.EPDir,i);
001444 D811           01560         rcall   USBCalcEPAddress        ; Put endpoint buffer address in FSR2
                      01561 
                      01562 ;                       //if it was a SET_FEATURE request
                      01563 ;            if(SetupPkt.bRequest == SET_FEATURE)
001446 0E03           01564         movlw   SET_FEATURE             ; Request = SET_FEATURE?
001448 6327           01565         cpfseq  SetupPkt + bRequest
00144A D003           01566         bra     USBStdFeatureReqHandler2        ; No
                      01567 ;            {
                      01568 ;                               //Then STALL the endpoint
                      01569 ;                p->STAT.Val = _USIE|_BSTALL;
00144C 0E84           01570         movlw   _USIE|_BSTALL
00144E 6EDF           01571         movwf   INDF2                   ; Put in endpoint buffer
001450 0012           01572         return
                      01573 ;            }
                      01574 ;            else
001452                01575 USBStdFeatureReqHandler2
                      01576 ;            {
                      01577 ;                               //If it was not a SET_FEATURE
                      01578 ;                               //point to the appropriate UEP register
                      01579 ;                pUEP = (unsigned int*)(&U1EP0+SetupPkt.EPNum);
                      01580 ; Point FSR1 to endpoint table
001452 EE1F F070      01581         lfsr    1, UEP0                 ; FSR2 = beginning of endpoint table
001456 512A           01582         movf    SetupPkt + bEPID, W     ; Add in endpoint number
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001458 26E1           01583         addwf   FSR1L, F
                      01584 
                      01585 ;                               //Clear the STALL bit in the UEP register
                      01586 ;                *pUEP &= ~UEP_STALL;
00145A 0EFE           01587         movlw   ~UEP_STALL
00145C 16E7           01588         andwf   INDF1, F
                      01589 
                      01590 ;                if(SetupPkt.EPDir == 1) // IN
                      01591 ;                {
                      01592 ;                                       //If the endpoint is an IN endpoint then we
                      01593 ;                                       //  need to return it to the CPU and reset the
                      01594 ;                                       //  DTS bit so that the next transfer is correct
                      01595 ;                    p->STAT.Val = _UCPU|_DAT1;
                      01596 ;                }
                      01597 ;                else
                      01598 ;                {
                      01599 ;                                       //If the endpoint was an OUT endpoint then we
                      01600 ;                                       //  need to give control of the endpoint back to
                      01601 ;                                       //  the SIE so that the function driver can
                      01602 ;                                       //  receive the data as they expected.  Also need
                      01603 ;                                       //  to set the DTS bit so the next packet will be
                      01604 ;                                       //  correct
                      01605 ;                    p->STAT.Val = _USIE|_DAT1|_DTSEN;
                      01606 ;                }
00145E 0E40           01607         movlw   _UCPU|_DAT1             ; IN
001460 AF2A           01608         btfss   SetupPkt + bEPID, EPDir ; EPDir = 1 (IN)?
001462 0EC8           01609         movlw   _USIE|_DAT1|_DTSEN      ; No - OUT
001464 6EDF           01610         movwf   INDF2                   ; Put in endpoint buffer
001466 0012           01611         return
                      01612 ;            }//end if
                      01613 ;        }
                      01614 
                      01615 ;    }//end if
                      01616 ;}//end USBStdFeatureReqHandler
                      01617 
                      01618 ; Put endpoint buffer address in FSR2 (ep0Bo+(EPNum*8)+(EPDir*4))
001468                01619 USBCalcEPAddress
001468 EE24 F000      01620         lfsr    2, ep0Bo                ; Point FSR2 to beginning of buffer area
00146C 452A           01621         rlncf   SetupPkt + bEPID, W     ; Move endpoint direction to C
00146E 352A           01622         rlcf    SetupPkt + bEPID, W     ; Endpoint number * 8 (roll in ep direction)
001470 46E8           01623         rlncf   WREG, F
001472 46E8           01624         rlncf   WREG, F
001474 26D9           01625         addwf   FSR2L, F                ; Add to FSR2 (can't overflow to FSR2H)
001476 0012           01626         return
                      01627 
                      01628 ;/********************************************************************
                      01629 ; * Function:        void USBStdGetDscHandler(void)
                      01630 ; *
                      01631 ; * PreCondition:    None
                      01632 ; *
                      01633 ; * Input:           None
                      01634 ; *
                      01635 ; * Output:          None
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01636 ; *
                      01637 ; * Side Effects:    None
                      01638 ; *
                      01639 ; * Overview:        This routine handles the standard GET_DESCRIPTOR
                      01640 ; *                  request.
                      01641 ; *
                      01642 ; * Note:            None
                      01643 ; *******************************************************************/
                      01644 ;void USBStdGetDscHandler(void)
001478                01645 USBStdGetDscHandler
                      01646 ;{
001478 0104           01647         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01648 ;    if(SetupPkt.bmRequestType == 0x80)
00147A 0E80           01649         movlw   0x80
00147C 6326           01650         cpfseq  SetupPkt + bmRequestType
00147E 0012           01651         return
                      01652 ;    {
                      01653 ;        inPipes[0].info.Val = USB_INPIPES_ROM | USB_INPIPES_BUSY | USB_INPIPES_INCLUDE_ZERO;
001480 0EC0           01654         movlw   USB_INPIPES_ROM | USB_INPIPES_BUSY | USB_INPIPES_INCLUDE_ZERO
001482 6F23           01655         movwf   info
                      01656 
                      01657 ;        switch(SetupPkt.bDescriptorType)
                      01658 ;        {
                      01659 ;            case USB_DESCRIPTOR_DEVICE:
001484 0E01           01660         movlw   USB_DESCRIPTOR_DEVICE
001486 6329           01661         cpfseq  SetupPkt + bDescriptorType
001488 D011           01662         bra     USBStdGetDscHandler1
                      01663 ;                #if !defined(USB_USER_DEVICE_DESCRIPTOR)
                      01664 ;                    inPipes[0].pSrc.bRom = (ROM BYTE*)&device_dsc;
                      01665 ;                #else
                      01666 ;                    inPipes[0].pSrc.bRom = (ROM BYTE*)USB_USER_DEVICE_DESCRIPTOR;
                      01667 ;                #endif
                      01668         mSetSourcePointer DeviceDescriptor
00148A 0EA2               M         movlw   low (DeviceDescriptor)
00148C 6F12               M         movwf   pSrc
00148E 0E19               M         movlw   high (DeviceDescriptor)
001490 6F13               M         movwf   pSrc + 1
001492 0E00               M         movlw   upper (DeviceDescriptor)
001494 6F14               M         movwf   pSrc + 2
                      01669 ;                inPipes[0].wCount.Val = sizeof(device_dsc);
                      01670         mGetRomTableCount               ; Set wCount
001496 C412 FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
00149A C413 FFF7          M         movff   pSrc + 1, TBLPTRH
00149E C414 FFF8          M         movff   pSrc + 2, TBLPTRU
0014A2 0008               M         tblrd   *                       ; Read count
0014A4 CFF5 F41B          M         movff   TABLAT, inCount
0014A8 6B1C               M         clrf    inCount + 1
0014AA 0012           01671         return
                      01672 ;                break;
0014AC                01673 USBStdGetDscHandler1
                      01674 ;            case USB_DESCRIPTOR_CONFIGURATION:
0014AC 0E02           01675         movlw   USB_DESCRIPTOR_CONFIGURATION
0014AE 6329           01676         cpfseq  SetupPkt + bDescriptorType
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0014B0 D025           01677         bra     USBStdGetDscHandler2
                      01678 ;                #if !defined(USB_USER_CONFIG_DESCRIPTOR)
                      01679 ;                    inPipes[0].pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);
                      01680 ;                #else
                      01681 ;                    inPipes[0].pSrc.bRom = *(USB_USER_CONFIG_DESCRIPTOR+SetupPkt.bDscIndex);
                      01682 ;                #endif
                      01683 ;       mSetSourcePointer Config1
0014B2 6AF8           01684         clrf    TBLPTRU
0014B4 6AF7           01685         clrf    TBLPTRH
0014B6 4528           01686         rlncf   SetupPkt + bDscIndex, W ; Index * 4
0014B8 46E8           01687         rlncf   WREG, F
0014BA 0FC6           01688         addlw   low (USB_CD_Ptr)        ; Add element offset to low address
0014BC 6EF6           01689         movwf   TBLPTRL
0014BE 0E19           01690         movlw   high (USB_CD_Ptr)
0014C0 22F7           01691         addwfc  TBLPTRH, F
0014C2 0E00           01692         movlw   upper (USB_CD_Ptr)
0014C4 22F8           01693         addwfc  TBLPTRU, F
0014C6 0009           01694         tblrd   *+                      ; Get the data to TABLAT and move pointer forward
0014C8 CFF5 F412      01695         movff   TABLAT, pSrc            ; Get low source address
0014CC 0009           01696         tblrd   *+
0014CE CFF5 F413      01697         movff   TABLAT, pSrc + 1        ; Get high source address
0014D2 0008           01698         tblrd   *
0014D4 CFF5 F414      01699         movff   TABLAT, pSrc + 2        ; Get upper source address
                      01700 ;                inPipes[0].wCount.Val = *(inPipes[0].pSrc.wRom+1);                // Set data count
0014D8 C412 FFF6      01701         movff   pSrc, TBLPTRL           ; Set wCount to total length
0014DC C413 FFF7      01702         movff   pSrc + 1, TBLPTRH
0014E0 C414 FFF8      01703         movff   pSrc + 2, TBLPTRU
0014E4 0009           01704         tblrd   *+                      ; Skip 4 locations
0014E6 0009           01705         tblrd   *+
0014E8 0009           01706         tblrd   *+
0014EA 0009           01707         tblrd   *+
0014EC 0009           01708         tblrd   *+                      ; Read count low
0014EE CFF5 F41B      01709         movff   TABLAT, inCount
0014F2 0009           01710         tblrd   *+                      ; Ignore RETLW opcode
0014F4 0009           01711         tblrd   *+                      ; Read count high
0014F6 CFF5 F41C      01712         movff   TABLAT, inCount + 1
0014FA 0012           01713         return
                      01714 ;               break;
0014FC                01715 USBStdGetDscHandler2
                      01716 ;            case USB_DESCRIPTOR_STRING:
0014FC 0E03           01717         movlw   USB_DESCRIPTOR_STRING
0014FE 6329           01718         cpfseq  SetupPkt + bDescriptorType
001500 D01E           01719         bra     USBStdGetDscHandler3
                      01720 ;                inPipes[0].pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);
001502 6AF8           01721         clrf    TBLPTRU
001504 6AF7           01722         clrf    TBLPTRH
001506 4528           01723         rlncf   SetupPkt + bDscIndex, W ; Index * 4
001508 46E8           01724         rlncf   WREG, F
00150A 0F6C           01725         addlw   low (USB_SD_Ptr)        ; Add element offset to low address
00150C 6EF6           01726         movwf   TBLPTRL
00150E 0E1A           01727         movlw   high (USB_SD_Ptr)
001510 22F7           01728         addwfc  TBLPTRH, F
001512 0E00           01729         movlw   upper (USB_SD_Ptr)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001514 22F8           01730         addwfc  TBLPTRU, F
001516 0009           01731         tblrd   *+                      ; Get the data to TABLAT and move pointer forward
001518 CFF5 F412      01732         movff   TABLAT, pSrc            ; Get low source address
00151C 0009           01733         tblrd   *+
00151E CFF5 F413      01734         movff   TABLAT, pSrc + 1        ; Get high source address
001522 0008           01735         tblrd   *
001524 CFF5 F414      01736         movff   TABLAT, pSrc + 2        ; Get upper source address
                      01737 ;                inPipes[0].wCount.Val = *inPipes[0].pSrc.bRom;                    // Set data count
                      01738         mGetRomTableCount               ; Set wCount
001528 C412 FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
00152C C413 FFF7          M         movff   pSrc + 1, TBLPTRH
001530 C414 FFF8          M         movff   pSrc + 2, TBLPTRU
001534 0008               M         tblrd   *                       ; Read count
001536 CFF5 F41B          M         movff   TABLAT, inCount
00153A 6B1C               M         clrf    inCount + 1
00153C 0012           01739         return
                      01740 ;                break;
00153E                01741 USBStdGetDscHandler3
                      01742 ;            default:
                      01743 ;                inPipes[0].info.Val = 0;
00153E 6B23           01744         clrf    info
001540 0012           01745         return
                      01746 ;                break;
                      01747 ;        }//end switch
                      01748 ;    }//end if
                      01749 ;}//end USBStdGetDscHandler
                      01750 
                      01751 ;/********************************************************************
                      01752 ; * Function:        void USBStdGetStatusHandler(void)
                      01753 ; *
                      01754 ; * PreCondition:    None
                      01755 ; *
                      01756 ; * Input:           None
                      01757 ; *
                      01758 ; * Output:          None
                      01759 ; *
                      01760 ; * Side Effects:    None
                      01761 ; *
                      01762 ; * Overview:        This routine handles the standard GET_STATUS request
                      01763 ; *
                      01764 ; * Note:            None
                      01765 ; *******************************************************************/
                      01766 ;void USBStdGetStatusHandler(void)
001542                01767 USBStdGetStatusHandler
                      01768 ;{
001542 0104           01769         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01770 ;    CtrlTrfData[0] = 0;                 // Initialize content
001544 6B66           01771         clrf    CtrlTrfData             ; Initialize content
                      01772 ;    CtrlTrfData[1] = 0;
001546 6B67           01773         clrf    CtrlTrfData + 1
                      01774 
                      01775 ;    switch(SetupPkt.Recipient)
                      01776 ;    {
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01777 ;        case RCPT_DEV:
001548 5126           01778         movf    SetupPkt, W             ; Recipient = RCPT_DEV?
00154A 0B1F           01779         andlw   0x1f                    ; Mask to lower 5 bits
00154C 0800           01780         sublw   RCPT_DEV
00154E E104           01781         bnz     USBStdGetStatusHandler1 ; No
                      01782 ;            inPipes[0].info.bits.busy = 1;
001550 8F23           01783         bsf     info, busy
                      01784 ;            /*
                      01785 ;             * [0]: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered
                      01786 ;             *      bit1: RemoteWakeup        [0] Disabled    [1] Enabled
                      01787 ;             */
                      01788 ;            if(self_power == 1) // self_power is defined in HardwareProfile.h
                      01789 #ifdef USB_SELF_POWER
                      01790             {
                      01791 ;                CtrlTrfData[0]|=0x01;
                      01792         bsf     CtrlTrfData, 0
                      01793             }
                      01794 #endif
                      01795 
                      01796 ;            if(RemoteWakeup == TRUE)
                      01797 ;            {
                      01798 ;                CtrlTrfData[0]|=0x02;
                      01799 ;            }
001552 6725           01800         tstfsz  RemoteWakeup
001554 8366           01801         bsf     CtrlTrfData, 1
001556 D010           01802         bra     USBStdGetStatusHandlerExit
                      01803 ;            break;
001558                01804 USBStdGetStatusHandler1
                      01805 ;        case RCPT_INTF:
001558 5126           01806         movf    SetupPkt, W             ; Recipient = RCPT_INTF?
00155A 0B1F           01807         andlw   0x1f                    ; Mask to lower 5 bits
00155C 0801           01808         sublw   RCPT_INTF
00155E E102           01809         bnz     USBStdGetStatusHandler2 ; No
                      01810 ;            inPipes[0].info.bits.busy = 1;     // No data to update
001560 8F23           01811         bsf     info, busy
001562 D00A           01812         bra     USBStdGetStatusHandlerExit
                      01813 ;            break;
001564                01814 USBStdGetStatusHandler2
                      01815 ;        case RCPT_EP:
001564 5126           01816         movf    SetupPkt, W             ; Recipient = RCPT_EP?
001566 0B1F           01817         andlw   0x1f                    ; Mask to lower 5 bits
001568 0802           01818         sublw   RCPT_EP
00156A E106           01819         bnz     USBStdGetStatusHandlerExit      ; No
                      01820 ;            inPipes[0].info.bits.busy = 1;
00156C 8F23           01821         bsf     info, busy
                      01822 ;            /*
                      01823 ;             * [0]: bit0: Halt Status [0] Not Halted [1] Halted
                      01824 ;             */
                      01825 ;            {
                      01826 ;                BDT_ENTRY *p;
                      01827 ;                p = (BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      01828 ;                p += EP(SetupPkt.EPNum,SetupPkt.EPDir,0);
00156E DF7C           01829         rcall   USBCalcEPAddress        ; Put endpoint buffer address in FSR2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01830     
                      01831 ;                if(p->STAT.Val & _BSTALL)    // Use _BSTALL as a bit mask
001570 50DF           01832         movf    INDF2, W
001572 0B04           01833         andlw   _BSTALL
001574 E001           01834         bz      USBStdGetStatusHandlerExit
                      01835 ;                    CtrlTrfData[0]=0x01;    // Set bit0
                      01836 ;       movlw   0x01
                      01837 ;       movwf   CtrlTrfData
001576 8166           01838         bsf     CtrlTrfData, 0
                      01839 ;                break;
                      01840 ;            }
                      01841 ;    }//end switch
                      01842 
001578                01843 USBStdGetStatusHandlerExit
                      01844 ;    if(inPipes[0].info.bits.busy == 1)
001578 AF23           01845         btfss   info, busy
00157A 0012           01846         return
                      01847 ;    {
                      01848 ;        inPipes[0].pSrc.bRam = (BYTE*)&CtrlTrfData;            // Set Source
                      01849         mSetSourcePointer CtrlTrfData
00157C 0E66               M         movlw   low (CtrlTrfData)
00157E 6F12               M         movwf   pSrc
001580 0E04               M         movlw   high (CtrlTrfData)
001582 6F13               M         movwf   pSrc + 1
001584 0E00               M         movlw   upper (CtrlTrfData)
001586 6F14               M         movwf   pSrc + 2
                      01850 ;        inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
001588 8123           01851         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01852 ;        inPipes[0].wCount.v[0] = 2;                         // Set data count
00158A 0E02           01853         movlw   2                       ; Set count
00158C 6F1B           01854         movwf   inCount
00158E 6B1C           01855         clrf    inCount + 1
001590 0012           01856         return
                      01857 ;    }//end if(...)
                      01858 ;}//end USBStdGetStatusHandler
                      01859 
                      01860 ;/******************************************************************************
                      01861 ; * Function:        void USBCtrlEPServiceComplete(void)
                      01862 ; *
                      01863 ; * PreCondition:    None
                      01864 ; *
                      01865 ; * Input:           None
                      01866 ; *
                      01867 ; * Output:          None
                      01868 ; *
                      01869 ; * Side Effects:    None
                      01870 ; *
                      01871 ; * Overview:        This routine wrap up the ramaining tasks in servicing
                      01872 ; *                  a Setup Request. Its main task is to set the endpoint
                      01873 ; *                  controls appropriately for a given situation. See code
                      01874 ; *                  below.
                      01875 ; *                  There are three main scenarios:
                      01876 ; *                  a) There was no handler for the Request, in this case
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01877 ; *                     a STALL should be sent out.
                      01878 ; *                  b) The host has requested a read control transfer,
                      01879 ; *                     endpoints are required to be setup in a specific way.
                      01880 ; *                  c) The host has requested a write control transfer, or
                      01881 ; *                     a control data stage is not required, endpoints are
                      01882 ; *                     required to be setup in a specific way.
                      01883 ; *
                      01884 ; *                  Packet processing is resumed by clearing PKTDIS bit.
                      01885 ; *
                      01886 ; * Note:            None
                      01887 ; *****************************************************************************/
                      01888 ;void USBCtrlEPServiceComplete(void)
001592                01889 USBCtrlEPServiceComplete
                      01890 ;{
001592 0104           01891         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01892 ;    /*
                      01893 ;     * PKTDIS bit is set when a Setup Transaction is received.
                      01894 ;     * Clear to resume packet processing.
                      01895 ;     */
                      01896 ;    USBPacketDisable = 0;
001594 986D           01897         bcf     UCON, PKTDIS
                      01898 
                      01899 ;    if(inPipes[0].info.bits.busy == 0)
001596 BF23           01900         btfsc   info, busy
001598 D01B           01901         bra     USBCtrlEPServiceComplete1
                      01902 ;    {
                      01903 ;        if(outPipes[0].info.bits.busy == 1)
00159A AF24           01904         btfss   outfo, busy
00159C D00E           01905         bra     USBCtrlEPServiceComplete0
                      01906 ;        {
                      01907 ;            controlTransferState = CTRL_TRF_RX;
00159E 0E02           01908         movlw   CTRL_TRF_RX
0015A0 6F1A           01909         movwf   controlTransferState
                      01910 ;            /*
                      01911 ;             * Control Write:
                      01912 ;             * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>
                      01913 ;             *
                      01914 ;             * 1. Prepare IN EP to respond to early termination
                      01915 ;             *
                      01916 ;             *    This is the same as a Zero Length Packet Response
                      01917 ;             *    for control transfer without a data stage
                      01918 ;             */
                      01919 ;            pBDTEntryIn[0]->CNT = 0;
0015A2 6B05           01920         clrf    ep0Bi + Cnt
                      01921 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
0015A4 0EC8           01922         movlw   _USIE|_DAT1|_DTSEN
0015A6 6F04           01923         movwf   ep0Bi + Stat
                      01924 ;
                      01925 ;            /*
                      01926 ;             * 2. Prepare OUT EP to receive data.
                      01927 ;             */
                      01928 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0015A8 0E40           01929         movlw   USB_EP0_BUFF_SIZE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015AA 6F01           01930         movwf   ep0Bo + Cnt
                      01931 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
0015AC 0E66           01932         movlw   low CtrlTrfData
0015AE 6F02           01933         movwf   ep0Bo + ADRL
0015B0 0E04           01934         movlw   high CtrlTrfData
0015B2 6F03           01935         movwf   ep0Bo + ADRH
                      01936 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
0015B4 0EC8           01937         movlw   _USIE|_DAT1|_DTSEN
0015B6 6F00           01938         movwf   ep0Bo + Stat
0015B8 0012           01939         return
                      01940 ;        }
                      01941 ;        else
0015BA                01942 USBCtrlEPServiceComplete0
                      01943 ;        {
                      01944 ;            /*
                      01945 ;             * If no one knows how to service this request then stall.
                      01946 ;             * Must also prepare EP0 to receive the next SETUP transaction.
                      01947 ;            */
                      01948 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0015BA 0E40           01949         movlw   USB_EP0_BUFF_SIZE
0015BC 6F01           01950         movwf   ep0Bo + Cnt
                      01951 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
0015BE 0E26           01952         movlw   low SetupPkt
0015C0 6F02           01953         movwf   ep0Bo + ADRL
0015C2 0E04           01954         movlw   high SetupPkt
0015C4 6F03           01955         movwf   ep0Bo + ADRH
                      01956 
                      01957 ;            /* v2b fix */
                      01958 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
0015C6 0E8C           01959         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
0015C8 6F00           01960         movwf   ep0Bo + Stat
                      01961 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL; 
0015CA 0E84           01962         movlw   _USIE|_BSTALL
0015CC 6F04           01963         movwf   ep0Bi + Stat
0015CE 0012           01964         return
                      01965 ;        }
                      01966 ;    }
                      01967 ;    else    // A module has claimed ownership of the control transfer session.
0015D0                01968 USBCtrlEPServiceComplete1
                      01969 ;    {
                      01970 ;        if(outPipes[0].info.bits.busy == 0)
0015D0 BF24           01971         btfsc   outfo, busy
0015D2 D7F3           01972         bra     USBCtrlEPServiceComplete0
                      01973 ;        {
                      01974 ;        if(SetupPkt.DataDir == DEV_TO_HOST)
0015D4 AF26           01975         btfss   SetupPkt, DataDir
0015D6 D01E           01976         bra     USBCtrlEPServiceComplete2
                      01977 ;        {
                      01978 ;            if(SetupPkt.wLength < inPipes[0].wCount.Val)
                      01979 ;            {
                      01980 ;                inPipes[0].wCount.Val = SetupPkt.wLength;
                      01981 ;            }
0015D8 511C           01982         movf    inCount + 1, W          ; Make sure count does not exceed max length requested by Host
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015DA 5D2D           01983         subwf   SetupPkt + wLength + 1, W
0015DC E304           01984         bnc     USBCtrlEPServiceCompleteCopy
0015DE E107           01985         bnz     USBCtrlEPServiceComplete11
0015E0 511B           01986         movf    inCount, W
0015E2 5D2C           01987         subwf   SetupPkt + wLength, W
0015E4 E204           01988         bc      USBCtrlEPServiceComplete11
0015E6                01989 USBCtrlEPServiceCompleteCopy
0015E6 C42C F41B      01990         movff   SetupPkt + wLength, inCount     ; Set count to maximum
0015EA C42D F41C      01991         movff   SetupPkt + wLength + 1, inCount + 1
0015EE                01992 USBCtrlEPServiceComplete11
                      01993 ;            USBCtrlTrfTxService();
0015EE D820           01994         rcall   USBCtrlTrfTxService    ; Actually copy the data to EP0 IN buffer
                      01995 ;            controlTransferState = CTRL_TRF_TX;
0015F0 0104           01996         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0015F2 0E01           01997         movlw   CTRL_TRF_TX
0015F4 6F1A           01998         movwf   controlTransferState
                      01999 ;            /*
                      02000 ;             * Control Read:
                      02001 ;             * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>
                      02002 ;             * 1. Prepare OUT EP to respond to early termination
                      02003 ;             *
                      02004 ;             * NOTE:
                      02005 ;             * If something went wrong during the control transfer,
                      02006 ;             * the last status stage may not be sent by the host.
                      02007 ;             * When this happens, two different things could happen
                      02008 ;             * depending on the host.
                      02009 ;             * a) The host could send out a RESET.
                      02010 ;             * b) The host could send out a new SETUP transaction
                      02011 ;             *    without sending a RESET first.
                      02012 ;             * To properly handle case (b), the OUT EP must be setup
                      02013 ;             * to receive either a zero length OUT transaction, or a
                      02014 ;             * new SETUP transaction.
                      02015 ;             *
                      02016 ;             * Furthermore, the Cnt byte should be set to prepare for
                      02017 ;             * the SETUP data (8-byte or more), and the buffer address
                      02018 ;             * should be pointed to SetupPkt.
                      02019 ;             */
                      02020 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0015F6 0E40           02021         movlw   USB_EP0_BUFF_SIZE
0015F8 6F01           02022         movwf   ep0Bo + Cnt
                      02023 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
0015FA 0E26           02024         movlw   low SetupPkt
0015FC 6F02           02025         movwf   ep0Bo + ADRL
0015FE 0E04           02026         movlw   high SetupPkt
001600 6F03           02027         movwf   ep0Bo + ADRH
                      02028 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE;           // Note: DTSEN is 0!
001602 0E80           02029         movlw   _USIE                   ; Note: DTSEN is 0!
001604 6F00           02030         movwf   ep0Bo + Stat
                      02031 
                      02032 ;            pBDTEntryEP0OutCurrent->CNT = USB_EP0_BUFF_SIZE;
                      02033 ;            pBDTEntryEP0OutCurrent->ADR = (BYTE*)&SetupPkt;
                      02034 ;            pBDTEntryEP0OutCurrent->STAT.Val = _USIE;           // Note: DTSEN is 0!
                      02035 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02036 ;            /*
                      02037 ;             * 2. Prepare IN EP to transfer data, Cnt should have
                      02038 ;             *    been initialized by responsible request owner.
                      02039 ;             */
                      02040 ;            pBDTEntryIn[0]->ADR = (BYTE*)&CtrlTrfData;
001606 0E66           02041         movlw   low CtrlTrfData
001608 6F06           02042         movwf   ep0Bi + ADRL
00160A 0E04           02043         movlw   high CtrlTrfData
00160C 6F07           02044         movwf   ep0Bi + ADRH
                      02045 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
00160E 0EC8           02046         movlw   _USIE|_DAT1|_DTSEN
001610 6F04           02047         movwf   ep0Bi + Stat
001612 0012           02048         return
                      02049 ;        }
                      02050 ;        else    // (SetupPkt.DataDir == HOST_TO_DEVICE)
001614                02051 USBCtrlEPServiceComplete2
                      02052 ;        {
                      02053 ;            controlTransferState = CTRL_TRF_RX;
001614 0E02           02054         movlw   CTRL_TRF_RX
001616 6F1A           02055         movwf   controlTransferState
                      02056 ;            /*
                      02057 ;             * Control Write:
                      02058 ;             * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>
                      02059 ;             *
                      02060 ;             * 1. Prepare IN EP to respond to early termination
                      02061 ;             *
                      02062 ;             *    This is the same as a Zero Length Packet Response
                      02063 ;             *    for control transfer without a data stage
                      02064 ;             */
                      02065 ;            pBDTEntryIn[0]->CNT = 0;
001618 6B05           02066         clrf    ep0Bi + Cnt
                      02067 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
00161A 0EC8           02068         movlw   _USIE|_DAT1|_DTSEN
00161C 6F04           02069         movwf   ep0Bi + Stat
                      02070 
                      02071 ;            /*
                      02072 ;             * 2. Prepare OUT EP to receive data.
                      02073 ;             */
                      02074 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
00161E 0E40           02075         movlw   USB_EP0_BUFF_SIZE
001620 6F01           02076         movwf   ep0Bo + Cnt
                      02077 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
001622 0E66           02078         movlw   low CtrlTrfData
001624 6F02           02079         movwf   ep0Bo + ADRL
001626 0E04           02080         movlw   high CtrlTrfData
001628 6F03           02081         movwf   ep0Bo + ADRH
                      02082 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
00162A 0EC8           02083         movlw   _USIE|_DAT1|_DTSEN
00162C 6F00           02084         movwf   ep0Bo + Stat
                      02085 ;                       }
                      02086 ;        }
                      02087 ;    }//end if(ctrl_trf_session_owner == MUID_NULL)
                      02088 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00162E 0012           02089         return
                      02090 ;}//end USBCtrlEPServiceComplete
                      02091 
                      02092 
                      02093 ;/******************************************************************************
                      02094 ; * Function:        void USBCtrlTrfTxService(void)
                      02095 ; *
                      02096 ; * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.
                      02097 ; *
                      02098 ; * Input:           None
                      02099 ; *
                      02100 ; * Output:          None
                      02101 ; *
                      02102 ; * Side Effects:    None
                      02103 ; *
                      02104 ; * Overview:        This routine should be called from only two places.
                      02105 ; *                  One from USBCtrlEPServiceComplete() and one from
                      02106 ; *                  USBCtrlTrfInHandler(). It takes care of managing a
                      02107 ; *                  transfer over multiple USB transactions.
                      02108 ; *
                      02109 ; * Note:            This routine works with isochronous endpoint larger than
                      02110 ; *                  256 bytes and is shown here as an example of how to deal
                      02111 ; *                  with BC9 and BC8. In reality, a control endpoint can never
                      02112 ; *                  be larger than 64 bytes.
                      02113 ; *****************************************************************************/
                      02114 ;void USBCtrlTrfTxService(void)
001630                02115 USBCtrlTrfTxService
                      02116 ;{
001630 0104           02117         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02118 ;    WORD_VAL byteToSend;
                      02119 
                      02120 ;    /*
                      02121 ;     * First, have to figure out how many byte of data to send.
                      02122 ;     */
                      02123 ;    if(inPipes[0].wCount.Val < USB_EP0_BUFF_SIZE)
                      02124 ;    {
                      02125 ;        byteToSend.Val = inPipes[0].wCount.Val;
                      02126 
                      02127 ;        /* v2b fix */
                      02128 ;        if(shortPacketStatus == SHORT_PKT_NOT_USED)
                      02129 ;        {
                      02130 ;            shortPacketStatus = SHORT_PKT_PENDING;
                      02131 ;        }
                      02132 ;        else if(shortPacketStatus == SHORT_PKT_PENDING)
                      02133 ;        {
                      02134 ;            shortPacketStatus = SHORT_PKT_SENT;
                      02135 ;        }//end if
                      02136 ;        /* end v2b fix for this section */
                      02137 ;    }
                      02138 ;    else
                      02139 ;    {
                      02140 ;        byteToSend.Val = USB_EP0_BUFF_SIZE;
                      02141 ;    }
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001632 511B           02142         movf    inCount, W              ; Preset wCount bytes to send
001634 6F10           02143         movwf   usb_temp
001636 511C           02144         movf    inCount + 1, W
001638 6F11           02145         movwf   usb_temp + 1
00163A 0800           02146         sublw   high USB_EP0_BUFF_SIZE  ; Check for count less than maximium length
00163C E103           02147         bnz     USBCtrlTrfTxServiceNotEQ        ; Not equal so we don't need to check the bottom byte
00163E 511B           02148         movf    inCount, W
001640 0840           02149         sublw   low USB_EP0_BUFF_SIZE
001642 E011           02150         bz      USBCtrlTrfTxServiceNotLess      ; Equal to
001644                02151 USBCtrlTrfTxServiceNotEQ
001644 E30C           02152         bnc     USBCtrlTrfTxServiceGreater      ; Greater than
001646 0E00           02153         movlw   SHORT_PKT_NOT_USED
001648 631F           02154         cpfseq  shortPacketStatus
00164A D003           02155         bra     USBCtrlTrfTxServiceNotEQ1
00164C 0E01           02156         movlw   SHORT_PKT_PENDING
00164E 6F1F           02157         movwf   shortPacketStatus
001650 D00A           02158         bra     USBCtrlTrfTxServiceNotLess
001652                02159 USBCtrlTrfTxServiceNotEQ1
001652 0E01           02160         movlw   SHORT_PKT_PENDING
001654 631F           02161         cpfseq  shortPacketStatus
001656 D007           02162         bra     USBCtrlTrfTxServiceNotLess
001658 0E02           02163         movlw   SHORT_PKT_SENT
00165A 6F1F           02164         movwf   shortPacketStatus
00165C D004           02165         bra     USBCtrlTrfTxServiceNotLess
00165E                02166 USBCtrlTrfTxServiceGreater
00165E 0E40           02167         movlw   low USB_EP0_BUFF_SIZE   ; Send buffer full of bytes
001660 6F10           02168         movwf   usb_temp
001662 0E00           02169         movlw   high USB_EP0_BUFF_SIZE
001664 6F11           02170         movwf   usb_temp + 1
001666                02171 USBCtrlTrfTxServiceNotLess
                      02172 
                      02173 ;    /*
                      02174 ;     * Next, load the number of bytes to send to BC9..0 in buffer descriptor
                      02175 ;     */
                      02176 ;    #if defined(__18CXX)
                      02177 ;        pBDTEntryIn[0]->STAT.BC9 = 0;
                      02178 ;        pBDTEntryIn[0]->STAT.BC8 = 0;
001666 5104           02179         movf    ep0Bi + Stat, W         ; Get full Stat byte
001668 0BFC           02180         andlw   0xfc                    ; Clear bottom bits
                      02181 ;    #endif
                      02182 ;    pBDTEntryIn[0]->STAT.Val |= byteToSend.byte.HB;
00166A 1111           02183         iorwf   usb_temp + 1, W         ; Put in high bits of bytes to send
00166C 6F04           02184         movwf   ep0Bi + Stat            ; Save it out
                      02185 ;    pBDTEntryIn[0]->CNT = byteToSend.byte.LB;
00166E 5110           02186         movf    usb_temp, W             ; Get actual bytes to be sent from the buffer for subtract
001670 6F05           02187         movwf   ep0Bi + Cnt             ; Save low number of bytes to send while we're here
                      02188 
                      02189 ;    /*
                      02190 ;     * Subtract the number of bytes just about to be sent from the total.
                      02191 ;     */
                      02192 ;    inPipes[0].wCount.Val = inPipes[0].wCount.Val - byteToSend.Val;
                      02193 ;       movf    usb_temp, W             ; Subtract actual bytes to be sent from the buffer
001672 5F1B           02194         subwf   inCount, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001674 5111           02195         movf    usb_temp + 1, W
001676 5B1C           02196         subwfb  inCount + 1, F
                      02197 
                      02198 ;    pDst = (BYTE*)CtrlTrfData;        // Set destination pointer
001678 EE24 F066      02199         lfsr    2, CtrlTrfData          ; Set destination pointer
                      02200 
00167C 5111           02201         movf    usb_temp + 1, W         ; Check high byte for 0
00167E 1110           02202         iorwf   usb_temp, W             ; Check low byte for 0
001680 E025           02203         bz      USBCtrlTrfTxServiceExit ; If both 0 then nothing to send this time
                      02204 ;    if(inPipes[0].info.bits.ctrl_trf_mem == USB_INPIPES_ROM)       // Determine type of memory source
001682 B123           02205         btfsc   info, ctrl_trf_mem      ; ROM or RAM?
001684 D015           02206         bra     USBCtrlTrfTxServiceRam  ; RAM
                      02207 ;    {
                      02208 ;        while(byteToSend.Val)
                      02209 ;        {
                      02210 ;            *pDst++ = *inPipes[0].pSrc.bRom++;
                      02211 ;            byteToSend.Val--;
                      02212 ;        }//end while(byte_to_send.Val)
001686 C412 FFF6      02213         movff   pSrc, TBLPTRL           ; Move source pointer to TBLPTR
00168A C413 FFF7      02214         movff   pSrc + 1, TBLPTRH
00168E C414 FFF8      02215         movff   pSrc + 2, TBLPTRU
001692                02216 USBCtrlTrfTxServiceRomLoop
001692 0009           02217         tblrd   *+
001694 CFF5 FFDE      02218         movff   TABLAT, POSTINC2        ; Copy one buffer to the other
001698 0009           02219         tblrd   *+                      ; Skip retlw in high location
00169A 0710           02220         decf    usb_temp, F             ; Count down number of bytes
00169C E1FA           02221         bnz     USBCtrlTrfTxServiceRomLoop
00169E 0711           02222         decf    usb_temp + 1, F
0016A0 E2F8           02223         bc      USBCtrlTrfTxServiceRomLoop
0016A2 CFF6 F412      02224         movff   TBLPTRL, pSrc           ; Update source pointer
0016A6 CFF7 F413      02225         movff   TBLPTRH, pSrc + 1
0016AA CFF8 F414      02226         movff   TBLPTRU, pSrc + 2
0016AE 0012           02227         return
                      02228 ;    }
                      02229 ;    else  // RAM
0016B0                02230 USBCtrlTrfTxServiceRam
                      02231 ;    {
                      02232 ;        while(byteToSend.Val)
                      02233 ;        {
                      02234 ;            *pDst++ = *inPipes[0].pSrc.bRam++;
                      02235 ;            byteToSend.Val--;
                      02236 ;        }//end while(byte_to_send.Val)
0016B0 C412 FFE1      02237         movff   pSrc, FSR1L             ; Move source pointer to FSR1
0016B4 C413 FFE2      02238         movff   pSrc + 1, FSR1H
0016B8                02239 USBCtrlTrfTxServiceRamLoop
0016B8 CFE6 FFDE      02240         movff   POSTINC1, POSTINC2      ; Copy one buffer to the other
0016BC 0710           02241         decf    usb_temp, F             ; Count down number of bytes
0016BE E1FC           02242         bnz     USBCtrlTrfTxServiceRamLoop
0016C0 0711           02243         decf    usb_temp + 1, F
0016C2 E2FA           02244         bc      USBCtrlTrfTxServiceRamLoop
0016C4 CFE1 F412      02245         movff   FSR1L, pSrc             ; Update source pointer
0016C8 CFE2 F413      02246         movff   FSR1H, pSrc + 1
0016CC                02247 USBCtrlTrfTxServiceExit
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0016CC 0012           02248         return
                      02249 ;    }//end if(usb_stat.ctrl_trf_mem == _ROM)
                      02250 
                      02251 ;}//end USBCtrlTrfTxService
                      02252 
                      02253 ;/******************************************************************************
                      02254 ; * Function:        void USBCtrlTrfRxService(void)
                      02255 ; *
                      02256 ; * PreCondition:    pDst and wCount are setup properly.
                      02257 ; *                  pSrc is always &CtrlTrfData
                      02258 ; *                  usb_stat.ctrl_trf_mem is always _RAM.
                      02259 ; *                  wCount should be set to 0 at the start of each control
                      02260 ; *                  transfer.
                      02261 ; *
                      02262 ; * Input:           None
                      02263 ; *
                      02264 ; * Output:          None
                      02265 ; *
                      02266 ; * Side Effects:    None
                      02267 ; *
                      02268 ; * Overview:        *** This routine is only partially complete. Check for
                      02269 ; *                  new version of the firmware.
                      02270 ; *
                      02271 ; * Note:            None
                      02272 ; *****************************************************************************/
                      02273 ;void USBCtrlTrfRxService(void)
0016CE                02274 USBCtrlTrfRxService
                      02275 ;{
0016CE 0104           02276         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02277 ;    BYTE byteToRead;
                      02278 ;    BYTE i;
                      02279 
                      02280 ;    byteToRead = pBDTEntryEP0OutCurrent->CNT;
0016D0 5101           02281         movf    ep0Bo + Cnt, W
0016D2 6F10           02282         movwf   usb_temp
                      02283 
                      02284 ;    /*
                      02285 ;     * Accumulate total number of bytes read
                      02286 ;     */
                      02287 ;    if(byteToRead > outPipes[0].wCount.Val)
0016D4 671E           02288         tstfsz  outCount + 1    ; If high byte isn't 0 then not less than
0016D6 D003           02289         bra     USBCtrlTrfRxService1
0016D8 511D           02290         movf    outCount, W     ; Get low byte
0016DA 6110           02291         cpfslt  usb_temp
                      02292 ;    {
                      02293 ;        byteToRead = outPipes[0].wCount.Val;
0016DC 6F10           02294         movwf   usb_temp
                      02295 ;    }
                      02296 ;    else
0016DE                02297 USBCtrlTrfRxService1
                      02298 ;    {
                      02299 ;        outPipes[0].wCount.Val = outPipes[0].wCount.Val - byteToRead;
0016DE 5110           02300         movf    usb_temp, W
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0016E0 5F1D           02301         subwf   outCount, F
0016E2 A0D8           02302         btfss   STATUS, C
0016E4 071E           02303         decf    outCount + 1, F
                      02304 ;    }
                      02305 ;old    inPipes[0].wCount.Val = inPipes[0].wCount.Val + byteToRead.Val;
                      02306 ;       movf    ep0Bo + Cnt, W          ; Get low number of bytes to read
                      02307 ;       movwf   usb_temp                ; usb_temp & usb_temp + 1 are bytes to read
                      02308 ;       addwf   outCount, F             ; Accumulate total number of bytes read
                      02309 ;;      movf    ep0Bo + Stat, W         ; Get high bits to read
                      02310 ;;      andlw   0x03                    ; Mask to the count
                      02311 ;;      movwf   usb_temp + 1            ; Save to high byte of bytes to read
                      02312 ;       movlw   0
                      02313 ;       addwfc  outCount + 1, F         ; Add overflow from low byte (C) and high byte to total number
                      02314 
                      02315 ;    for(i=0;i<byteToRead;i++)
                      02316 ;    {
                      02317 ;        *outPipes[0].pDst.bRam++ = CtrlTrfData[i];
                      02318 ;    }//end while(byteToRead.Val)
0016E6 EE14 F066      02319         lfsr    1, CtrlTrfData          ; Point FSR1 to source
0016EA C415 FFD9      02320         movff   pDst, FSR2L             ; Move destination pointer to FSR2
0016EE C416 FFDA      02321         movff   pDst + 1, FSR2H
0016F2 5110           02322         movf    usb_temp, W             ; Check low byte for 0
                      02323 ;       iorwf   usb_temp+ 1, W          ; Check high byte for 0
0016F4 E008           02324         bz      USBCtrlTrfRxServiceExit ; If both 0 then nothing to send this time
0016F6                02325 USBCtrlTrfRxServiceLoop
0016F6 CFE6 FFDE      02326         movff   POSTINC1, POSTINC2      ; Copy one buffer to the other
0016FA 0710           02327         decf    usb_temp, F             ; Count down number of bytes
0016FC E1FC           02328         bnz     USBCtrlTrfRxServiceLoop
                      02329 ;       decf    usb_temp + 1, F
                      02330 ;       bc      USBCtrlTrfRxServiceLoop
0016FE CFD9 F415      02331         movff   FSR2L, pDst             ; Update destination pointer
001702 CFDA F416      02332         movff   FSR2H, pDst + 1
001706                02333 USBCtrlTrfRxServiceExit
                      02334 
                      02335 ;    //If there is more data to read
                      02336 ;    if(outPipes[0].wCount.Val > 0)
001706 511E           02337         movf    outCount + 1, W         ; Check high byte for 0
001708 111D           02338         iorwf   outCount, W             ; Check low byte for 0
00170A E009           02339         bz      USBCtrlTrfRxService2
                      02340 ;    {
                      02341 ;        /*
                      02342 ;         * Don't have to worry about overwriting _KEEP bit
                      02343 ;         * because if _KEEP was set, TRNIF would not have been
                      02344 ;         * generated in the first place.
                      02345 ;         */
                      02346 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
00170C 0104           02347         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00170E 0E40           02348         movlw   USB_EP0_BUFF_SIZE
001710 6F01           02349         movwf   ep0Bo + Cnt
                      02350 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
001712 0E66           02351         movlw   low CtrlTrfData
001714 6F02           02352         movwf   ep0Bo + ADRL
001716 0E04           02353         movlw   high CtrlTrfData
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001718 6F03           02354         movwf   ep0Bo + ADRH
                      02355 ;        if(pBDTEntryEP0OutCurrent->STAT.DTS == 0)
                      02356 ;        {
                      02357 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
                      02358 ;        }
                      02359 ;        else
                      02360 ;        {
                      02361 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN;
                      02362 ;        }
00171A 7D00           02363         btg     ep0Bo + Stat, DTS
                      02364 ;       movlw   _USIE|_DAT1|_DTSEN
                      02365 ;       btfsc   ep0Bo + Stat, DTS
                      02366 ;       movlw   _USIE|_DAT0|_DTSEN
                      02367 ;       movwf   ep0Bo + Stat
00171C 0012           02368         return
                      02369 ;    }
                      02370 ;    else
00171E                02371 USBCtrlTrfRxService2
                      02372 ;    {
                      02373 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
00171E 0E26           02374         movlw   low SetupPkt
001720 6F02           02375         movwf   ep0Bo + ADRL
001722 0E04           02376         movlw   high SetupPkt
001724 6F03           02377         movwf   ep0Bo + ADRH
                      02378 ;        if(outPipes[0].pFunc != NULL)
                      02379 ;        {
                      02380 ;            outPipes[0].pFunc();
                      02381 ;        }
                      02382 ;        outPipes[0].info.bits.busy = 0;
001726 9F24           02383         bcf     outfo, busy
                      02384 ;    }
                      02385 
                      02386 ;    // reset ep0Bo.Cnt to USB_EP0_BUFF_SIZE
                      02387 
001728 0012           02388         return
                      02389 ;}//end USBCtrlTrfRxService
                      02390 
                      02391 ;/********************************************************************
                      02392 ; * Function:        void USBStdSetCfgHandler(void)
                      02393 ; *
                      02394 ; * PreCondition:    None
                      02395 ; *
                      02396 ; * Input:           None
                      02397 ; *
                      02398 ; * Output:          None
                      02399 ; *
                      02400 ; * Side Effects:    None
                      02401 ; *
                      02402 ; * Overview:        This routine first disables all endpoints by
                      02403 ; *                  clearing UEP registers. It then configures
                      02404 ; *                  (initializes) endpoints by calling the callback
                      02405 ; *                  function USBCBInitDevClass().
                      02406 ; *
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02407 ; * Note:            None
                      02408 ; *******************************************************************/
                      02409 ;void USBStdSetCfgHandler(void)
00172A                02410 USBStdSetCfgHandler
                      02411 ;{
00172A 0104           02412         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02413 ;    // This will generate a zero length packet
                      02414 ;    inPipes[0].info.bits.busy = 1;
00172C 8F23           02415         bsf     info, busy
                      02416 
                      02417 ;    //disable all endpoints except endpoint 0
                      02418 ;    memset((void*)&U1EP1,0x00,(USB_MAX_EP_NUMBER-1));
00172E EE2F F071      02419         lfsr    2, UEP1                 ; Reset all non-EP0 UEPn registers
001732 0E01           02420         movlw   USB_MAX_EP_NUMBER
001734                02421 USBStdSetCfgHandlerClearEPLoop
001734 6ADE           02422         clrf    POSTINC2
001736 2EE8           02423         decfsz  WREG, F
001738 D7FD           02424         bra     USBStdSetCfgHandlerClearEPLoop
                      02425 
                      02426 ;    //clear the alternate interface settings
                      02427 ;    memset((void*)&USBAlternateInterface,0x00,USB_MAX_NUM_INT);
00173A EE24 F019      02428         lfsr    2, USBAlternateInterface        ; Clear usb_alt_intf array
00173E 0E01           02429         movlw   USB_MAX_NUM_INT
001740                02430 USBStdSetCfgHandlerClearAltLoop
001740 6ADE           02431         clrf    POSTINC2
001742 2EE8           02432         decfsz  WREG, F
001744 D7FD           02433         bra     USBStdSetCfgHandlerClearAltLoop
                      02434 
                      02435 ;    //set the current configuration
                      02436 ;    USBActiveConfiguration = SetupPkt.bConfigurationValue;
001746 5128           02437         movf    SetupPkt + bConfigurationValue, W
001748 6F18           02438         movwf   USBActiveConfiguration
                      02439 
                      02440 ;    //if the configuration value == 0
                      02441 ;    if(SetupPkt.bConfigurationValue == 0)
00174A E103           02442         bnz     USBStdSetCfgHandler1
                      02443 ;    {
                      02444 ;        //Go back to the addressed state
                      02445 ;        USBDeviceState = ADDRESS_STATE;
00174C 0E10           02446         movlw   ADDRESS_STATE           ; SetupPkt + bCfgValue = 0
00174E 6F17           02447         movwf   USBDeviceState
001750 0012           02448         return
                      02449 ;    }
                      02450 ;    else
001752                02451 USBStdSetCfgHandler1
                      02452 ;    {
                      02453 ;        //Otherwise go to the configured state
                      02454 ;        USBDeviceState = CONFIGURED_STATE;
001752 0E20           02455         movlw   CONFIGURED_STATE
001754 6F17           02456         movwf   USBDeviceState
                      02457 ;        //initialize the required endpoints
                      02458 ;        USBInitEP((BYTE ROM*)(USB_CD_Ptr[USBActiveConfiguration-1]));
                      02459 ;        USBCBInitEP();
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001756 D108           02460         bra     USBCBInitEP
                      02461 
                      02462 ;    }//end if(SetupPkt.bConfigurationValue == 0)
                      02463 ;}//end USBStdSetCfgHandler
                      02464 
                      02465 ;/********************************************************************
                      02466 ; * Function:        void USBConfigureEndpoint(BYTE EPNum, BYTE direction)
                      02467 ; *
                      02468 ; * PreCondition:    None
                      02469 ; *
                      02470 ; * Input:           BYTE EPNum - the endpoint to be configured
                      02471 ; *                  BYTE direction - the direction to be configured
                      02472 ; *
                      02473 ; * Output:          None
                      02474 ; *
                      02475 ; * Side Effects:    None
                      02476 ; *
                      02477 ; * Overview:        This function will configure the specified 
                      02478 ; *                  endpoint
                      02479 ; *
                      02480 ; * Note:            None
                      02481 ; *******************************************************************/
                      02482 ;void USBConfigureEndpoint(BYTE EPNum, BYTE direction)
                      02483 ;{
                      02484 ;    volatile BDT_ENTRY* handle;
                      02485 
                      02486 ;    handle = (volatile BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      02487 ;    handle += BD(EPNum,direction,0)/sizeof(BDT_ENTRY);
                      02488 
                      02489 ;    handle->STAT.UOWN = 0;
                      02490 
                      02491 ;    if(direction == 0)
                      02492 ;    {
                      02493 ;        pBDTEntryOut[EPNum] = handle;
                      02494 ;    }
                      02495 ;    else
                      02496 ;    {
                      02497 ;        pBDTEntryIn[EPNum] = handle;
                      02498 ;    }
                      02499 
                      02500 ;    #if (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG)
                      02501 ;        handle->STAT.DTS = 0;
                      02502 ;        (handle+1)->STAT.DTS = 1;
                      02503 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      02504 ;        //Set DTS to one because the first thing we will do
                      02505 ;        //when transmitting is toggle the bit
                      02506 ;        handle->STAT.DTS = 1;
                      02507 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      02508 ;        if(EPNum != 0)
                      02509 ;        {
                      02510 ;            handle->STAT.DTS = 1;
                      02511 ;        }
                      02512 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)    
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02513 ;        if(EPNum != 0)
                      02514 ;        {
                      02515 ;            handle->STAT.DTS = 0;
                      02516 ;            (handle+1)->STAT.DTS = 1;
                      02517 ;        }
                      02518 ;    #endif
                      02519 ;}
                      02520 
                      02521 ;/********************************************************************
                      02522 ; * Function:        void USBEnableEndpoint(BYTE ep, BYTE options)
                      02523 ; *
                      02524 ; * PreCondition:    None
                      02525 ; *
                      02526 ; * Input:
                      02527 ; *   BYTE ep - the endpoint to be configured
                      02528 ; *   BYTE options - optional settings for the endpoint.
                      02529 ; *        The options should be ORed together to form a 
                      02530 ; *        single options string.  The available options:
                      02531 ; *
                      02532 ; *        USB_HANDSHAKE_ENABLED - enable USB handshaking (ACK, NAK)
                      02533 ; *        USB_HANDSHAKE_DISABLED - disable USB handshaking (ACK, NAK)
                      02534 ; *        USB_OUT_ENABLED - enable the out direction
                      02535 ; *        USB_OUT_DISABLED - disable the out direction
                      02536 ; *        USB_IN_ENABLED - enable the in direction
                      02537 ; *        USB_IN_DISABLED - disable the in direction
                      02538 ; *        USB_ALLOW_SETUP - enable control transfers
                      02539 ; *        USB_DISALLOW_SETUP - disable control transfers
                      02540 ; *        USB_STALL_ENDPOINT - STALL this endpoint
                      02541 ; *
                      02542 ; * Output:          None
                      02543 ; *
                      02544 ; * Side Effects:    None
                      02545 ; *
                      02546 ; * Overview:        This function will enable the specified 
                      02547 ; *                  endpoint with the specified options
                      02548 ; *
                      02549 ; * Note:            None
                      02550 ; *******************************************************************/
                      02551 ;void USBEnableEndpoint(BYTE ep, BYTE options)
                      02552 ;{
                      02553 ;    //Set the options to the appropriate endpoint control register
                      02554 ;    //*((unsigned char*)(&U1EP0+ep)) = options;
                      02555 ;    {
                      02556 ;        unsigned int* p;
                      02557 
                      02558 ;        p = (unsigned int*)(&U1EP0+ep);
                      02559 ;        *p = options;
                      02560 ;    }
                      02561 ;    if(options & USB_OUT_ENABLED)
                      02562 ;    {
                      02563 ;        USBConfigureEndpoint(ep,0);
                      02564 ;    }
                      02565 ;    if(options & USB_IN_ENABLED)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02566 ;    {
                      02567 ;        USBConfigureEndpoint(ep,1);
                      02568 ;    }
                      02569 ;}
                      02570 
                      02571 ;  Enable and configure OUT endpoint
                      02572 ; Input:
                      02573 ;  FSR0L is endpoint number
                      02574 ;  FSR1 is endpoint buffer address
                      02575 ;  usb_temp is options
                      02576 ;  W is endpoint buffer size
                      02577 ; Returns:
                      02578 ;  Nada
                      02579 ; Uses
                      02580 ;  FSR0 is BDT pointer
                      02581 ;  FSR1 is endpoint buffer pointer
                      02582 ;  FSR2 is endpoint table pointer
                      02583 
001758                02584 USBEnableEndpointOut
                      02585 ; Save maximum count at front of endpoint buffer and move buffer pointer up
001758 6EE6           02586         movwf   POSTINC1                ; Store maximum count at front of endpoint buffer and move up po
                            inter
                      02587 
                      02588 ; Point FSR2 to endpoint table
00175A EE2F F070      02589         lfsr    2, UEP0                 ; FSR2 = beginning of endpoint table
00175E 50E9           02590         movf    FSR0L, W                ; Add in endpoint number
001760 26D9           02591         addwf   FSR2L, F
                      02592 
                      02593 ; Enable Out endpoint
001762 5110           02594         movf    usb_temp, W             ; Options to W
001764 6EDF           02595         movwf   INDF2                   ; Options to endpoint table
                      02596 
                      02597 ; Point FSR0 to endpoint BDT
001766 44E9           02598         rlncf   FSR0L, W                ; Endpoint number * 8
001768 46E8           02599         rlncf   WREG, F
00176A 46E8           02600         rlncf   WREG, F
00176C EE04 F000      02601         lfsr    0, ep0Bo                ; Point FSR0 to beginning of BDT area
001770 26E9           02602         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02603 
                      02604 ; Set endpoint buffer address from FSR1 + 1
001772 0E02           02605         movlw   ADRL                    ; Point to ADRL
001774 CFE1 FFEB      02606         movff   FSR1L, PLUSW0
001778 0E03           02607         movlw   ADRH                    ; Point to ADRH
00177A CFE2 FFEB      02608         movff   FSR1H, PLUSW0
                      02609 
                      02610 ; Set Cnt to maximum count
00177E 50E5           02611         movf    POSTDEC1, W             ; Back up endpoint buffer pointer (no PREDEC1!)
001780 2AE9           02612         incf    FSR0L, F                ; Point to Cnt
001782 CFE7 FFED      02613         movff   INDF1, POSTDEC0         ; Set maximum count and point back to Stat
                      02614 
                      02615 ; Set endpoint status
001786 9EEF           02616         bcf     INDF0, UOWN
001788 8CEF           02617         bsf     INDF0, DTS
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00178A 0012           02618         return
                      02619 
                      02620 ;  Enable and configure IN endpoint
                      02621 ; Input:
                      02622 ;  FSR0L is endpoint number
                      02623 ;  FSR1 is endpoint buffer address
                      02624 ;  usb_temp is options
                      02625 ;  W is endpoint buffer size
                      02626 ; Returns:
                      02627 ;  Nada
                      02628 ; Uses
                      02629 ;  FSR0 is BDT pointer
                      02630 ;  FSR1 is endpoint buffer pointer
                      02631 ;  FSR2 is endpoint table pointer
                      02632 
00178C                02633 USBEnableEndpointIn
                      02634 ; Save maximum count at front of endpoint buffer and move buffer pointer up (no need to put in Cnt for I
                            n)
00178C 6EE6           02635         movwf   POSTINC1                ; Store maximum count at front of endpoint buffer and move up po
                            inter
                      02636 
                      02637 ; Point FSR2 to endpoint table
00178E EE2F F070      02638         lfsr    2, UEP0                 ; FSR2 = beginning of endpoint table
001792 50E9           02639         movf    FSR0L, W                ; Add in endpoint number
001794 26D9           02640         addwf   FSR2L, F
                      02641 
                      02642 ; Enable In endpoint
001796 5110           02643         movf    usb_temp, W             ; Options to W
001798 6EDF           02644         movwf   INDF2                   ; Options to endpoint table
                      02645 
                      02646 ; Point FSR0 to endpoint BDT
00179A 44E9           02647         rlncf   FSR0L, W                ; Endpoint number * 8
00179C 46E8           02648         rlncf   WREG, F
00179E 46E8           02649         rlncf   WREG, F
0017A0 EE04 F004      02650         lfsr    0, ep0Bi                ; Point FSR0 to beginning of BDT area
0017A4 26E9           02651         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02652 
                      02653 ; Set endpoint buffer address from FSR1
0017A6 0E02           02654         movlw   ADRL                    ; Point to ADRL
0017A8 CFE1 FFEB      02655         movff   FSR1L, PLUSW0
0017AC 0E03           02656         movlw   ADRH                    ; Point to ADRH
0017AE CFE2 FFEB      02657         movff   FSR1H, PLUSW0
                      02658 
                      02659 ; Set endpoint status
0017B2 9EEF           02660         bcf     INDF0, UOWN
0017B4 8CEF           02661         bsf     INDF0, DTS
0017B6 0012           02662         return
                      02663 
                      02664 ;/********************************************************************
                      02665 ; * Function:        void USBStallEndpoint(BYTE ep, BYTE dir)
                      02666 ; *
                      02667 ; * PreCondition:    None
                      02668 ; *
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02669 ; * Input:
                      02670 ; *   BYTE ep - the endpoint the data will be transmitted on
                      02671 ; *   BYTE dir - the direction of the transfer
                      02672 ; *
                      02673 ; * Output:          None
                      02674 ; *
                      02675 ; * Side Effects:    Endpoint is STALLed
                      02676 ; *
                      02677 ; * Overview:        STALLs the specified endpoint
                      02678 ; *
                      02679 ; * Note:            None
                      02680 ; *******************************************************************/
                      02681 ;void USBStallEndpoint(BYTE ep, BYTE dir)
                      02682 ;USBStallEndpoint
                      02683 ;{
                      02684 ;    BDT_ENTRY *p;
                      02685 
                      02686 ;    if(ep == 0)
                      02687 ;       tstfsz  ep
                      02688 ;       bra     USBStallEndpoint1
                      02689 ;    {
                      02690 ;        /*
                      02691 ;         * If no one knows how to service this request then stall.
                      02692 ;         * Must also prepare EP0 to receive the next SETUP transaction.
                      02693 ;         */
                      02694 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
                      02695 ;       movlw   USB_EP0_BUFF_SIZE
                      02696 ;       movwf   ep0Bo + Cnt
                      02697 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
                      02698 ;       movlw   low SetupPkt
                      02699 ;       movwf   ep0Bo + ADRL
                      02700 ;       movlw   high SetupPkt
                      02701 ;       movwf   ep0Bo + ADRH
                      02702 
                      02703 ;        /* v2b fix */
                      02704 ;        pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
                      02705 ;       movlw   _USIE|_DAT0|_DTSEN|_BSTALL
                      02706 ;       movwf   ep0Bo + Stat
                      02707 ;        pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL; 
                      02708 ;       movlw   _USIE|_BSTALL
                      02709 ;       movwf   ep0Bi + Stat
                      02710 ;       return
                      02711 ;    }
0017B8                02712 USBStallEndpoint1
                      02713 ;    else
                      02714 ;    {
                      02715 ;        p = (BDT_ENTRY*)(&BDT[EP(ep,dir,0)]);
                      02716 ;       lfsr    0, ep0Bo                ; Point FSR0 to beginning of out BDT area
                      02717 ;       tstfsz  dir
                      02718 ;       lfsr    0, ep0Bi                ; Point FSR0 to beginning of in BDT area
                      02719 ;       rlncf   ep, W                   ; Endpoint number * 8
                      02720 ;       rlncf   WREG, F
                      02721 ;       rlncf   WREG, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 76


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02722 ;       addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02723 ;        p->STAT.Val |= _BSTALL | _USIE;
                      02724 ;       movlw   _BSTALL | _USIE
                      02725 ;       iorwf   INDF0, F
                      02726 
                      02727 ;        //If the device is in FULL or ALL_BUT_EP0 ping pong modes
                      02728 ;        //then stall that entry as well
                      02729 ;        #if (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG) || \
                      02730 ;            (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)
                      02731     
                      02732 ;        p = (BDT_ENTRY*)(&BDT[EP(ep,dir,1)]);
                      02733 ;        p->STAT.Val |= _BSTALL | _USIE;
                      02734 ;        #endif
                      02735 ;    }
                      02736 ;       return
                      02737 ;}
                      02738 
                      02739 ;/********************************************************************
                      02740 ; * Function:        USB_HANDLE USBTransferOnePacket(
                      02741 ; *                      BYTE ep, 
                      02742 ; *                      BYTE dir, 
                      02743 ; *                      BYTE* data, 
                      02744 ; *                      BYTE len)
                      02745 ; *
                      02746 ; * PreCondition:    None
                      02747 ; *
                      02748 ; * Input:
                      02749 ; *   BYTE ep - the endpoint the data will be transmitted on
                      02750 ; *   BYTE dir - the direction of the transfer
                      02751 ;                This value is either OUT_FROM_HOST or IN_TO_HOST
                      02752 ; *   BYTE* data - pointer to the data to be sent
                      02753 ; *   BYTE len - length of the data needing to be sent
                      02754 ; *
                      02755 ; * Output:          None
                      02756 ; *
                      02757 ; * Side Effects:    None
                      02758 ; *
                      02759 ; * Overview:        Transfers one packet over the USB
                      02760 ; *
                      02761 ; * Note:            None
                      02762 ; *******************************************************************/
                      02763 ;USB_HANDLE USBTransferOnePacket(BYTE ep,BYTE dir,BYTE* data,BYTE len)
                      02764 ;{
                      02765 ;    USB_HANDLE handle;
                      02766 
                      02767 ;    //If the direction is IN
                      02768 ;    if(dir != 0)
                      02769 ;    {
                      02770 ;        //point to the IN BDT of the specified endpoint
                      02771 ;        handle = pBDTEntryIn[ep];
                      02772 ;    }
                      02773 ;    else
                      02774 ;    {
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 77


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02775 ;        //else point to the OUT BDT of the specified endpoint
                      02776 ;        handle = pBDTEntryOut[ep];
                      02777 ;    }
                      02778 
                      02779 ;    //Toggle the DTS bit if required
                      02780 ;    #if (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      02781 ;        handle->STAT.Val ^= _DTSMASK;
                      02782 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      02783 ;        if(ep != 0)
                      02784 ;        {
                      02785 ;            handle->STAT.Val ^= _DTSMASK;
                      02786 ;        }
                      02787 ;    #endif
                      02788 
                      02789 ;    //Set the data pointer, data length, and enable the endpoint
                      02790 ;    handle->ADR = data;
                      02791 
                      02792 ;    handle->CNT = len;
                      02793 ;    handle->STAT.Val &= _DTSMASK;
                      02794 ;    handle->STAT.Val |= _USIE | _DTSEN;
                      02795 
                      02796 ;    //Point to the next buffer for ping pong purposes.
                      02797 ;    if(dir != 0)
                      02798 ;    {
                      02799 ;        //toggle over the to the next buffer for an IN endpoint
                      02800 ;        ((BYTE_VAL*)&pBDTEntryIn[ep])->Val ^= USB_NEXT_PING_PONG;
                      02801 ;    }
                      02802 ;    else
                      02803 ;    {
                      02804 ;        //toggle over the to the next buffer for an OUT endpoint
                      02805 ;        ((BYTE_VAL*)&pBDTEntryOut[ep])->Val ^= USB_NEXT_PING_PONG;
                      02806 ;    }
                      02807 ;    return handle;
                      02808 ;}
                      02809 
                      02810 ;  Get from OUT endpoint for RX
                      02811 ; Input:
                      02812 ;  FSR0L is endpoint number
                      02813 ;  FSR1 is destination buffer pointer
                      02814 ;  W is max buffer length
                      02815 ; Returns:
                      02816 ;  FSR1 is updated destination buffer pointer
                      02817 ;  W returns number received
                      02818 ;  Carry is clear for buffer not available
                      02819 ; Uses
                      02820 ;  FSR0 is BDT pointer
                      02821 ;  FSR1 is destination buffer pointer
                      02822 ;  FSR2 is endpoint buffer pointer
                      02823 ;  R0 in BANKA is temporary length storage
                      02824 
0017B8                02825 USBRxOnePacket
0017B8                02826 GetUSB
0017B8 0104           02827         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 78


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0017BA 6F10           02828         movwf   usb_temp                ; Save max buffer length
                      02829 
                      02830 ; Check to see if we're configured
0017BC 0E20           02831         movlw   CONFIGURED_STATE        ; We might not be configured yet
0017BE 5D17           02832         subwf   USBDeviceState, W
0017C0 0E00           02833         movlw   0                       ; 0 characters received, so far
0017C2 90D8           02834         bcf     STATUS, C               ; Clear Carry for possible error return
0017C4 E109           02835         bnz     GetUSBNotReady          ; We're not configured
                      02836 
                      02837 ; Point FSR0 to requested endpoint Out BDT
0017C6 44E9           02838         rlncf   FSR0L, W                ; Endpoint number * 8
0017C8 46E8           02839         rlncf   WREG, F
0017CA 46E8           02840         rlncf   WREG, F
0017CC EE04 F000      02841         lfsr    0, ep0Bo                ; Point FSR0 to beginning of BDT area
0017D0 26E9           02842         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02843 
0017D2 0E00           02844         movlw   0                       ; 0 characters received, so far
0017D4 90D8           02845         bcf     STATUS, C               ; Clear Carry for possible error return
0017D6 BEEF           02846         btfsc   INDF0, UOWN             ; Who owns the buffer (Stat, UOWN)?
0017D8                02847 GetUSBNotReady
0017D8 0012           02848         return                          ; Busy (we don't)
                      02849 
                      02850 ; Get endpoint buffer address to FSR2
0017DA 0E02           02851         movlw   ADRL                    ; Point to ADRL
0017DC CFEB FFD9      02852         movff   PLUSW0, FSR2L
0017E0 0E03           02853         movlw   ADRH                    ; Point to ADRH
0017E2 CFEB FFDA      02854         movff   PLUSW0, FSR2H
                      02855 
0017E6 50EC           02856         movf    PREINC0, W              ; Get Cnt
0017E8 6110           02857         cpfslt  usb_temp                ; Make sure it's not longer than the buffer
0017EA 6F10           02858         movwf   usb_temp                ; It's OK, save returned length
                      02859 
0017EC 0EFF           02860         movlw   -1
0017EE 50DB           02861         movf    PLUSW2, W               ; Get maximum length from in front of endpoint buffer
0017F0 6EED           02862         movwf   POSTDEC0                ; Reset max length and point back to Stat
                      02863 
0017F2 5110           02864         movf    usb_temp, W             ; Get count to W
0017F4 E004           02865         bz      GetPutUSBZero           ; Nothing received
                      02866 
0017F6                02867 GetUSBLoop
0017F6 CFDE FFE6      02868         movff   POSTINC2, POSTINC1      ; Copy endpoint buffer to destination buffer
0017FA 2EE8           02869         decfsz  WREG, F                 ; Count down number of bytes
0017FC D7FC           02870         bra     GetUSBLoop
                      02871 
0017FE                02872 GetPutUSBZero
0017FE 0E40           02873         movlw   _DTSMASK                ; Save only DTS bit
001800 16EF           02874         andwf   INDF0, F
001802 7CEF           02875         btg     INDF0, DTS              ; Toggle DTS bit
001804 0E88           02876         movlw   _USIE|_DTSEN            ; Turn ownership to SIE
001806 12EF           02877         iorwf   INDF0, F
001808 5110           02878         movf    usb_temp, W             ; Return number of bytes received
00180A 80D8           02879         bsf     STATUS, C               ; Set Carry for non-error return
00180C 0012           02880         return
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 79


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02881 
                      02882 ;  Fill IN endpoint for TX
                      02883 ; Input:
                      02884 ;  FSR0L is endpoint number
                      02885 ;  FSR1 is source buffer pointer
                      02886 ;  W is count
                      02887 ; Returns:
                      02888 ;  FSR1 is updated source buffer pointer
                      02889 ;  W returns number sent
                      02890 ;  Carry is clear for buffer not available
                      02891 ; Uses:
                      02892 ;  FSR0 is BDT pointer
                      02893 ;  FSR1 is source buffer pointer
                      02894 ;  FSR2 is endpoint buffer pointer
                      02895 ;  R0 in BANKA is temporary length storage
                      02896 
00180E                02897 USBTxOnePacket
00180E                02898 PutUSB
00180E 0104           02899         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
001810 6F10           02900         movwf   usb_temp                ; Save count
                      02901 
                      02902 ; Check to see if we're configured
001812 0E20           02903         movlw   CONFIGURED_STATE        ; We might not be configured yet
001814 5D17           02904         subwf   USBDeviceState, W
001816 0E00           02905         movlw   0                       ; 0 characters sent, so far
001818 90D8           02906         bcf     STATUS, C               ; Clear Carry for possible error return
00181A E109           02907         bnz     PutUSBNotReady          ; We're not configured
                      02908 
                      02909 ; Point FSR0 to requested endpoint In BDT
00181C 44E9           02910         rlncf   FSR0L, W                ; Endpoint number * 8
00181E 46E8           02911         rlncf   WREG, F
001820 46E8           02912         rlncf   WREG, F
001822 EE04 F004      02913         lfsr    0, ep0Bi                ; Point FSR0 to beginning of BDT area
001826 26E9           02914         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02915 
001828 0E00           02916         movlw   0                       ; 0 characters sent, so far
00182A 90D8           02917         bcf     STATUS, C               ; Clear Carry for possible error return
00182C BEEF           02918         btfsc   INDF0, UOWN             ; Who owns the buffer (Stat, UOWN)?
00182E                02919 PutUSBNotReady
00182E 0012           02920         return                          ; Busy (we don't)
                      02921 
                      02922 ; Get endpoint buffer address to FSR2
001830 0E02           02923         movlw   ADRL                    ; Point to ADRL
001832 CFEB FFD9      02924         movff   PLUSW0, FSR2L
001836 0E03           02925         movlw   ADRH                    ; Point to ADRH
001838 CFEB FFDA      02926         movff   PLUSW0, FSR2H
                      02927 
00183C 0EFF           02928         movlw   -1
00183E 50DB           02929         movf    PLUSW2, W               ; Get maximum length from in front of endpoint buffer
                      02930 
001840 6110           02931         cpfslt  usb_temp                ; Find number of bytes to send this time
001842 6F10           02932         movwf   usb_temp                ; Too big - send maximum allowed length
                      02933 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 80


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001844 2AE9           02934         incf    FSR0L, F                ; Point to Cnt
001846 5110           02935         movf    usb_temp, W             ; Get number to send
001848 6EED           02936         movwf   POSTDEC0                ; Put length into Cnt and point back to Stat
00184A E0D9           02937         bz      GetPutUSBZero           ; Zero to send
                      02938 
00184C                02939 PutUSBLoop
00184C CFE6 FFDE      02940         movff   POSTINC1, POSTINC2      ; Copy source buffer to endpoint buffer
001850 2EE8           02941         decfsz  WREG, F                 ; Count down number of bytes to transfer
001852 D7FC           02942         bra     PutUSBLoop
001854 D7D4           02943         bra     GetPutUSBZero
                      02944 
                      02945 ;/********************************************************************
                      02946 ; * Function:        void USBClearInterruptFlag(BYTE* reg, BYTE flag)
                      02947 ; *
                      02948 ; * PreCondition:    None
                      02949 ; *
                      02950 ; * Input:           
                      02951 ; *   BYTE* reg - the register address holding the interrupt flag
                      02952 ; *   BYTE flag - the bit number needing to be cleared
                      02953 ; *
                      02954 ; * Output:          None
                      02955 ; *
                      02956 ; * Side Effects:    None
                      02957 ; *
                      02958 ; * Overview:        clears the specified interrupt flag.
                      02959 ; *
                      02960 ; * Note:            
                      02961 ; *******************************************************************/
                      02962 ;void USBClearInterruptFlag(BYTE* reg, BYTE flag)
                      02963 ;{
                      02964 ;    #if defined(__18CXX)
                      02965 ;        *reg &= ~(0x01<<flag);
                      02966 ;    #elif defined(__C30__)
                      02967 ;        *reg = (0x01<<flag);        
                      02968 ;    #endif
                      02969 ;}
                      02970 ;/** EOF USBDevice.c *****************************************************/
                      00006 
                      00007 ;/********************************************************************
                      00008 ; FileName:             usb_function_hid.c
                      00009 ; Dependencies: See INCLUDES section
                      00010 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00011 ; Hardware:             The code is natively intended to be used on the following
                      00012 ;                               hardware platforms: PICDEM™ FS USB Demo Board, 
                      00013 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00014 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00015 ;                               modified for use on other USB platforms by editing the
                      00016 ;                               HardwareProfile.h file.
                      00017 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00018 ; Company:              Microchip Technology, Inc.
                      00019 
                      00020 ; Software License Agreement:
                      00021 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 81


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00022 ; The software supplied herewith by Microchip Technology Incorporated
                      00023 ; (the “Company”) for its PIC® Microcontroller is intended and
                      00024 ; supplied to you, the Company’s customer, for use solely and
                      00025 ; exclusively on Microchip PIC Microcontroller products. The
                      00026 ; software is owned by the Company and/or its supplier, and is
                      00027 ; protected under applicable copyright laws. All rights are reserved.
                      00028 ; Any use in violation of the foregoing restrictions may subject the
                      00029 ; user to criminal sanctions under applicable laws, as well as to
                      00030 ; civil liability for the breach of the terms and conditions of this
                      00031 ; license.
                      00032 
                      00033 ; THIS SOFTWARE IS PROVIDED IN AN “AS IS” CONDITION. NO WARRANTIES,
                      00034 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
                      00035 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00036 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00037 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00038 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00039 
                      00040 ;********************************************************************
                      00041 ; File Description:
                      00042 
                      00043 ; Change History:
                      00044 ;  Rev   Date         Description
                      00045 ;  1.0   11/19/2004   Initial release
                      00046 ;  2.1   02/26/2007   Updated for simplicity and to use common
                      00047 ;                     coding style
                      00048 ;*******************************************************************/
                      00049 
                      00050 ;/** INCLUDES *******************************************************/
                      00051 ;#include "GenericTypeDefs.h"
                      00052 ;#include "Compiler.h"
                      00053 ;#include "usb_config.h"
                      00054 ;#include "./USB/usb_device.h"
                      00055 ;#include "./USB/usb_function_hid.h"
                      00056 
                      00057 ;/** VARIABLES ******************************************************/
                      00058 ;#pragma udata
                      00059 ;BYTE idle_rate;
                      00060 ;BYTE active_protocol;   // [0] Boot Protocol [1] Report Protocol
                      00061 ;BYTE hid_rpt_rx_len;
                      00062 
                      00063 ;/** PRIVATE PROTOTYPES *********************************************/
                      00064 ;void HIDGetReportHandler(void);
                      00065 ;void HIDSetReportHandler(void);
                      00066 
                      00067 ;/** DECLARATIONS ***************************************************/
                      00068 ;#pragma code
                      00069 
                      00070 ;/** CLASS SPECIFIC REQUESTS ****************************************/
                      00071 ;/********************************************************************
                      00072 ; * Function:        void USBCheckHIDRequest(void)
                      00073 ; *
                      00074 ; * PreCondition:    None
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 82


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00075 ; *
                      00076 ; * Input:           None
                      00077 ; *
                      00078 ; * Output:          None
                      00079 ; *
                      00080 ; * Side Effects:    None
                      00081 ; *
                      00082 ; * Overview:        This routine checks the setup data packet to see
                      00083 ; *                  if it knows how to handle it
                      00084 ; *
                      00085 ; * Note:            None
                      00086 ; *******************************************************************/
                      00087 ;void USBCheckHIDRequest(void)
001856                00088 USBCheckHIDRequest
                      00089 ;{
001856 0104           00090         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00091 ;    if(SetupPkt.Recipient != RCPT_INTF) return;
001858 5126           00092         movf    SetupPkt, W             ; Recipient = RCPT_INTF?
00185A 0B1F           00093         andlw   0x1f                    ; Mask to lower 5 bits
00185C 0801           00094         sublw   RCPT_INTF
00185E E102           00095         bnz     USBCheckHIDRequestExit  ; No
                      00096 ;    if(SetupPkt.bIntfID != HID_INTF_ID) return;
001860 0E00           00097         movlw   HID_INTF_ID             ; IntfID = HID_INTF_ID?
001862 632A           00098         cpfseq  SetupPkt + bIntfID
001864                00099 USBCheckHIDRequestExit
001864 0012           00100         return                          ; No
                      00101     
                      00102 ;    /*
                      00103 ;     * There are two standard requests that hid.c may support.
                      00104 ;     * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00105 ;     * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00106 ;     */
                      00107 ;    if(SetupPkt.bRequest == GET_DSC)
001866 0E06           00108         movlw   GET_DSC                 ; Request = GET_DSC?
001868 6327           00109         cpfseq  SetupPkt + bRequest
00186A D03C           00110         bra     USBCheckHIDRequestClass ; No
                      00111 ;    {
                      00112 ;        switch(SetupPkt.bDescriptorType)
                      00113 ;        {
                      00114 ;            case DSC_HID:           
00186C 0E21           00115         movlw   DSC_HID                 ; DescriptorType = DSC_HID?
00186E 6329           00116         cpfseq  SetupPkt + bDescriptorType
001870 D017           00117         bra     USBCheckHIDRequest1     ; No
                      00118 ;                if(USBActiveConfiguration == 1)
001872 0E01           00119         movlw   1                       ; USBActiveConfiguration = 1?
001874 6318           00120         cpfseq  USBActiveConfiguration
001876 D036           00121         bra     USBCheckHIDRequestClass ; No
                      00122 ;                {
                      00123 ;                    USBEP0SendROMPtr(
                      00124 ;                        (ROM BYTE*)&configDescriptor1 + 18,
                      00125 ;                        sizeof(USB_HID_DSC)+3,     // RRoj hack
                      00126 ;                        USB_EP0_INCLUDE_ZERO);
                      00127         mSetSourcePointer HIDDescriptor1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 83


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001878 0EEE               M         movlw   low (HIDDescriptor1)
00187A 6F12               M         movwf   pSrc
00187C 0E19               M         movlw   high (HIDDescriptor1)
00187E 6F13               M         movwf   pSrc + 1
001880 0E00               M         movlw   upper (HIDDescriptor1)
001882 6F14               M         movwf   pSrc + 2
                      00128         mGetRomTableCount               ; Set wCount
001884 C412 FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
001888 C413 FFF7          M         movff   pSrc + 1, TBLPTRH
00188C C414 FFF8          M         movff   pSrc + 2, TBLPTRU
001890 0008               M         tblrd   *                       ; Read count
001892 CFF5 F41B          M         movff   TABLAT, inCount
001896 6B1C               M         clrf    inCount + 1
                      00129 ;       clrf    info
001898 9123           00130         bcf     info, ctrl_trf_mem      ; Indicate ROM
00189A 8D23           00131         bsf     info, includeZero       ; Include a trailing zero packet
00189C 8F23           00132         bsf     info, busy
00189E D022           00133         bra     USBCheckHIDRequestClass
                      00134 ;                }
                      00135 ;                break;
0018A0                00136 USBCheckHIDRequest1
                      00137 ;            case DSC_RPT:             
0018A0 0E22           00138         movlw   DSC_RPT                 ; DescriptorType = DSC_RPT?
0018A2 6329           00139         cpfseq  SetupPkt + bDescriptorType
0018A4 D01A           00140         bra     USBCheckHIDRequest2     ; No
                      00141 ;                if(USBActiveConfiguration == 1)
0018A6 0E01           00142         movlw   1                       ; USBActiveConfiguration = 1?
0018A8 6318           00143         cpfseq  USBActiveConfiguration
0018AA D01C           00144         bra     USBCheckHIDRequestClass ; No
                      00145 ;                {
                      00146 ;                    USBEP0SendROMPtr(
                      00147 ;                        (ROM BYTE*)&hid_rpt01,
                      00148 ;                        sizeof(hid_rpt01),     //See usbcfg.h
                      00149 ;                        USB_EP0_INCLUDE_ZERO);
                      00150         mSetSourcePointer ReportDescriptor1
0018AC 0E1C               M         movlw   low (ReportDescriptor1)
0018AE 6F12               M         movwf   pSrc
0018B0 0E1A               M         movlw   high (ReportDescriptor1)
0018B2 6F13               M         movwf   pSrc + 1
0018B4 0E00               M         movlw   upper (ReportDescriptor1)
0018B6 6F14               M         movwf   pSrc + 2
0018B8 0EFC           00151         movlw   low (ReportDescriptor1Len)      ; Set wCount
0018BA 6EF6           00152         movwf   TBLPTRL
0018BC 0E19           00153         movlw   high (ReportDescriptor1Len)
0018BE 6EF7           00154         movwf   TBLPTRH
0018C0 0E00           00155         movlw   upper (ReportDescriptor1Len)
0018C2 6EF8           00156         movwf   TBLPTRU
0018C4 0009           00157         tblrd   *+                      ; Read count low
0018C6 CFF5 F41B      00158         movff   TABLAT, inCount
0018CA 0009           00159         tblrd   *+                      ; Skip next
0018CC 0008           00160         tblrd   *                       ; Read count high
0018CE CFF5 F41C      00161         movff   TABLAT, inCount + 1
                      00162 ;       clrf    info
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 84


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0018D2 9123           00163         bcf     info, ctrl_trf_mem      ; Indicate ROM
0018D4 8D23           00164         bsf     info, includeZero       ; Include a trailing zero packet
0018D6 8F23           00165         bsf     info, busy
0018D8 D005           00166         bra     USBCheckHIDRequestClass
                      00167 ;                }
                      00168 ;                break;
0018DA                00169 USBCheckHIDRequest2
                      00170 ;            case DSC_PHY:
0018DA 0E23           00171         movlw   DSC_PHY                 ; DescriptorType = DSC_PHY?
0018DC 6329           00172         cpfseq  SetupPkt + bDescriptorType
0018DE D002           00173         bra     USBCheckHIDRequestClass
                      00174 ;                USBEP0Transmit(USB_EP0_NO_DATA);
0018E0 6B23           00175         clrf    info
0018E2 8F23           00176         bsf     info, busy
                      00177 ;                break;
                      00178 ;        }//end switch(SetupPkt.bDescriptorType)
                      00179 ;    }//end if(SetupPkt.bRequest == GET_DSC)
                      00180     
0018E4                00181 USBCheckHIDRequestClass
                      00182 ;    if(SetupPkt.RequestType != CLASS) return;
0018E4 5126           00183         movf    SetupPkt, W             ; RequestType = CLASS?
0018E6 0B60           00184         andlw   0x60                    ; Mask to proper bits
0018E8 0820           00185         sublw   (CLASS) << 5
0018EA E1BC           00186         bnz     USBCheckHIDRequestExit  ; No
                      00187 ;    switch(SetupPkt.bRequest)
                      00188 ;    {
                      00189 ;        case GET_REPORT:
0018EC 0E01           00190         movlw   GET_REPORT              ; Request = GET_REPORT?
0018EE 5D27           00191         subwf   SetupPkt + bRequest, W
                      00192 ;            HIDGetReportHandler();
0018F0 E033           00193         bz      HIDGetReportHandler     ; Yes
                      00194 ;            break;
                      00195 ;        case SET_REPORT:
0018F2 0E09           00196         movlw   SET_REPORT              ; Request = SET_REPORT?
0018F4 5D27           00197         subwf   SetupPkt + bRequest, W
                      00198 ;            HIDSetReportHandler();            
0018F6 E031           00199         bz      HIDSetReportHandler     ; Yes
                      00200 ;            break;
                      00201 ;        case GET_IDLE:
0018F8 0E02           00202         movlw   GET_IDLE                ; Request = GET_IDLE?
0018FA 6327           00203         cpfseq  SetupPkt + bRequest
0018FC D00D           00204         bra     USBCheckHIDRequestClass1        ; No
                      00205 ;            USBEP0SendRAMPtr(
                      00206 ;                (BYTE*)&idle_rate,
                      00207 ;                1,
                      00208 ;                USB_EP0_INCLUDE_ZERO);
                      00209         mSetSourcePointer idle_rate
0018FE 0EA6               M         movlw   low (idle_rate)
001900 6F12               M         movwf   pSrc
001902 0E04               M         movlw   high (idle_rate)
001904 6F13               M         movwf   pSrc + 1
001906 0E00               M         movlw   upper (idle_rate)
001908 6F14               M         movwf   pSrc + 2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 85


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00190A 0E01           00210         movlw   1
00190C 6F1B           00211         movwf   inCount
00190E 6B1C           00212         clrf    inCount + 1
                      00213 ;       clrf    info
001910 8123           00214         bsf     info, ctrl_trf_mem      ; Indicate RAM
001912 8D23           00215         bsf     info, includeZero       ; Include a trailing zero packet
001914 8F23           00216         bsf     info, busy
001916 0012           00217         return
                      00218 ;            break;
001918                00219 USBCheckHIDRequestClass1
                      00220 ;        case SET_IDLE:
001918 0E0A           00221         movlw   SET_IDLE                ; Request = SET_IDLE?
00191A 6327           00222         cpfseq  SetupPkt + bRequest
00191C D005           00223         bra     USBCheckHIDRequestClass2        ; No
                      00224 ;            USBEP0Transmit(USB_EP0_NO_DATA);
00191E 6B23           00225         clrf    info
001920 8F23           00226         bsf     info, busy
                      00227 ;            idle_rate = SetupPkt.W_Value.byte.HB;
001922 C429 F4A6      00228         movff   SetupPkt + wValue + 1, idle_rate
001926 0012           00229         return
                      00230 ;            break;
001928                00231 USBCheckHIDRequestClass2
                      00232 ;        case GET_PROTOCOL:
001928 0E03           00233         movlw   GET_PROTOCOL            ; Request = GET_PROTOCOL?
00192A 6327           00234         cpfseq  SetupPkt + bRequest
00192C D00D           00235         bra     USBCheckHIDRequestClass3        ; No
                      00236 ;            USBEP0SendRAMPtr(
                      00237 ;                (BYTE*)&active_protocol,
                      00238 ;                1,
                      00239 ;                USB_EP0_NO_OPTIONS);
                      00240         mSetSourcePointer active_protocol
00192E 0EA7               M         movlw   low (active_protocol)
001930 6F12               M         movwf   pSrc
001932 0E04               M         movlw   high (active_protocol)
001934 6F13               M         movwf   pSrc + 1
001936 0E00               M         movlw   upper (active_protocol)
001938 6F14               M         movwf   pSrc + 2
00193A 0E01           00241         movlw   1
00193C 6F1B           00242         movwf   inCount
00193E 6B1C           00243         clrf    inCount + 1
001940 6B23           00244         clrf    info
001942 8123           00245         bsf     info, ctrl_trf_mem      ; Indicate RAM
001944 8F23           00246         bsf     info, busy
001946 0012           00247         return
                      00248 ;            break;
001948                00249 USBCheckHIDRequestClass3
                      00250 ;        case SET_PROTOCOL:
001948 0E0B           00251         movlw   SET_PROTOCOL            ; Request = SET_PROTOCOL?
00194A 6327           00252         cpfseq  SetupPkt + bRequest
00194C 0012           00253         return                          ; No
                      00254 ;            USBEP0Transmit(USB_EP0_NO_DATA);
00194E 6B23           00255         clrf    info
001950 8F23           00256         bsf     info, busy
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 86


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00257 ;            active_protocol = SetupPkt.W_Value.byte.LB;
001952 C428 F4A7      00258         movff   SetupPkt + wValue, active_protocol
                      00259 ;            break;
                      00260 ;    }//end switch(SetupPkt.bRequest)
001956 0012           00261         return
                      00262 ;}//end USBCheckHIDRequest
                      00263 
                      00264 ;void HIDGetReportHandler(void)
001958                00265 HIDGetReportHandler
                      00266 ;{
001958 0012           00267         return
                      00268 ;}//end HIDGetReportHandler
                      00269 
                      00270 ;void HIDSetReportHandler(void)
00195A                00271 HIDSetReportHandler
                      00272 ;{
00195A 0012           00273         return
                      00274 ;}//end HIDSetReportHandler
                      00275 
                      00276 ;/** USER API *******************************************************/
                      00277 
                      00278 ;/********************************************************************
                      00279 ; * Function:        void HIDInitEP(void)
                      00280 ; *
                      00281 ; * PreCondition:    None
                      00282 ; *
                      00283 ; * Input:           None
                      00284 ; *
                      00285 ; * Output:          None
                      00286 ; *
                      00287 ; * Side Effects:    None
                      00288 ; *
                      00289 ; * Overview:        HIDInitEP initializes HID endpoints, buffer
                      00290 ; *                  descriptors, internal state-machine, and
                      00291 ; *                  variables. It should be called after the USB
                      00292 ; *                  host has sent out a SET_CONFIGURATION request.
                      00293 ; *                  See USBStdSetCfgHandler() in usbd.c for examples.
                      00294 ; *
                      00295 ; * Note:            None
                      00296 ; *******************************************************************/
                      00297 ;#if !defined(USB_DYNAMIC_EP_CONFIG)
                      00298 ;void HIDInitEP(void)
                      00299 ;{   
                      00300 ;}//end HIDInitEP
                      00301 ;#endif
                      00302 
                      00303 ;// ****************************************************************************************************
                            **
                      00304 ;// ************** USB Callback Functions **************************************************************
                            **
                      00305 ;// ****************************************************************************************************
                            **
                      00306 ;// The USB firmware stack will call the callback functions USBCBxxx() in response to certain USB relate
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 87


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            d
                      00307 ;// events.  For example, if the host PC is powering down, it will stop sending out Start of Frame (SOF)
                      00308 ;// packets to your device.  In response to this, all USB devices are supposed to decrease their power
                      00309 ;// consumption from the USB Vbus to <2.5mA each.  The USB module detects this condition (which accordin
                            g
                      00310 ;// to the USB specifications is 3+ms of no bus activity/SOF packets) and then calls the USBCBSuspend()
                      00311 ;// function.  You should modify these callback functions to take appropriate actions for each of these
                      00312 ;// conditions.  For example, in the USBCBSuspend(), you may wish to add code that will decrease power
                      00313 ;// consumption from Vbus to <2.5mA (such as by clock switching, turning off LEDs, putting the
                      00314 ;// microcontroller to sleep, etc.).  Then, in the USBCBWakeFromSuspend() function, you may then wish to
                      00315 ;// add code that undoes the power saving things done in the USBCBSuspend() function.
                      00316 
                      00317 ;// The USBCBSendResume() function is special, in that the USB stack will not automatically call this
                      00318 ;// function.  This function is meant to be called from the application firmware instead.  See the
                      00319 ;// additional comments near the function.
                      00320 
                      00321 ;/******************************************************************************
                      00322 ; * Function:        void USBCBSuspend(void)
                      00323 ; *
                      00324 ; * PreCondition:    None
                      00325 ; *
                      00326 ; * Input:           None
                      00327 ; *
                      00328 ; * Output:          None
                      00329 ; *
                      00330 ; * Side Effects:    None
                      00331 ; *
                      00332 ; * Overview:        Call back that is invoked when a USB suspend is detected
                      00333 ; *
                      00334 ; * Note:            None
                      00335 ; *****************************************************************************/
                      00336 ;void USBCBSuspend(void)
00195C                00337 USBCBSuspend
                      00338 ;{
                      00339 ;       //Example power saving code.  Insert appropriate code here for the desired
                      00340 ;       //application behavior.  If the microcontroller will be put to sleep, a
                      00341 ;       //process similar to that shown below may be used:
                      00342         
                      00343 ;       //ConfigureIOPinsForLowPower();
                      00344 ;       //SaveStateOfAllInterruptEnableBits();
                      00345 ;       //DisableAllInterruptEnableBits();
                      00346 ;       //EnableOnlyTheInterruptsWhichWillBeUsedToWakeTheMicro();       //should enable at least USBActi
                            vityIF as a wake source
                      00347 ;       //Sleep();
                      00348 ;       //RestoreStateOfAllPreviouslySavedInterruptEnableBits();        //Preferrably, this should be do
                            ne in the USBCBWakeFromSuspend() function instead.
                      00349 ;       //RestoreIOPinsToNormal();                                                                      
                            //Preferrably, this should be done in the USBCBWakeFromSuspend() function instead.
                      00350 
                      00351 ;       //IMPORTANT NOTE: Do not clear the USBActivityIF (ACTVIF) bit here.  This bit is 
                      00352 ;       //cleared inside the usb_device.c file.  Clearing USBActivityIF here will cause 
                      00353 ;       //things to not work as intended.       
                      00354         
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 88


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00355 
                      00356 ;    #if defined(__C30__)
                      00357 ;    #if 0
                      00358 ;        U1EIR = 0xFFFF;
                      00359 ;        U1IR = 0xFFFF;
                      00360 ;        U1OTGIR = 0xFFFF;
                      00361 ;        IFS5bits.USB1IF = 0;
                      00362 ;        IEC5bits.USB1IE = 1;
                      00363 ;        U1OTGIEbits.ACTVIE = 1;
                      00364 ;        U1OTGIRbits.ACTVIF = 1;
                      00365 ;        TRISA &= 0xFF3F;
                      00366 ;        LATAbits.LATA6 = 1;
                      00367 ;        Sleep();
                      00368 ;        LATAbits.LATA6 = 0;
                      00369 ;    #endif
                      00370 ;    #endif
00195C 0012           00371         return
                      00372 ;}
                      00373 
                      00374 
                      00375 ;/******************************************************************************
                      00376 ; * Function:        void _USB1Interrupt(void)
                      00377 ; *
                      00378 ; * PreCondition:    None
                      00379 ; *
                      00380 ; * Input:           None
                      00381 ; *
                      00382 ; * Output:          None
                      00383 ; *
                      00384 ; * Side Effects:    None
                      00385 ; *
                      00386 ; * Overview:        This function is called when the USB interrupt bit is set
                      00387 ; *                                     In this example the interrupt is only used when the device
                      00388 ; *                                     goes to sleep when it receives a USB suspend command
                      00389 ; *
                      00390 ; * Note:            None
                      00391 ; *****************************************************************************/
                      00392 ;#if 0
                      00393 ;void __attribute__ ((interrupt)) _USB1Interrupt(void)
                      00394 ;{
                      00395 ;    #if !defined(self_powered)
                      00396 ;        if(U1OTGIRbits.ACTVIF)
                      00397 ;        {
                      00398 ;            LATAbits.LATA7 = 1;
                      00399 ;        
                      00400 ;            IEC5bits.USB1IE = 0;
                      00401 ;            U1OTGIEbits.ACTVIE = 0;
                      00402 ;            IFS5bits.USB1IF = 0;
                      00403 ;        
                      00404 ;            //USBClearInterruptFlag(USBActivityIFReg,USBActivityIFBitNum);
                      00405 ;            USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
                      00406 ;            //USBSuspendControl = 0;
                      00407 ;            LATAbits.LATA7 = 0;
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 89


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00408 ;        }
                      00409 ;    #endif
                      00410 ;}
                      00411 ;#endif
                      00412 
                      00413 ;/******************************************************************************
                      00414 ; * Function:        void USBCBWakeFromSuspend(void)
                      00415 ; *
                      00416 ; * PreCondition:    None
                      00417 ; *
                      00418 ; * Input:           None
                      00419 ; *
                      00420 ; * Output:          None
                      00421 ; *
                      00422 ; * Side Effects:    None
                      00423 ; *
                      00424 ; * Overview:        The host may put USB peripheral devices in low power
                      00425 ; *                                     suspend mode (by "sending" 3+ms of idle).  Once in suspend
                      00426 ; *                                     mode, the host may wake the device back up by sending non-
                      00427 ; *                                     idle state signalling.
                      00428 ; *                                     
                      00429 ; *                                     This call back is invoked when a wakeup from USB suspend 
                      00430 ; *                                     is detected.
                      00431 ; *
                      00432 ; * Note:            None
                      00433 ; *****************************************************************************/
                      00434 ;void USBCBWakeFromSuspend(void)
00195E                00435 USBCBWakeFromSuspend
                      00436 ;{
                      00437 ;       // If clock switching or other power savings measures were taken when
                      00438 ;       // executing the USBCBSuspend() function, now would be a good time to
                      00439 ;       // switch back to normal full power run mode conditions.  The host allows
                      00440 ;       // a few milliseconds of wakeup time, after which the device must be 
                      00441 ;       // fully back to normal, and capable of receiving and processing USB
                      00442 ;       // packets.  In order to do this, the USB module must receive proper
                      00443 ;       // clocking (IE: 48MHz clock must be available to SIE for full speed USB
                      00444 ;       // operation).
00195E 0012           00445         return
                      00446 ;}
                      00447 
                      00448 ;/********************************************************************
                      00449 ; * Function:        void USBCB_SOF_Handler(void)
                      00450 ; *
                      00451 ; * PreCondition:    None
                      00452 ; *
                      00453 ; * Input:           None
                      00454 ; *
                      00455 ; * Output:          None
                      00456 ; *
                      00457 ; * Side Effects:    None
                      00458 ; *
                      00459 ; * Overview:        The USB host sends out a SOF packet to full-speed
                      00460 ; *                  devices every 1 ms. This interrupt may be useful
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 90


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00461 ; *                  for isochronous pipes. End designers should
                      00462 ; *                  implement callback routine as necessary.
                      00463 ; *
                      00464 ; * Note:            None
                      00465 ; *******************************************************************/
                      00466 ;void USBCB_SOF_Handler(void)
001960                00467 USBCB_SOF_Handler
                      00468 ;{
                      00469 ;    // No need to clear UIRbits.SOFIF to 0 here.
                      00470 ;    // Callback caller is already doing that.
001960 0012           00471         return
                      00472 ;}
                      00473 
                      00474 ;/*******************************************************************
                      00475 ; * Function:        void USBCBErrorHandler(void)
                      00476 ; *
                      00477 ; * PreCondition:    None
                      00478 ; *
                      00479 ; * Input:           None
                      00480 ; *
                      00481 ; * Output:          None
                      00482 ; *
                      00483 ; * Side Effects:    None
                      00484 ; *
                      00485 ; * Overview:        The purpose of this callback is mainly for
                      00486 ; *                  debugging during development. Check UEIR to see
                      00487 ; *                  which error causes the interrupt.
                      00488 ; *
                      00489 ; * Note:            None
                      00490 ; *******************************************************************/
                      00491 ;void USBCBErrorHandler(void)
001962                00492 USBCBErrorHandler
                      00493 ;{
                      00494 ;    // No need to clear UEIR to 0 here.
                      00495 ;    // Callback caller is already doing that.
                      00496 
                      00497 ;       // Typically, user firmware does not need to do anything special
                      00498 ;       // if a USB error occurs.  For example, if the host sends an OUT
                      00499 ;       // packet to your device, but the packet gets corrupted (ex:
                      00500 ;       // because of a bad connection, or the user unplugs the
                      00501 ;       // USB cable during the transmission) this will typically set
                      00502 ;       // one or more USB error interrupt flags.  Nothing specific
                      00503 ;       // needs to be done however, since the SIE will automatically
                      00504 ;       // send a "NAK" packet to the host.  In response to this, the
                      00505 ;       // host will normally retry to send the packet again, and no
                      00506 ;       // data loss occurs.  The system will typically recover
                      00507 ;       // automatically, without the need for application firmware
                      00508 ;       // intervention.
                      00509         
                      00510 ;       // Nevertheless, this callback function is provided, such as
                      00511 ;       // for debugging purposes.
001962 0012           00512         return
                      00513 ;}
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 91


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00514 
                      00515 
                      00516 ;/*******************************************************************
                      00517 ; * Function:        void USBCBCheckOtherReq(void)
                      00518 ; *
                      00519 ; * PreCondition:    None
                      00520 ; *
                      00521 ; * Input:           None
                      00522 ; *
                      00523 ; * Output:          None
                      00524 ; *
                      00525 ; * Side Effects:    None
                      00526 ; *
                      00527 ; * Overview:        When SETUP packets arrive from the host, some
                      00528 ; *                                     firmware must process the request and respond
                      00529 ; *                                     appropriately to fulfill the request.  Some of
                      00530 ; *                                     the SETUP packets will be for standard
                      00531 ; *                                     USB "chapter 9" (as in, fulfilling chapter 9 of
                      00532 ; *                                     the official USB specifications) requests, while
                      00533 ; *                                     others may be specific to the USB device class
                      00534 ; *                                     that is being implemented.  For example, a HID
                      00535 ; *                                     class device needs to be able to respond to
                      00536 ; *                                     "GET REPORT" type of requests.  This
                      00537 ; *                                     is not a standard USB chapter 9 request, and 
                      00538 ; *                                     therefore not handled by usb_device.c.  Instead
                      00539 ; *                                     this request should be handled by class specific 
                      00540 ; *                                     firmware, such as that contained in usb_function_hid.c.
                      00541 ; *
                      00542 ; * Note:            None
                      00543 ; *****************************************************************************/
                      00544 ;void USBCBCheckOtherReq(void)
001964                00545 USBCBCheckOtherReq
                      00546 ;{
                      00547 ;    USBCheckHIDRequest();
001964 D778           00548         bra     USBCheckHIDRequest
                      00549 ;}//end
                      00550 
                      00551 
                      00552 ;/*******************************************************************
                      00553 ; * Function:        void USBCBStdSetDscHandler(void)
                      00554 ; *
                      00555 ; * PreCondition:    None
                      00556 ; *
                      00557 ; * Input:           None
                      00558 ; *
                      00559 ; * Output:          None
                      00560 ; *
                      00561 ; * Side Effects:    None
                      00562 ; *
                      00563 ; * Overview:        The USBCBStdSetDscHandler() callback function is
                      00564 ; *                                     called when a SETUP, bRequest: SET_DESCRIPTOR request
                      00565 ; *                                     arrives.  Typically SET_DESCRIPTOR requests are
                      00566 ; *                                     not used in most applications, and it is
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 92


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00567 ; *                                     optional to support this type of request.
                      00568 ; *
                      00569 ; * Note:            None
                      00570 ; *****************************************************************************/
                      00571 ;void USBCBStdSetDscHandler(void)
001966                00572 USBCBStdSetDscHandler
                      00573 ;{
                      00574 ;    // Must claim session ownership if supporting this request
001966 0012           00575         return
                      00576 ;}//end
                      00577 
                      00578 
                      00579 ;/******************************************************************************
                      00580 ; * Function:        void USBCBInitEP(void)
                      00581 ; *
                      00582 ; * PreCondition:    None
                      00583 ; *
                      00584 ; * Input:           None
                      00585 ; *
                      00586 ; * Output:          None
                      00587 ; *
                      00588 ; * Side Effects:    None
                      00589 ; *
                      00590 ; * Overview:        This function is called when the device becomes
                      00591 ; *                  initialized, which occurs after the host sends a
                      00592 ; *                                     SET_CONFIGURATION (wValue not = 0) request.  This 
                      00593 ; *                                     callback function should initialize the endpoints 
                      00594 ; *                                     for the device's usage according to the current 
                      00595 ; *                                     configuration.
                      00596 ; *
                      00597 ; * Note:            None
                      00598 ; *****************************************************************************/
                      00599 ;void USBCBInitEP(void)
001968                00600 USBCBInitEP
                      00601 ;{
                      00602 ; Enable the HID endpoint
                      00603 ;    USBEnableEndpoint(HID_EP,USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP);
                      00604 ; Enable and configure OUT endpoint
001968 0104           00605         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00196A 0E01           00606         movlw   HID_EP
00196C 6EE9           00607         movwf   FSR0L                   ; Endpoint number
00196E 0E1E           00608         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
001970 6F10           00609         movwf   usb_temp                ; Options
001972 EE14 F0A8      00610         lfsr    1, hid_report_out       ; Endpoint buffer
001976 0E40           00611         movlw   HID_INT_OUT_EP_SIZE     ; Endpoint size
001978 DEEF           00612         rcall   USBEnableEndpointOut
                      00613 
                      00614 ; Enable and configure IN endpoint
00197A 0104           00615         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00197C 0E01           00616         movlw   HID_EP
00197E 6EE9           00617         movwf   FSR0L                   ; Endpoint number
001980 0E1E           00618         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
001982 6F10           00619         movwf   usb_temp                ; Options
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 93


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001984 EE14 F0E9      00620         lfsr    1, hid_report_in        ; Endpoint buffer
001988 0E40           00621         movlw   HID_INT_IN_EP_SIZE      ; Endpoint size
00198A D700           00622         bra     USBEnableEndpointIn
                      00623 ;}
                      00624 
                      00625 ;/********************************************************************
                      00626 ; * Function:        void USBCBSendResume(void)
                      00627 ; *
                      00628 ; * PreCondition:    None
                      00629 ; *
                      00630 ; * Input:           None
                      00631 ; *
                      00632 ; * Output:          None
                      00633 ; *
                      00634 ; * Side Effects:    None
                      00635 ; *
                      00636 ; * Overview:        The USB specifications allow some types of USB
                      00637 ; *                                     peripheral devices to wake up a host PC (such
                      00638 ; *                                     as if it is in a low power suspend to RAM state).
                      00639 ; *                                     This can be a very useful feature in some
                      00640 ; *                                     USB applications, such as an Infrared remote
                      00641 ; *                                     control receiver.  If a user presses the "power"
                      00642 ; *                                     button on a remote control, it is nice that the
                      00643 ; *                                     IR receiver can detect this signalling, and then
                      00644 ; *                                     send a USB "command" to the PC to wake up.
                      00645 ; *                                     
                      00646 ; *                                     The USBCBSendResume() "callback" function is used
                      00647 ; *                                     to send this special USB signalling which wakes 
                      00648 ; *                                     up the PC.  This function may be called by
                      00649 ; *                                     application firmware to wake up the PC.  This
                      00650 ; *                                     function should only be called when:
                      00651 ; *                                     
                      00652 ; *                                     1.  The USB driver used on the host PC supports
                      00653 ; *                                             the remote wakeup capability.
                      00654 ; *                                     2.  The USB configuration descriptor indicates
                      00655 ; *                                             the device is remote wakeup capable in the
                      00656 ; *                                             bmAttributes field.
                      00657 ; *                                     3.  The USB host PC is currently sleeping,
                      00658 ; *                                             and has previously sent your device a SET 
                      00659 ; *                                             FEATURE setup packet which "armed" the
                      00660 ; *                                             remote wakeup capability.   
                      00661 ; *
                      00662 ; *                                     This callback should send a RESUME signal that
                      00663 ; *                  has the period of 1-15ms.
                      00664 ; *
                      00665 ; * Note:            Interrupt vs. Polling
                      00666 ; *                  -Primary clock
                      00667 ; *                  -Secondary clock ***** MAKE NOTES ABOUT THIS *******
                      00668 ; *                   > Can switch to primary first by calling USBCBWakeFromSuspend()
                      00669  
                      00670 ; *                  The modifiable section in this routine should be changed
                      00671 ; *                  to meet the application needs. Current implementation
                      00672 ; *                  temporary blocks other functions from executing for a
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 94


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00673 ; *                  period of 1-13 ms depending on the core frequency.
                      00674 ; *
                      00675 ; *                  According to USB 2.0 specification section 7.1.7.7,
                      00676 ; *                  "The remote wakeup device must hold the resume signaling
                      00677 ; *                  for at lest 1 ms but for no more than 15 ms."
                      00678 ; *                  The idea here is to use a delay counter loop, using a
                      00679 ; *                  common value that would work over a wide range of core
                      00680 ; *                  frequencies.
                      00681 ; *                  That value selected is 1800. See table below:
                      00682 ; *                  ==========================================================
                      00683 ; *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)
                      00684 ; *                  ==========================================================
                      00685 ; *                      48              12          1.05
                      00686 ; *                       4              1           12.6
                      00687 ; *                  ==========================================================
                      00688 ; *                  * These timing could be incorrect when using code
                      00689 ; *                    optimization or extended instruction mode,
                      00690 ; *                    or when having other interrupts enabled.
                      00691 ; *                    Make sure to verify using the MPLAB SIM's Stopwatch
                      00692 ; *                    and verify the actual signal on an oscilloscope.
                      00693 ; *******************************************************************/
                      00694 ;void USBCBSendResume(void)
00198C                00695 USBCBSendResume
                      00696 ;{
00198C 0104           00697         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00698 ;    static WORD delay_count;
                      00699     
                      00700 ;    USBResumeControl = 1;                // Start RESUME signaling
00198E 846D           00701         bsf     UCON, RESUME            ; Start RESUME signaling
                      00702     
                      00703 ;    delay_count = 1800U;                // Set RESUME line for 1-13 ms
                      00704 ;    do
                      00705 ;    {
                      00706 ;        delay_count--;
                      00707 ;    }while(delay_count);
001990 0E10           00708         movlw   0x10                    ; Set RESUME line for 1-13 ms
001992 6EDA           00709         movwf   FSR2H                   ; Using FSR2 as temp
001994 6AD9           00710         clrf    FSR2L
001996                00711 USBCBSendResumeLoop
001996 2ED9           00712         decfsz  FSR2L, F
001998 D7FE           00713         bra     USBCBSendResumeLoop
00199A 2EDA           00714         decfsz  FSR2H, F
00199C D7FC           00715         bra     USBCBSendResumeLoop
                      00716 ;    USBResumeControl = 0;
00199E 946D           00717         bcf     UCON, RESUME
0019A0 0012           00718         return
                      00719 ;}
                      00720 
                      00721 ;/** EOF hid.c ******************************************************/
                      00188 
                      00189 ; ******************************************************************
                      00190 ; This table is polled by the host immediately after USB Reset has been released.
                      00191 ; This table defines the maximum packet size EP0 can take.
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 95


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00192 ; See section 9.6.1 of the Rev 1.0 USB specification.
                      00193 ; These fields are application DEPENDENT. Modify these to meet
                      00194 ; your specifications.
                      00195 ; ******************************************************************
0019A2                00196 DeviceDescriptor
0019A2 0C12           00197         retlw   (EndDeviceDescriptor-DeviceDescriptor)/2        ; bLength Length of this descriptor
0019A4 0C01           00198         retlw   USB_DESCRIPTOR_DEVICE ; bDescType This is a DEVICE descriptor
0019A6 0C10           00199         retlw   0x10            ; bcdUSBUSB Revision 1.10 (low byte)
0019A8 0C01           00200         retlw   0x01            ; high byte
0019AA 0C00           00201         retlw   0x00            ; bDeviceClass zero means each interface operates independently
0019AC 0C00           00202         retlw   0x00            ; bDeviceSubClass
0019AE 0C00           00203         retlw   0x00            ; bDeviceProtocol
0019B0 0C40           00204         retlw   USB_EP0_BUFF_SIZE ; bMaxPacketSize for EP0
                      00205 
                      00206         ; idVendor (low byte, high byte)
0019B2 0CD8           00207         retlw   0xD8
0019B4 0C04           00208         retlw   0x04
                      00209 
                      00210         ; idProduct (low byte, high byte)
0019B6 0C0C           00211         retlw   0x0C
0019B8 0C00           00212         retlw   0x00
                      00213 
0019BA 0C00           00214         retlw   0x00            ; bcdDevice (low byte)
0019BC 0C00           00215         retlw   0x00            ; (high byte)
0019BE 0C01           00216         retlw   0x01            ; iManufacturer (string index)
0019C0 0C02           00217         retlw   0x02            ; iProduct      (string index)
                      00218 
                      00219         ; iSerialNumber (string index)
0019C2 0C03           00220         retlw   0x03
0019C4 0C01           00221         retlw   NUM_CONFIGURATIONS ; bNumConfigurations
0019C6                00222 EndDeviceDescriptor
                      00223 
                      00224 ; ******************************************************************
                      00225 ; This table is retrieved by the host after the address has been set.
                      00226 ; This table defines the configurations available for the device.
                      00227 ; See section 9.6.2 of the Rev 1.0 USB specification (page 184).
                      00228 ; These fields are application DEPENDENT. 
                      00229 ; Modify these to meet your specifications.
                      00230 ; ******************************************************************
                      00231 ; Configuration pointer table
0019C6                00232 USB_CD_Ptr
0019C6                00233 Configs
0019C6 19CA           00234         db      low Config1, high Config1
0019C8 0000           00235         db      upper Config1, 0
                      00236 
                      00237 ; Configuration Descriptor
0019CA                00238 Config1
0019CA 0C09           00239         retlw   (Interface1-Config1)/2  ; bLength Length of this descriptor
0019CC 0C02           00240         retlw   USB_DESCRIPTOR_CONFIGURATION ; bDescType 2=CONFIGURATION
0019CE                00241 Config1Len
0019CE 0C29           00242         retlw   low ((EndConfig1 - Config1)/2)  ; Length of this configuration
0019D0 0C00           00243         retlw   high ((EndConfig1 - Config1)/2)
0019D2 0C01           00244         retlw   0x01            ; bNumInterfaces Number of interfaces
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 96


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0019D4 0C01           00245         retlw   0x01            ; bConfigValue Configuration Value
0019D6 0C00           00246         retlw   0x00            ; iConfig (string index)
0019D8 0CC0           00247         retlw   _DEFAULT|_SELF  ; bmAttributes attributes - bus powered
                      00248 
                      00249         ; Max power consumption (2X mA)
0019DA 0C32           00250         retlw   0x32
0019DC                00251 Interface1
0019DC 0C09           00252         retlw   (HIDDescriptor1-Interface1)/2   ; length of descriptor
0019DE 0C04           00253         retlw   USB_DESCRIPTOR_INTERFACE
0019E0 0C00           00254         retlw   0x00            ; number of interface, 0 based array
0019E2 0C00           00255         retlw   0x00            ; alternate setting
0019E4 0C02           00256         retlw   0x02            ; number of endpoints used in this interface
0019E6 0C03           00257         retlw   0x03            ; interface class - assigned by the USB
0019E8 0C00           00258         retlw   0x00            ; boot device
0019EA 0C00           00259         retlw   0x00            ; interface protocol
0019EC 0C00           00260         retlw   0x00            ; index to string descriptor that describes this interface
0019EE                00261 HIDDescriptor1
0019EE 0C09           00262         retlw   (Endpoint1In-HIDDescriptor1)/2  ; descriptor size (9 bytes)
0019F0 0C21           00263         retlw   DSC_HID         ; descriptor type (HID)
0019F2 0C11           00264         retlw   0x11            ; HID class release number (1.11)
0019F4 0C01           00265         retlw   0x01
0019F6 0C00           00266         retlw   0x00            ; Localized country code (none)
0019F8 0C01           00267         retlw   0x01            ; # of HID class descriptor to follow (1)
0019FA 0C22           00268         retlw   0x22            ; Report descriptor type (HID)
0019FC                00269 ReportDescriptor1Len
0019FC 0C28           00270         retlw   low ((EndReportDescriptor1-ReportDescriptor1)/2)
0019FE 0C00           00271         retlw   high ((EndReportDescriptor1-ReportDescriptor1)/2)
001A00                00272 Endpoint1In
001A00 0C07           00273         retlw   (EndPoint1Out-Endpoint1In)/2    ; length of descriptor
001A02 0C05           00274         retlw   USB_DESCRIPTOR_ENDPOINT
001A04 0C81           00275         retlw   HID_EP|_EP_IN           ; EP1, In
001A06 0C03           00276         retlw   _INT            ; Interrupt
001A08 0C40           00277         retlw   low (HID_INT_IN_EP_SIZE)                ; This should be the size of the endpoint buffer
001A0A 0C00           00278         retlw   high (HID_INT_IN_EP_SIZE)
001A0C 0C0A           00279         retlw   0x0A                        ; Polling interval
001A0E                00280 EndPoint1Out
001A0E 0C07           00281         retlw   (EndConfig1-EndPoint1Out)/2     ; Length of this Endpoint Descriptor
001A10 0C05           00282         retlw   USB_DESCRIPTOR_ENDPOINT         ; bDescriptorType = 5 for Endpoint Descriptor
001A12 0C01           00283         retlw   HID_EP|_EP_OUT          ; Endpoint number & direction
001A14 0C03           00284         retlw   _INT            ; Transfer type supported by this Endpoint
001A16 0C40           00285         retlw   low (HID_INT_OUT_EP_SIZE)               ; This should be the size of the endpoint buffer
001A18 0C00           00286         retlw   high (HID_INT_OUT_EP_SIZE)
001A1A 0C0A           00287         retlw   0x0A                        ; Polling interval
001A1C                00288 EndConfig1
                      00289 
001A1C                00290 ReportDescriptor1
                      00291     ; vendor defined usage page
001A1C 0C06           00292     retlw       0x06            
001A1E 0C00           00293     retlw       0x00
001A20 0CFF           00294     retlw       0xFF
                      00295 
                      00296     ; vendor defined usage
001A22 0C09           00297     retlw       0x09
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 97


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A24 0C00           00298     retlw       0x00
                      00299 
                      00300     ; collection(application)
001A26 0CA1           00301     retlw       0xA1
001A28 0C01           00302     retlw       0x01
                      00303 
                      00304     ; *** INPUT REPORT ***
                      00305 
                      00306     ; vendor defined usage
001A2A 0C09           00307     retlw       0x09
001A2C 0C01           00308     retlw       0x01
                      00309 
001A2E 0C15           00310     retlw       0x15    ; logical minimum (-128)
001A30 0C80           00311     retlw       0x80    ;
001A32 0C25           00312     retlw       0x25    ; logical maximum (127)
001A34 0C7F           00313     retlw       0x7F    ;
001A36 0C35           00314     retlw       0x35    ; Physical Minimum (0)
001A38 0C00           00315     retlw       0x00    ;
001A3A 0C45           00316     retlw       0x45    ; Physical Maximum (255)
001A3C 0CFF           00317     retlw       0xFF    ;
                      00318 
                      00319     ; report size in bits
001A3E 0C75           00320     retlw       0x75
001A40 0C08           00321     retlw       0x08
                      00322 
                      00323     ; report count (number of fields)
001A42 0C95           00324     retlw       0x95
001A44 0C08           00325     retlw       0x08
                      00326 
                      00327     ; Input (Data, Variable, Absolute)
001A46 0C81           00328     retlw       0x81
001A48 0C02           00329     retlw       0x02
                      00330 
                      00331     ; *** OUTPUT REPORT ***
                      00332 
                      00333     ; vendor defined usage
001A4A 0C09           00334     retlw       0x09        ; usage (Vendor Defined)
001A4C 0C02           00335     retlw       0x02        ;
                      00336 
001A4E 0C15           00337     retlw       0x15        ; logical minimum (-128)
001A50 0C80           00338     retlw       0x80        ;
001A52 0C25           00339     retlw       0x25        ; logical maximum (127)
001A54 0C7F           00340     retlw       0x7F        ;
001A56 0C35           00341     retlw       0x35        ; Physical Minimum (0)
001A58 0C00           00342     retlw       0x00        ;
001A5A 0C45           00343     retlw       0x45        ; Physical Maximum (255)
001A5C 0CFF           00344     retlw       0xFF        ;
                      00345 
                      00346     ; report size in bits
001A5E 0C75           00347     retlw       0x75
001A60 0C08           00348     retlw       0x08
                      00349 
                      00350     ; report count (number of fields)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 98


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A62 0C95           00351     retlw       0x95
001A64 0C08           00352     retlw       0x08
                      00353 
                      00354     ; Output (Data, Variable, Absolute)
001A66 0C91           00355     retlw       0x91
001A68 0C02           00356     retlw       0x02
                      00357 
001A6A 0CC0           00358     retlw   0xC0           ; end collection
                      00359 
001A6C                00360 EndReportDescriptor1
                      00361 
                      00362 ; String pointer table
001A6C                00363 USB_SD_Ptr
001A6C                00364 Strings
001A6C 1A7C           00365         db      low String0, high String0
001A6E 0000           00366         db      upper String0, 0
001A70 1A84           00367         db      low String1, high String1
001A72 0000           00368         db      upper String1, 0
001A74 1AA4           00369         db      low String2, high String2
001A76 0000           00370         db      upper String2, 0
001A78 1AC0           00371         db      low String3, high String3
001A7A 0000           00372         db      upper String3, 0
                      00373 
001A7C                00374 String0
001A7C 0C04           00375         retlw   (String1-String0)/2     ; Length of string
001A7E 0C03           00376         retlw   USB_DESCRIPTOR_STRING   ; Descriptor type 3
001A80 0C09           00377         retlw   0x09                    ; Language ID (as defined by MS 0x0409)
001A82 0C04           00378         retlw   0x04
                      00379 
                      00380 ; company name
001A84                00381 String1
001A84 0C10           00382         retlw   (String2-String1)/2
001A86 0C03           00383         retlw   USB_DESCRIPTOR_STRING
                      00384         
001A88 0C68           00385         retlw   'h'
001A8A 0C00           00386         retlw   0x00
001A8C 0C74           00387         retlw   't'
001A8E 0C00           00388         retlw   0x00
001A90 0C67           00389         retlw   'g'
001A92 0C00           00390         retlw   0x00
001A94 0C61           00391         retlw   'a'
001A96 0C00           00392         retlw   0x00
001A98 0C6D           00393         retlw   'm'
001A9A 0C00           00394         retlw   0x00
001A9C 0C65           00395         retlw   'e'
001A9E 0C00           00396         retlw   0x00
001AA0 0C73           00397         retlw   's'
001AA2 0C00           00398         retlw   0x00
                      00399 
                      00400         
                      00401 ; product name  
001AA4                00402 String2
001AA4 0C0E           00403         retlw   (String3-String2)/2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 99


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001AA6 0C03           00404         retlw   USB_DESCRIPTOR_STRING
                      00405         
001AA8 0C70           00406         retlw   'p'
001AAA 0C00           00407         retlw   0x00
001AAC 0C72           00408         retlw   'r'
001AAE 0C00           00409         retlw   0x00
001AB0 0C75           00410         retlw   'u'
001AB2 0C00           00411         retlw   0x00
001AB4 0C65           00412         retlw   'e'
001AB6 0C00           00413         retlw   0x00
001AB8 0C62           00414         retlw   'b'
001ABA 0C00           00415         retlw   0x00
001ABC 0C61           00416         retlw   'a'
001ABE 0C00           00417         retlw   0x00
                      00418 
                      00419 
                      00420 ; serial number
001AC0                00421 String3
001AC0 0C0A           00422         retlw   (String4-String3)/2
001AC2 0C03           00423         retlw   USB_DESCRIPTOR_STRING
                      00424         
001AC4 0C31           00425         retlw   '1'
001AC6 0C00           00426         retlw   0x00
001AC8 0C32           00427         retlw   '2'
001ACA 0C00           00428         retlw   0x00
001ACC 0C33           00429         retlw   '3'
001ACE 0C00           00430         retlw   0x00
001AD0 0C34           00431         retlw   '4'
001AD2 0C00           00432         retlw   0x00
                      00433 
001AD4                00434 String4
                      00435 
                      00436 
                      00437 
                      00438 
                      00439         ENDASM?
                      00440 
                      00441 
                      00442 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\DESCUSBPROJECT.BAS 00283   hid_desc_end
                      00443 
                      00444         LABEL?L _hid_desc_end   
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _hid_desc_end
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 100


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
001AD4                    M _hid_desc_end
                          M     endif
                      00445 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00010   DEFINE OSC 48
                      00446 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00011   DEFINE RESET_ORG 1000h
                      00447 
                      00448 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00013   trisb = %00000000
                      00449         MOVE?CB 000h, TRISB
                          M         CHK?RP  TRISB
                          M     if (((TRISB) & 8000h) != PREV_ALT)
                          M       if ((TRISB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISB) & 8000h
                          M     endif
                          M     if ((((TRISB) & 0fffh) > BANKA_END) & (((TRISB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISB)
                          M PREV_BANK = high (TRISB)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001AD4 6A93               M         clrf    TRISB
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    TRISB
                          M       else
                          M         movlw   low (000h)
                          M         movwf   TRISB
                          M       endif
                          M     endif
                      00450 
                      00451 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00014   portb = %00000000
                      00452         MOVE?CB 000h, PORTB
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 101


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001AD6 6A81               M         clrf    PORTB
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    PORTB
                          M       else
                          M         movlw   low (000h)
                          M         movwf   PORTB
                          M       endif
                          M     endif
                      00453 
                      00454 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00016   trisa = %00000000
                      00455         MOVE?CB 000h, TRISA
                          M         CHK?RP  TRISA
                          M     if (((TRISA) & 8000h) != PREV_ALT)
                          M       if ((TRISA) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISA) & 8000h
                          M     endif
                          M     if ((((TRISA) & 0fffh) > BANKA_END) & (((TRISA) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISA) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISA)
                          M PREV_BANK = high (TRISA)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001AD8 6A92               M         clrf    TRISA
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    TRISA
                          M       else
                          M         movlw   low (000h)
                          M         movwf   TRISA
                          M       endif
                          M     endif
                      00456 
                      00457 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00017   porta = %00000000
                      00458         MOVE?CB 000h, PORTA
                          M         CHK?RP  PORTA
                          M     if (((PORTA) & 8000h) != PREV_ALT)
                          M       if ((PORTA) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTA) & 8000h
                          M     endif
                          M     if ((((PORTA) & 0fffh) > BANKA_END) & (((PORTA) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTA) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTA)
                          M PREV_BANK = high (PORTA)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 102


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001ADA 6A80               M         clrf    PORTA
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    PORTA
                          M       else
                          M         movlw   low (000h)
                          M         movwf   PORTA
                          M       endif
                          M     endif
                      00459 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00019   USBBufferSizeMax   con 8  ' maximum buff
                            er size
                      00460 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00020   USBBufferSizeTX    con 8  ' input
                      00461 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00021   USBBufferSizeRX    con 8  ' output
                      00462 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00029   DEFINE DEBUG_REG PORTA 
                      00463 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00032   DEFINE DEBUG_BIT 0 
                      00464 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00035   DEFINE DEBUG_BAUD 9600
                      00465 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00038   DEFINE DEBUG_MODE 1
                      00466 
                      00467 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00053   pause 500
                      00468         PAUSE?C 001F4h
                          M     if (((001F4h) >> 8) == 0)
                          M         MOVE?CA 001F4h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (001F4h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((001F4h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((001F4h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001ADC 0E01               M         movlw   low ((001F4h) >> 8)
001ADE 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 103


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?CA low (001F4h)
001AE0 0EF4               M         movlw   low (low (001F4h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001AE2 EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00469 
                      00470 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00054   DEbug "B-Olivia ID: 01",13
                      00471         DEBUG?C 042h
001AE6 0E42               M         movlw   042h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 104


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001AE8 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00472         DEBUG?C 02Dh
001AEC 0E2D               M         movlw   02Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001AEE EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00473         DEBUG?C 04Fh
001AF2 0E4F               M         movlw   04Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 105


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001AF4 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00474         DEBUG?C 06Ch
001AF8 0E6C               M         movlw   06Ch
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001AFA EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00475         DEBUG?C 069h
001AFE 0E69               M         movlw   069h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 106


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B00 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00476         DEBUG?C 076h
001B04 0E76               M         movlw   076h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B06 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 107


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00477         DEBUG?C 069h
001B0A 0E69               M         movlw   069h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B0C EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00478         DEBUG?C 061h
001B10 0E61               M         movlw   061h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 108


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((DEBUG) < ($ - 3ffh))
001B12 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00479         DEBUG?C 020h
001B16 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B18 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00480         DEBUG?C 049h
001B1C 0E49               M         movlw   049h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 109


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B1E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00481         DEBUG?C 044h
001B22 0E44               M         movlw   044h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B24 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00482         DEBUG?C 03Ah
001B28 0E3A               M         movlw   03Ah
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 110


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B2A EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00483         DEBUG?C 020h
001B2E 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B30 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00484         DEBUG?C 030h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 111


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B34 0E30               M         movlw   030h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B36 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00485         DEBUG?C 031h
001B3A 0E31               M         movlw   031h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B3C EC03 F008          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 112


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00486         DEBUG?C 00Dh
001B40 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B42 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00487 
                      00488 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00055   debug "ON "
                      00489         DEBUG?C 04Fh
001B46 0E4F               M         movlw   04Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 113


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B48 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00490         DEBUG?C 04Eh
001B4C 0E4E               M         movlw   04Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B4E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00491         DEBUG?C 020h
001B52 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 114


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B54 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00492 
                      00493 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00056   pause 500
                      00494         PAUSE?C 001F4h
                          M     if (((001F4h) >> 8) == 0)
                          M         MOVE?CA 001F4h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (001F4h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((001F4h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((001F4h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001B58 0E01               M         movlw   low ((001F4h) >> 8)
001B5A 6E04               M         movwf   R1 + 1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 115


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M         MOVE?CA low (001F4h)
001B5C 0EF4               M         movlw   low (low (001F4h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001B5E EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00495 
                      00496 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00057   debug "ON",13
                      00497         DEBUG?C 04Fh
001B62 0E4F               M         movlw   04Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 116


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B64 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00498         DEBUG?C 04Eh
001B68 0E4E               M         movlw   04Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B6A EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00499         DEBUG?C 00Dh
001B6E 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 117


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001B70 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00500 
                      00501 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00059   i = 0
                      00502         MOVE?CB 000h, _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001B74 6A22               M         clrf    _i
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _i
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _i
                          M       endif
                          M     endif
                      00503 
                      00504 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00060   sw1 = 0
                      00505         MOVE?CB 000h, _sw1
                          M         CHK?RP  _sw1
                          M     if (((_sw1)  & 8000h) != PREV_ALT)
                          M       if ((_sw1)  & 8000h)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 118


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_sw1)  & 8000h
                          M     endif
                          M     if ((((_sw1)  & 0fffh) > BANKA_END) & (((_sw1)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_sw1)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_sw1)
                          M PREV_BANK = high (_sw1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001B76 6A24               M         clrf    _sw1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _sw1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _sw1
                          M       endif
                          M     endif
                      00506 
                      00507 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00061   pos = 1
                      00508         MOVE?CB 001h, _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _pos
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _pos
                          M       else
001B78 0E01               M         movlw   low (001h)
001B7A 6E23               M         movwf   _pos
                          M       endif
                          M     endif
                      00509 
                      00510 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00064   pause 400
                      00511         PAUSE?C 00190h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 119


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((00190h) >> 8) == 0)
                          M         MOVE?CA 00190h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (00190h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((00190h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((00190h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001B7C 0E01               M         movlw   low ((00190h) >> 8)
001B7E 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (00190h)
001B80 0E90               M         movlw   low (low (00190h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 120


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B82 EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00512 
                      00513 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00065   high portb.3
                      00514         HIGH?T  _PORTB??3
                          M         MOVE?CT 1, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001B86 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001B88 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 121


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00515 
                      00516 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00066   pause 200
                      00517         PAUSE?C 0C8h
                          M     if (((0C8h) >> 8) == 0)
                          M         MOVE?CA 0C8h
001B8A 0EC8               M         movlw   low (0C8h)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001B8C EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (0C8h) >> 8, R1 + 1
                          M         MOVE?CA low (0C8h)
                          M         L?CALL  PAUSEL
                          M     endif
                      00518 
                      00519 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00067   low portb.3
                      00520         LOW?T   _PORTB??3
                          M         MOVE?CT 0, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 122


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     PORTB,  003h
                          M     else
001B90 9681               M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001B92 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00521 
                      00522 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00068   pause 200
                      00523         PAUSE?C 0C8h
                          M     if (((0C8h) >> 8) == 0)
                          M         MOVE?CA 0C8h
001B94 0EC8               M         movlw   low (0C8h)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 123


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001B96 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (0C8h) >> 8, R1 + 1
                          M         MOVE?CA low (0C8h)
                          M         L?CALL  PAUSEL
                          M     endif
                      00524 
                      00525 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00069   high portb.3
                      00526         HIGH?T  _PORTB??3
                          M         MOVE?CT 1, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001B9A 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 124


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001B9C 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00527 
                      00528 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00070   pause 200
                      00529         PAUSE?C 0C8h
                          M     if (((0C8h) >> 8) == 0)
                          M         MOVE?CA 0C8h
001B9E 0EC8               M         movlw   low (0C8h)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001BA0 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (0C8h) >> 8, R1 + 1
                          M         MOVE?CA low (0C8h)
                          M         L?CALL  PAUSEL
                          M     endif
                      00530 
                      00531 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00071   low portb.3
                      00532         LOW?T   _PORTB??3
                          M         MOVE?CT 0, PORTB, 003h
                          M         CHK?RP  PORTB
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 125


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     PORTB,  003h
                          M     else
001BA4 9681               M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001BA6 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00533 
                      00534 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00072   pause 400
                      00535         PAUSE?C 00190h
                          M     if (((00190h) >> 8) == 0)
                          M         MOVE?CA 00190h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (00190h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 126


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((00190h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((00190h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001BA8 0E01               M         movlw   low ((00190h) >> 8)
001BAA 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (00190h)
001BAC 0E90               M         movlw   low (low (00190h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001BAE EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00536 
                      00537 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00073   high portb.3
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 127


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00538         HIGH?T  _PORTB??3
                          M         MOVE?CT 1, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001BB2 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001BB4 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00539 
                      00540 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00074   pause 500
                      00541         PAUSE?C 001F4h
                          M     if (((001F4h) >> 8) == 0)
                          M         MOVE?CA 001F4h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (001F4h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 128


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((001F4h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((001F4h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001BB6 0E01               M         movlw   low ((001F4h) >> 8)
001BB8 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (001F4h)
001BBA 0EF4               M         movlw   low (low (001F4h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001BBC EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 129


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00542 
                      00543 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00075   low portb.3
                      00544         LOW?T   _PORTB??3
                          M         MOVE?CT 0, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     PORTB,  003h
                          M     else
001BC0 9681               M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001BC2 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00545 
                      00546 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00076   pause 700
                      00547         PAUSE?C 002BCh
                          M     if (((002BCh) >> 8) == 0)
                          M         MOVE?CA 002BCh
                          M         L?CALL  PAUSE
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 130


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?CB (002BCh) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((002BCh) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((002BCh) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001BC4 0E02               M         movlw   low ((002BCh) >> 8)
001BC6 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (002BCh)
001BC8 0EBC               M         movlw   low (low (002BCh))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001BCA EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 131


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00548 
                      00549 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00077   high portb.3
                      00550         HIGH?T  _PORTB??3
                          M         MOVE?CT 1, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001BCE 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001BD0 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00551 
                      00552 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00078   high portb.2
                      00553         HIGH?T  _PORTB??2
                          M         MOVE?CT 1, PORTB, 002h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 132


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001BD2 8481               M         bsf     PORTB,  002h
                          M     else
                          M         bcf     PORTB,  002h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 002h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 002h
                          M     else
001BD4 9493               M         bcf     ((PORTB) + 12h), 002h
                          M     endif
                      00554 
                      00555 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00079   pause 700
                      00556         PAUSE?C 002BCh
                          M     if (((002BCh) >> 8) == 0)
                          M         MOVE?CA 002BCh
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (002BCh) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 133


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((002BCh) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((002BCh) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001BD6 0E02               M         movlw   low ((002BCh) >> 8)
001BD8 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (002BCh)
001BDA 0EBC               M         movlw   low (low (002BCh))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001BDC EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00557 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 134


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00558 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00086   usbinit ' initialise USB...
                      00559         USBINIT?        
                          M   ifdef USE_USB_BUS_SENSE_IO
                          M         tris_usb_bus_sense = 1  ; Set to input
                          M   endif
                          M   ifdef USE_SELF_POWER_SENSE_IO
                          M         tris_self_power = 1     ; Set to input
                          M   endif
                          M         L?CALL  USBDeviceInit   ; Finish initialization
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceInit
                          M     else
                          M       if ((USBDeviceInit) < 1)
                          M         call    USBDeviceInit
                          M       else
                          M         if ((USBDeviceInit) > $)
                          M         call    USBDeviceInit
                          M         else
                          M           if ((USBDeviceInit) < ($ - 3ffh))
001BE0 ECBB F008          M         call    USBDeviceInit
                          M           else
                          M         rcall   USBDeviceInit
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 135


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
001BE4 ECB6 F008          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00560 
                      00561 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00088   low portb.3
                      00562         LOW?T   _PORTB??3
                          M         MOVE?CT 0, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     PORTB,  003h
                          M     else
001BE8 9681               M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 136


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
001BEA 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00563 
                      00564 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00089   low portb.2
                      00565         LOW?T   _PORTB??2
                          M         MOVE?CT 0, PORTB, 002h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     PORTB,  002h
                          M     else
001BEC 9481               M         bcf     PORTB,  002h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 002h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 002h
                          M     else
001BEE 9493               M         bcf     ((PORTB) + 12h), 002h
                          M     endif
                      00566 
                      00567 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00090   pause 500
                      00568         PAUSE?C 001F4h
                          M     if (((001F4h) >> 8) == 0)
                          M         MOVE?CA 001F4h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 137


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (001F4h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((001F4h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((001F4h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001BF0 0E01               M         movlw   low ((001F4h) >> 8)
001BF2 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (001F4h)
001BF4 0EF4               M         movlw   low (low (001F4h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001BF6 EC41 F008          M         call    PAUSEL
                          M           else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 138


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00569 
                      00570 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00091   high portb.3
                      00571         HIGH?T  _PORTB??3
                          M         MOVE?CT 1, PORTB, 003h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001BFA 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 003h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 003h
                          M     else
001BFC 9693               M         bcf     ((PORTB) + 12h), 003h
                          M     endif
                      00572 
                      00573 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00092   high portb.2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 139


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00574         HIGH?T  _PORTB??2
                          M         MOVE?CT 1, PORTB, 002h
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((1)   & 1) == 1)
001BFE 8481               M         bsf     PORTB,  002h
                          M     else
                          M         bcf     PORTB,  002h
                          M     endif
                          M         MOVE?CT 0, ((PORTB) + 12h), 002h
                          M         CHK?RP  ((PORTB) + 12h)
                          M     if (((((PORTB) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTB) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTB) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTB) + 12h)) & 0fffh) > BANKA_END) & (((((PORTB) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTB) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTB) + 12h))
                          M PREV_BANK = high (((PORTB) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTB) + 12h), 002h
                          M     else
001C00 9493               M         bcf     ((PORTB) + 12h), 002h
                          M     endif
                      00575 
                      00576 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00093   pause 500
                      00577         PAUSE?C 001F4h
                          M     if (((001F4h) >> 8) == 0)
                          M         MOVE?CA 001F4h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (001F4h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 140


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((001F4h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((001F4h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001C02 0E01               M         movlw   low ((001F4h) >> 8)
001C04 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (001F4h)
001C06 0EF4               M         movlw   low (low (001F4h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001C08 EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 141


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00578 
                      00579 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00097   gosub DoUSBIn
                      00580         GOSUB?L _DoUSBIn
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBIn
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBIn
                          M     else
                          M       if ((_DoUSBIn) < 1)
                          M         call    _DoUSBIn
                          M       else
                          M         if ((_DoUSBIn) > $)
001C0C ECA5 F011          M         call    _DoUSBIn
                          M         else
                          M           if ((_DoUSBIn) < ($ - 3ffh))
                          M         call    _DoUSBIn
                          M           else
                          M         rcall   _DoUSBIn
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001C10                    M dlabel
                      00581 
                      00582 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00105   ProgramStart:
                      00583 
                      00584         LABEL?L _ProgramStart   
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 142


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _ProgramStart
                          M         XALL
                          M     else
001C10                    M _ProgramStart
                          M     endif
                      00585 
                      00586 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00106      portb.1 = 1 
                      00587         MOVE?CT 001h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001C10 8281               M         bsf     PORTB,  001h
                          M     else
                          M         bcf     PORTB,  001h
                          M     endif
                      00588 
                      00589 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00107      pause 10
                      00590         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C12 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 143


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001C14 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00591 
                      00592 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00108      gosub DoUSBIn 
                      00593         GOSUB?L _DoUSBIn
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBIn
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 144


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBIn
                          M     else
                          M       if ((_DoUSBIn) < 1)
                          M         call    _DoUSBIn
                          M       else
                          M         if ((_DoUSBIn) > $)
001C18 ECA5 F011          M         call    _DoUSBIn
                          M         else
                          M           if ((_DoUSBIn) < ($ - 3ffh))
                          M         call    _DoUSBIn
                          M           else
                          M         rcall   _DoUSBIn
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001C1C                    M dlabel
                      00594 
                      00595 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00109      portb.1 = 0
                      00596         MOVE?CT 000h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  001h
                          M     else
001C1C 9281               M         bcf     PORTB,  001h
                          M     endif
                      00597 
                      00598 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00110      pause 10
                      00599         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C1E 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 145


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001C20 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00600 
                      00601 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00111      portb.1 = 1
                      00602         MOVE?CT 001h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001C24 8281               M         bsf     PORTB,  001h
                          M     else
                          M         bcf     PORTB,  001h
                          M     endif
                      00603 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 146


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00604 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00112      pause 10
                      00605         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C26 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001C28 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00606 
                      00607 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00113      portb.1 = 0
                      00608         MOVE?CT 000h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 147


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  001h
                          M     else
001C2C 9281               M         bcf     PORTB,  001h
                          M     endif
                      00609 
                      00610 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00114      pause 10
                      00611         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C2E 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001C30 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00612 
                      00613 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00115      portb.1 = 1
                      00614         MOVE?CT 001h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 148


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001C34 8281               M         bsf     PORTB,  001h
                          M     else
                          M         bcf     PORTB,  001h
                          M     endif
                      00615 
                      00616 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00116      pause 10
                      00617         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C36 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
001C38 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 149


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00618 
                      00619 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00117      portb.1 = 0
                      00620         MOVE?CT 000h, _PORTB??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  001h
                          M     else
001C3C 9281               M         bcf     PORTB,  001h
                          M     endif
                      00621 
                      00622 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00118      pause 10
                      00623         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
001C3E 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 150


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001C40 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00624 
                      00625 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00120      for i = 0 to  7
                      00626         MOVE?CB 000h, _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001C44 6A22               M         clrf    _i
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _i
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _i
                          M       endif
                          M     endif
                      00627         LABEL?L L00009  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00009
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 151


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
001C46                    M L00009
                          M     endif
                      00628         CMPGT?BCL       _i, 007h, L00010
                          M     if ((007h) < 0)
                          M         L?GOTO  L00010
                          M     else
                          M       if ((007h) < 0ffh)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001C46 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (007h) + 1
001C48 0E08               M         movlw   low ((007h) + 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001C4A 5C22               M         subwf   _i,  W
                          M         BIT?GOTO 1, STATUS, C, L00010
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00010))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00010
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 152


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((L00010) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00010
                          M         else
                          M           if ((L00010) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00010
                          M           else
                          M             if ((L00010) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00010
                          M             else
                          M         bov     L00010
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
001C4C B0D8               M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00010
                          M       else
                          M         if ((L00010) < 1)
                          M         goto    L00010
                          M         else
                          M           if ((L00010) > $)
001C4E EF40 F00E          M         goto    L00010
                          M           else
                          M             if ((L00010) < ($ - 3ffh))
                          M         goto    L00010
                          M             else
                          M         bra     L00010
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 153


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00629 
                      00630 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00121        usbbufferaux[i+1] =  usbbuffer[i]
                      00631         ADD?BCW _i, 001h, T2
                          M     if ((001h) == 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001C52 2822               M         incf    _i,  W
                          M     else
                          M         movlw   low (001h)
                          M         CHK?RP  _i
                          M         addwf   _i,  W
                          M     endif
                          M         MOVE?AW T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001C54 6E15               M         movwf   T2
001C56 6A16               M         clrf    (T2)   + 1
                          M     if (((001h) >> 8) == 0)
001C58 3616               M         rlcf    (T2)   + 1, F
                          M     else
                          M         movlw   (001h) >> 8
                          M         addwfc  (T2)   + 1, F
                          M     endif
                      00632         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 154


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001C5A 5022               M         movf    _i,  W
001C5C 0F28               M         addlw   low (_USBBuffer)
001C5E 6EE9               M         movwf   FSR0L
001C60 0E00               M         movlw   (_USBBuffer) >> 8
001C62 6AEA               M         clrf    FSR0H
001C64 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
001C66 CFEF F013          M         movff   INDF0, T1
                      00633         AIN?BBW T1, _USBBufferaux, T2
                          M         MOVE?WA T2
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001C6A 5015               M         movf    T2,  W
001C6C 0F30               M         addlw   low (_USBBufferaux)
001C6E 6EE9               M         movwf   FSR0L
001C70 0E00               M         movlw   (_USBBufferaux) >> 8
001C72 2016               M         addwfc  (T2)   + 1, W
001C74 6EEA               M         movwf   FSR0H
                          M         MOVE?BB T1,  INDF0
001C76 C013 FFEF          M         movff   T1,  INDF0
                      00634 
                      00635 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00122      next
                      00636         NEXT?BCL        _i, 001h, L00009
                          M     if ((001h) == 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 155


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001C7A 2A22               M         incf    _i,  F
                          M     else
                          M         movlw   001h
                          M         CHK?RP  _i
                          M         addwf   _i,  F
                          M     endif
                          M     if ((001h) <= 255)
                          M         BIT?GOTO 0, STATUS, C, L00009
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00009))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M       else
                          M         if ((L00009) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M         else
                          M           if ((L00009) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M           else
                          M             if ((L00009) < ($ - 7fh))
                          M         btfsc   STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 156


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00009
                          M             else
                          M         bov     L00009
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001C7C A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00009
                          M       else
                          M         if ((L00009) < 1)
                          M         goto    L00009
                          M         else
                          M           if ((L00009) > $)
                          M         goto    L00009
                          M           else
                          M             if ((L00009) < ($ - 3ffh))
                          M         goto    L00009
                          M             else
001C7E D7E3               M         bra     L00009
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00637         LABEL?L L00010  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 157


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M L00010
                          M         XALL
                          M     else
001C80                    M L00010
                          M     endif
                      00638 
                      00639 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00123      pos = usbbufferaux[pos]
                      00640         AOUT?BBB        _USBBufferaux, _pos, _pos
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001C80 5023               M         movf    _pos, W
001C82 0F30               M         addlw   low (_USBBufferaux)
001C84 6EE9               M         movwf   FSR0L
001C86 0E00               M         movlw   (_USBBufferaux) >> 8
001C88 6AEA               M         clrf    FSR0H
001C8A 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, _pos
001C8C CFEF F023          M         movff   INDF0, _pos
                      00641 
                      00642 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00124      while (pos > 8)
                      00643         LABEL?L L00011  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00011
                          M         XALL
                          M     else
001C90                    M L00011
                          M     endif
                      00644         CMPLE?BCL       _pos, 008h, L00012
                          M     if ((008h) >= 0ffh)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 158


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         L?GOTO  L00012
                          M     else
                          M       if ((008h) >= 0)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001C90 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (008h) + 1
001C92 0E09               M         movlw   low ((008h) + 1)
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001C94 5C23               M         subwf   _pos, W
                          M         BIT?GOTO 0, STATUS, C, L00012
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00012))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00012
                          M       else
                          M         if ((L00012) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00012
                          M         else
                          M           if ((L00012) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 159


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00012
                          M           else
                          M             if ((L00012) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00012
                          M             else
                          M         bov     L00012
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001C96 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00012
                          M       else
                          M         if ((L00012) < 1)
                          M         goto    L00012
                          M         else
                          M           if ((L00012) > $)
001C98 EF51 F00E          M         goto    L00012
                          M           else
                          M             if ((L00012) < ($ - 3ffh))
                          M         goto    L00012
                          M             else
                          M         bra     L00012
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
                      00645 
                      00646 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00125        pos = pos - 8
                      00647         SUB?BCB _pos, 008h, _pos
                          M     if ((_pos) == (_pos))
                          M       if ((008h) == 1)
                          M         CHK?RP  _pos
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 160


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         decf    _pos, F
                          M       else
001C9C 0E08               M         movlw   008h
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001C9E 5E23               M         subwf   _pos, F
                          M       endif
                          M     else
                          M       if ((008h) == 1)
                          M         CHK?RP  _pos
                          M         decf    _pos, W
                          M       else
                          M         movlw   008h
                          M         CHK?RP  _pos
                          M         subwf   _pos, W
                          M       endif
                          M         MOVE?AB _pos
                          M     endif
                      00648 
                      00649 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00126      wend  
                      00650         GOTO?L  L00011
                          M         L?GOTO  L00011
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00011))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 161


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         goto    L00011
                          M     else
                          M       if ((L00011) < 1)
                          M         goto    L00011
                          M       else
                          M         if ((L00011) > $)
                          M         goto    L00011
                          M         else
                          M           if ((L00011) < ($ - 3ffh))
                          M         goto    L00011
                          M           else
001CA0 D7F7               M         bra     L00011
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00651         LABEL?L L00012  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00012
                          M         XALL
                          M     else
001CA2                    M L00012
                          M     endif
                      00652 
                      00653 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00130      if ((usbbuffer[0] = 3)and (usbbuffer[
                            1] = 255) and (usbbuffer[1] = 255)) then
                      00654         CMPEQ?BCB       _USBBuffer, 003h, T1
                          M     if (((003h) > -100h) & ((003h) < 100h))
                          M         MOVE?BA _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 162


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001CA2 5028               M         movf    _USBBuffer, W
001CA4 0803               M         sublw   003h
001CA6 A4D8               M         btfss   STATUS, Z
001CA8 68E8               M         setf    WREG
001CAA 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001CAC 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00655         CMPEQ?BCB       _USBBuffer + 00001h, 0FFh, T2
                          M     if (((0FFh) > -100h) & ((0FFh) < 100h))
                          M         MOVE?BA _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
001CAE 5029               M         movf    _USBBuffer + 00001h, W
001CB0 08FF               M         sublw   0FFh
001CB2 A4D8               M         btfss   STATUS, Z
001CB4 68E8               M         setf    WREG
001CB6 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 163


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001CB8 6E15               M         movwf   T2
                          M     else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M     endif
                      00656         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001CBA C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001CBE 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 164


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001CC0 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001CC4 6E15               M         movwf   T2
001CC6 6E16               M         movwf   T2   + 1
                      00657         CMPEQ?BCB       _USBBuffer + 00001h, 0FFh, T3
                          M     if (((0FFh) > -100h) & ((0FFh) < 100h))
                          M         MOVE?BA _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
001CC8 5029               M         movf    _USBBuffer + 00001h, W
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 165


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001CCA 08FF               M         sublw   0FFh
001CCC A4D8               M         btfss   STATUS, Z
001CCE 68E8               M         setf    WREG
001CD0 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001CD2 6E17               M         movwf   T3
                          M     else
                          M         CHK?RP  T3
                          M         clrf    T3
                          M     endif
                      00658         LAND?WBW        T2, T3, T3
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001CD4 5015               M         movf    T2,  W
001CD6 1016               M         iorwf   T2  + 1, W
001CD8 6E01               M         movwf   R0
                          M         MOVE?BA T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 166


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001CDA 5017               M         movf    T3,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001CDC EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 167


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001CE0 6E17               M         movwf   T3
001CE2 6E18               M         movwf   T3   + 1
                      00659         CMPF?WL T3, L00013
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001CE4 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001CE6 5017               M         movf    T3,  W
001CE8 1018               M         iorwf   (T3)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00013
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00013))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M       else
                          M         if ((L00013) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M         else
                          M           if ((L00013) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 168


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M           else
                          M             if ((L00013) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M             else
                          M         bov     L00013
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001CEA B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00013
                          M       else
                          M         if ((L00013) < 1)
                          M         goto    L00013
                          M         else
                          M           if ((L00013) > $)
001CEC EF7E F00E          M         goto    L00013
                          M           else
                          M             if ((L00013) < ($ - 3ffh))
                          M         goto    L00013
                          M             else
                          M         bra     L00013
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00660 
                      00661 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00131        portb.3 = 1
                      00662         MOVE?CT 001h, _PORTB??3
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 169


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001CF0 8681               M         bsf     PORTB,  003h
                          M     else
                          M         bcf     PORTB,  003h
                          M     endif
                      00663 
                      00664 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00132        pause 1000
                      00665         PAUSE?C 003E8h
                          M     if (((003E8h) >> 8) == 0)
                          M         MOVE?CA 003E8h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (003E8h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((003E8h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((003E8h) >> 8) == 255)
                          M         setf    R1 + 1
                          M       else
001CF2 0E03               M         movlw   low ((003E8h) >> 8)
001CF4 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (003E8h)
001CF6 0EE8               M         movlw   low (low (003E8h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 170


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001CF8 EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00666 
                      00667 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00133      endif
                      00668         LABEL?L L00013  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00013
                          M         XALL
                          M     else
001CFC                    M L00013
                          M     endif
                      00669 
                      00670 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00134      if ((usbbuffer[0] = 3)and (usbbuffer[
                            1] = 254)and (usbbuffer[1] = 254)) then
                      00671         CMPEQ?BCB       _USBBuffer, 003h, T1
                          M     if (((003h) > -100h) & ((003h) < 100h))
                          M         MOVE?BA _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 171


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
                          M       endif
                          M     endif
001CFC 5028               M         movf    _USBBuffer, W
001CFE 0803               M         sublw   003h
001D00 A4D8               M         btfss   STATUS, Z
001D02 68E8               M         setf    WREG
001D04 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001D06 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00672         CMPEQ?BCB       _USBBuffer + 00001h, 0FEh, T2
                          M     if (((0FEh) > -100h) & ((0FEh) < 100h))
                          M         MOVE?BA _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 172


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
001D08 5029               M         movf    _USBBuffer + 00001h, W
001D0A 08FE               M         sublw   0FEh
001D0C A4D8               M         btfss   STATUS, Z
001D0E 68E8               M         setf    WREG
001D10 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001D12 6E15               M         movwf   T2
                          M     else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M     endif
                      00673         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001D14 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001D18 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 173


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001D1A EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001D1E 6E15               M         movwf   T2
001D20 6E16               M         movwf   T2   + 1
                      00674         CMPEQ?BCB       _USBBuffer + 00001h, 0FEh, T3
                          M     if (((0FEh) > -100h) & ((0FEh) < 100h))
                          M         MOVE?BA _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 174


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
001D22 5029               M         movf    _USBBuffer + 00001h, W
001D24 08FE               M         sublw   0FEh
001D26 A4D8               M         btfss   STATUS, Z
001D28 68E8               M         setf    WREG
001D2A 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001D2C 6E17               M         movwf   T3
                          M     else
                          M         CHK?RP  T3
                          M         clrf    T3
                          M     endif
                      00675         LAND?WBW        T2, T3, T3
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 175


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001D2E 5015               M         movf    T2,  W
001D30 1016               M         iorwf   T2  + 1, W
001D32 6E01               M         movwf   R0
                          M         MOVE?BA T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001D34 5017               M         movf    T3,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001D36 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 176


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001D3A 6E17               M         movwf   T3
001D3C 6E18               M         movwf   T3   + 1
                      00676         CMPF?WL T3, L00015
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001D3E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T3
                          M         CHK?RP  T3
                          M     if (((T3)    & 8000h) != PREV_ALT)
                          M       if ((T3)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T3)    & 8000h
                          M     endif
                          M     if ((((T3)    & 0fffh) > BANKA_END) & (((T3)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T3)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T3)
                          M PREV_BANK = high (T3)
                          M       endif
                          M     endif
001D40 5017               M         movf    T3,  W
001D42 1018               M         iorwf   (T3)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00015
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00015))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 177


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M       else
                          M         if ((L00015) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M         else
                          M           if ((L00015) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M           else
                          M             if ((L00015) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M             else
                          M         bov     L00015
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001D44 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00015
                          M       else
                          M         if ((L00015) < 1)
                          M         goto    L00015
                          M         else
                          M           if ((L00015) > $)
001D46 EFAB F00E          M         goto    L00015
                          M           else
                          M             if ((L00015) < ($ - 3ffh))
                          M         goto    L00015
                          M             else
                          M         bra     L00015
                          M             endif
                          M           endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 178


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     endif
                      00677 
                      00678 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00135        portb.3 = 0
                      00679         MOVE?CT 000h, _PORTB??3
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  003h
                          M     else
001D4A 9681               M         bcf     PORTB,  003h
                          M     endif
                      00680 
                      00681 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00136        pause 1000
                      00682         PAUSE?C 003E8h
                          M     if (((003E8h) >> 8) == 0)
                          M         MOVE?CA 003E8h
                          M         L?CALL  PAUSE
                          M     else
                          M         MOVE?CB (003E8h) >> 8, R1 + 1
                          M         CHK?RP  R1 + 1
                          M     if (((R1 + 1) & 8000h) != PREV_ALT)
                          M       if ((R1 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1 + 1) & 8000h
                          M     endif
                          M     if ((((R1 + 1) & 0fffh) > BANKA_END) & (((R1 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1 + 1)
                          M PREV_BANK = high (R1 + 1)
                          M       endif
                          M     endif
                          M     if (low ((003E8h) >> 8) == 0)
                          M         clrf    R1 + 1
                          M     else
                          M       if (low ((003E8h) >> 8) == 255)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 179


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         setf    R1 + 1
                          M       else
001D4C 0E03               M         movlw   low ((003E8h) >> 8)
001D4E 6E04               M         movwf   R1 + 1
                          M       endif
                          M     endif
                          M         MOVE?CA low (003E8h)
001D50 0EE8               M         movlw   low (low (003E8h))
                          M         L?CALL  PAUSEL
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEL
                          M     else
                          M       if ((PAUSEL) < 1)
                          M         call    PAUSEL
                          M       else
                          M         if ((PAUSEL) > $)
                          M         call    PAUSEL
                          M         else
                          M           if ((PAUSEL) < ($ - 3ffh))
001D52 EC41 F008          M         call    PAUSEL
                          M           else
                          M         rcall   PAUSEL
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00683 
                      00684 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00137      endif 
                      00685         LABEL?L L00015  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00015
                          M         XALL
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 180


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
001D56                    M L00015
                          M     endif
                      00686 
                      00687 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00148      temp = usbbuffer[0]
                      00688         MOVE?BB _USBBuffer, _temp
001D56 C028 F025          M         movff   _USBBuffer, _temp
                      00689 
                      00690 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00150      debug "Dato USB HOST recibido... ",13
                               
                      00691         DEBUG?C 044h
001D5A 0E44               M         movlw   044h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D5C EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00692         DEBUG?C 061h
001D60 0E61               M         movlw   061h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 181


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D62 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00693         DEBUG?C 074h
001D66 0E74               M         movlw   074h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D68 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00694         DEBUG?C 06Fh
001D6C 0E6F               M         movlw   06Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 182


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D6E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00695         DEBUG?C 020h
001D72 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D74 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 183


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00696         DEBUG?C 055h
001D78 0E55               M         movlw   055h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D7A EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00697         DEBUG?C 053h
001D7E 0E53               M         movlw   053h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 184


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((DEBUG) < ($ - 3ffh))
001D80 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00698         DEBUG?C 042h
001D84 0E42               M         movlw   042h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D86 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00699         DEBUG?C 020h
001D8A 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 185


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D8C EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00700         DEBUG?C 048h
001D90 0E48               M         movlw   048h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D92 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00701         DEBUG?C 04Fh
001D96 0E4F               M         movlw   04Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 186


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D98 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00702         DEBUG?C 053h
001D9C 0E53               M         movlw   053h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001D9E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00703         DEBUG?C 054h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 187


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001DA2 0E54               M         movlw   054h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DA4 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00704         DEBUG?C 020h
001DA8 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DAA EC03 F008          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 188


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00705         DEBUG?C 072h
001DAE 0E72               M         movlw   072h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DB0 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00706         DEBUG?C 065h
001DB4 0E65               M         movlw   065h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 189


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DB6 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00707         DEBUG?C 063h
001DBA 0E63               M         movlw   063h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DBC EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00708         DEBUG?C 069h
001DC0 0E69               M         movlw   069h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 190


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DC2 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00709         DEBUG?C 062h
001DC6 0E62               M         movlw   062h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DC8 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00710         DEBUG?C 069h
001DCC 0E69               M         movlw   069h
                          M         L?CALL  DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 191


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DCE EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00711         DEBUG?C 064h
001DD2 0E64               M         movlw   064h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DD4 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 192


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00712         DEBUG?C 06Fh
001DD8 0E6F               M         movlw   06Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DDA EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00713         DEBUG?C 02Eh
001DDE 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 193


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DE0 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00714         DEBUG?C 02Eh
001DE4 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DE6 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00715         DEBUG?C 02Eh
001DEA 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 194


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DEC EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00716         DEBUG?C 020h
001DF0 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DF2 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00717         DEBUG?C 00Dh
001DF6 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 195


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001DF8 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00718 
                      00719 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00151      for i = 0 to 7
                      00720         MOVE?CB 000h, _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001DFC 6A22               M         clrf    _i
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _i
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _i
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 196


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00721         LABEL?L L00017  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00017
                          M         XALL
                          M     else
001DFE                    M L00017
                          M     endif
                      00722         CMPGT?BCL       _i, 007h, L00018
                          M     if ((007h) < 0)
                          M         L?GOTO  L00018
                          M     else
                          M       if ((007h) < 0ffh)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001DFE 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (007h) + 1
001E00 0E08               M         movlw   low ((007h) + 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001E02 5C22               M         subwf   _i,  W
                          M         BIT?GOTO 1, STATUS, C, L00018
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00018))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 197


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00018
                          M       else
                          M         if ((L00018) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00018
                          M         else
                          M           if ((L00018) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00018
                          M           else
                          M             if ((L00018) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00018
                          M             else
                          M         bov     L00018
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
001E04 B0D8               M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00018
                          M       else
                          M         if ((L00018) < 1)
                          M         goto    L00018
                          M         else
                          M           if ((L00018) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 198


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001E06 EF1D F011          M         goto    L00018
                          M           else
                          M             if ((L00018) < ($ - 3ffh))
                          M         goto    L00018
                          M             else
                          M         bra     L00018
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
                      00723 
                      00724 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00155        aux = i
                      00725         MOVE?BB _i, _aux
001E0A C022 F021          M         movff   _i,  _aux
                      00726 
                      00727 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00160        if pos = 1 then      
                      00728         CMPNE?BCL       _pos, 001h, L00019
                          M     if (((001h) > -100h) & ((001h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E0E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E10 5023               M         movf    _pos, W
001E12 0801               M         sublw   001h
                          M         BIT?GOTO 0, STATUS, Z, L00019
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00019))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 199


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M       else
                          M         if ((L00019) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M         else
                          M           if ((L00019) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M           else
                          M             if ((L00019) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M             else
                          M         bov     L00019
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E14 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00019
                          M       else
                          M         if ((L00019) < 1)
                          M         goto    L00019
                          M         else
                          M           if ((L00019) > $)
001E16 EF0F F00F          M         goto    L00019
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 200


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M             if ((L00019) < ($ - 3ffh))
                          M         goto    L00019
                          M             else
                          M         bra     L00019
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00019
                          M     endif
                      00729 
                      00730 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00161          gosub buscar1
                      00731         GOSUB?L _buscar1
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar1
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar1
                          M     else
                          M       if ((_buscar1) < 1)
                          M         call    _buscar1
                          M       else
                          M         if ((_buscar1) > $)
001E1A ECEA F011          M         call    _buscar1
                          M         else
                          M           if ((_buscar1) < ($ - 3ffh))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 201


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    _buscar1
                          M           else
                          M         rcall   _buscar1
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E1E                    M dlabel
                      00732 
                      00733 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00162        endif
                      00734         LABEL?L L00019  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00019
                          M         XALL
                          M     else
001E1E                    M L00019
                          M     endif
                      00735 
                      00736 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00163        if pos = 2 then      
                      00737         CMPNE?BCL       _pos, 002h, L00021
                          M     if (((002h) > -100h) & ((002h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E1E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E20 5023               M         movf    _pos, W
001E22 0802               M         sublw   002h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 202


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         BIT?GOTO 0, STATUS, Z, L00021
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00021))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M       else
                          M         if ((L00021) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M         else
                          M           if ((L00021) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M           else
                          M             if ((L00021) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M             else
                          M         bov     L00021
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E24 A4D8               M         btfss   STATUS, Z
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 203


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00021
                          M       else
                          M         if ((L00021) < 1)
                          M         goto    L00021
                          M         else
                          M           if ((L00021) > $)
001E26 EF17 F00F          M         goto    L00021
                          M           else
                          M             if ((L00021) < ($ - 3ffh))
                          M         goto    L00021
                          M             else
                          M         bra     L00021
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00021
                          M     endif
                      00738 
                      00739 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00164          gosub buscar2
                      00740         GOSUB?L _buscar2
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar2
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 204


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         call    _buscar2
                          M     else
                          M       if ((_buscar2) < 1)
                          M         call    _buscar2
                          M       else
                          M         if ((_buscar2) > $)
001E2A EC09 F012          M         call    _buscar2
                          M         else
                          M           if ((_buscar2) < ($ - 3ffh))
                          M         call    _buscar2
                          M           else
                          M         rcall   _buscar2
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E2E                    M dlabel
                      00741 
                      00742 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00165        endif
                      00743         LABEL?L L00021  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00021
                          M         XALL
                          M     else
001E2E                    M L00021
                          M     endif
                      00744 
                      00745 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00166        if pos = 3 then      
                      00746         CMPNE?BCL       _pos, 003h, L00023
                          M     if (((003h) > -100h) & ((003h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E2E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 205


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E30 5023               M         movf    _pos, W
001E32 0803               M         sublw   003h
                          M         BIT?GOTO 0, STATUS, Z, L00023
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00023))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M       else
                          M         if ((L00023) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M         else
                          M           if ((L00023) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M           else
                          M             if ((L00023) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M             else
                          M         bov     L00023
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 206


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E34 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00023
                          M       else
                          M         if ((L00023) < 1)
                          M         goto    L00023
                          M         else
                          M           if ((L00023) > $)
001E36 EF1F F00F          M         goto    L00023
                          M           else
                          M             if ((L00023) < ($ - 3ffh))
                          M         goto    L00023
                          M             else
                          M         bra     L00023
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00023
                          M     endif
                      00747 
                      00748 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00167          gosub buscar3
                      00749         GOSUB?L _buscar3
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar3
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 207


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar3
                          M     else
                          M       if ((_buscar3) < 1)
                          M         call    _buscar3
                          M       else
                          M         if ((_buscar3) > $)
001E3A EC28 F012          M         call    _buscar3
                          M         else
                          M           if ((_buscar3) < ($ - 3ffh))
                          M         call    _buscar3
                          M           else
                          M         rcall   _buscar3
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E3E                    M dlabel
                      00750 
                      00751 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00168        endif
                      00752         LABEL?L L00023  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00023
                          M         XALL
                          M     else
001E3E                    M L00023
                          M     endif
                      00753 
                      00754 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00169        if pos = 4 then      
                      00755         CMPNE?BCL       _pos, 004h, L00025
                          M     if (((004h) > -100h) & ((004h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 208


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001E3E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E40 5023               M         movf    _pos, W
001E42 0804               M         sublw   004h
                          M         BIT?GOTO 0, STATUS, Z, L00025
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00025))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M       else
                          M         if ((L00025) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M         else
                          M           if ((L00025) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M           else
                          M             if ((L00025) < ($ - 7fh))
                          M         btfsc   STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 209


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00025
                          M             else
                          M         bov     L00025
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E44 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00025
                          M       else
                          M         if ((L00025) < 1)
                          M         goto    L00025
                          M         else
                          M           if ((L00025) > $)
001E46 EF27 F00F          M         goto    L00025
                          M           else
                          M             if ((L00025) < ($ - 3ffh))
                          M         goto    L00025
                          M             else
                          M         bra     L00025
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00025
                          M     endif
                      00756 
                      00757 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00170          gosub buscar4
                      00758         GOSUB?L _buscar4
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 210


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar4
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar4
                          M     else
                          M       if ((_buscar4) < 1)
                          M         call    _buscar4
                          M       else
                          M         if ((_buscar4) > $)
001E4A EC47 F012          M         call    _buscar4
                          M         else
                          M           if ((_buscar4) < ($ - 3ffh))
                          M         call    _buscar4
                          M           else
                          M         rcall   _buscar4
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E4E                    M dlabel
                      00759 
                      00760 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00171        endif     
                      00761         LABEL?L L00025  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00025
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 211


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
001E4E                    M L00025
                          M     endif
                      00762 
                      00763 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00172        if pos = 5 then      
                      00764         CMPNE?BCL       _pos, 005h, L00027
                          M     if (((005h) > -100h) & ((005h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E4E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E50 5023               M         movf    _pos, W
001E52 0805               M         sublw   005h
                          M         BIT?GOTO 0, STATUS, Z, L00027
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00027))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 212


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if ((L00027) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M         else
                          M           if ((L00027) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M           else
                          M             if ((L00027) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M             else
                          M         bov     L00027
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E54 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00027
                          M       else
                          M         if ((L00027) < 1)
                          M         goto    L00027
                          M         else
                          M           if ((L00027) > $)
001E56 EF2F F00F          M         goto    L00027
                          M           else
                          M             if ((L00027) < ($ - 3ffh))
                          M         goto    L00027
                          M             else
                          M         bra     L00027
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00027
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 213


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00765 
                      00766 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00173          gosub buscar5
                      00767         GOSUB?L _buscar5
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar5
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar5
                          M     else
                          M       if ((_buscar5) < 1)
                          M         call    _buscar5
                          M       else
                          M         if ((_buscar5) > $)
001E5A EC66 F012          M         call    _buscar5
                          M         else
                          M           if ((_buscar5) < ($ - 3ffh))
                          M         call    _buscar5
                          M           else
                          M         rcall   _buscar5
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E5E                    M dlabel
                      00768 
                      00769 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00174        endif
                      00770         LABEL?L L00027  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 214


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00027
                          M         XALL
                          M     else
001E5E                    M L00027
                          M     endif
                      00771 
                      00772 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00175        if pos = 6 then      
                      00773         CMPNE?BCL       _pos, 006h, L00029
                          M     if (((006h) > -100h) & ((006h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E5E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E60 5023               M         movf    _pos, W
001E62 0806               M         sublw   006h
                          M         BIT?GOTO 0, STATUS, Z, L00029
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00029))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 215


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M       else
                          M         if ((L00029) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M         else
                          M           if ((L00029) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M           else
                          M             if ((L00029) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M             else
                          M         bov     L00029
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E64 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00029
                          M       else
                          M         if ((L00029) < 1)
                          M         goto    L00029
                          M         else
                          M           if ((L00029) > $)
001E66 EF37 F00F          M         goto    L00029
                          M           else
                          M             if ((L00029) < ($ - 3ffh))
                          M         goto    L00029
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 216


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bra     L00029
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00029
                          M     endif
                      00774 
                      00775 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00176          gosub buscar6
                      00776         GOSUB?L _buscar6
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar6
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar6
                          M     else
                          M       if ((_buscar6) < 1)
                          M         call    _buscar6
                          M       else
                          M         if ((_buscar6) > $)
001E6A EC85 F012          M         call    _buscar6
                          M         else
                          M           if ((_buscar6) < ($ - 3ffh))
                          M         call    _buscar6
                          M           else
                          M         rcall   _buscar6
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 217


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E6E                    M dlabel
                      00777 
                      00778 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00177        endif
                      00779         LABEL?L L00029  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00029
                          M         XALL
                          M     else
001E6E                    M L00029
                          M     endif
                      00780 
                      00781 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00178        if pos = 7 then      
                      00782         CMPNE?BCL       _pos, 007h, L00031
                          M     if (((007h) > -100h) & ((007h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E6E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E70 5023               M         movf    _pos, W
001E72 0807               M         sublw   007h
                          M         BIT?GOTO 0, STATUS, Z, L00031
                          M     ifdef USE_LINKER
                          M         CLRWDT?
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 218


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ($ == (L00031))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M       else
                          M         if ((L00031) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M         else
                          M           if ((L00031) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M           else
                          M             if ((L00031) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M             else
                          M         bov     L00031
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E74 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 219


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00031
                          M       else
                          M         if ((L00031) < 1)
                          M         goto    L00031
                          M         else
                          M           if ((L00031) > $)
001E76 EF3F F00F          M         goto    L00031
                          M           else
                          M             if ((L00031) < ($ - 3ffh))
                          M         goto    L00031
                          M             else
                          M         bra     L00031
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00031
                          M     endif
                      00783 
                      00784 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00179          gosub buscar7
                      00785         GOSUB?L _buscar7
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar7
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar7
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 220


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_buscar7) < 1)
                          M         call    _buscar7
                          M       else
                          M         if ((_buscar7) > $)
001E7A ECA4 F012          M         call    _buscar7
                          M         else
                          M           if ((_buscar7) < ($ - 3ffh))
                          M         call    _buscar7
                          M           else
                          M         rcall   _buscar7
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E7E                    M dlabel
                      00786 
                      00787 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00180        endif
                      00788         LABEL?L L00031  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00031
                          M         XALL
                          M     else
001E7E                    M L00031
                          M     endif
                      00789 
                      00790 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00181        if pos = 8 then      
                      00791         CMPNE?BCL       _pos, 008h, L00033
                          M     if (((008h) > -100h) & ((008h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001E7E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _pos
                          M         CHK?RP  _pos
                          M     if (((_pos)  & 8000h) != PREV_ALT)
                          M       if ((_pos)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_pos)  & 8000h
                          M     endif
                          M     if ((((_pos)  & 0fffh) > BANKA_END) & (((_pos)  & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 221


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_pos)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_pos)
                          M PREV_BANK = high (_pos)
                          M       endif
                          M     endif
001E80 5023               M         movf    _pos, W
001E82 0808               M         sublw   008h
                          M         BIT?GOTO 0, STATUS, Z, L00033
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00033))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M       else
                          M         if ((L00033) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M         else
                          M           if ((L00033) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M           else
                          M             if ((L00033) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M             else
                          M         bov     L00033
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 222


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001E84 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00033
                          M       else
                          M         if ((L00033) < 1)
                          M         goto    L00033
                          M         else
                          M           if ((L00033) > $)
001E86 EF47 F00F          M         goto    L00033
                          M           else
                          M             if ((L00033) < ($ - 3ffh))
                          M         goto    L00033
                          M             else
                          M         bra     L00033
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00033
                          M     endif
                      00792 
                      00793 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00182          gosub buscar8
                      00794         GOSUB?L _buscar8
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _buscar8
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 223


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _buscar8
                          M     else
                          M       if ((_buscar8) < 1)
                          M         call    _buscar8
                          M       else
                          M         if ((_buscar8) > $)
001E8A ECC3 F012          M         call    _buscar8
                          M         else
                          M           if ((_buscar8) < ($ - 3ffh))
                          M         call    _buscar8
                          M           else
                          M         rcall   _buscar8
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001E8E                    M dlabel
                      00795 
                      00796 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00183        endif
                      00797         LABEL?L L00033  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00033
                          M         XALL
                          M     else
001E8E                    M L00033
                          M     endif
                      00798 
                      00799 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00186        debug hex usbbuffer[i], "-" 
                      00800         DEBUGCOUNT?C    000h
                          M         MOVE?CB 000h, R4 + 1
                          M         CHK?RP  R4 + 1
                          M     if (((R4 + 1) & 8000h) != PREV_ALT)
                          M       if ((R4 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 224


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R4 + 1) & 8000h
                          M     endif
                          M     if ((((R4 + 1) & 0fffh) > BANKA_END) & (((R4 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R4 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R4 + 1)
                          M PREV_BANK = high (R4 + 1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001E8E 6A0A               M         clrf    R4 + 1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    R4 + 1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   R4 + 1
                          M       endif
                          M     endif
                      00801         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001E90 5022               M         movf    _i,  W
001E92 0F28               M         addlw   low (_USBBuffer)
001E94 6EE9               M         movwf   FSR0L
001E96 0E00               M         movlw   (_USBBuffer) >> 8
001E98 6AEA               M         clrf    FSR0H
001E9A 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
001E9C CFEF F013          M         movff   INDF0, T1
                      00802         DEBUGNUM?B      T1
                          M         MOVE?BW T1,  R2
                          M         MOVE?BB T1,  R2
001EA0 C013 F005          M         movff   T1,  R2
                          M         CHK?RP  R2
                          M     if (((R2)    & 8000h) != PREV_ALT)
                          M       if ((R2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 225


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R2)    & 8000h
                          M     endif
                          M     if ((((R2)    & 0fffh) > BANKA_END) & (((R2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R2)
                          M PREV_BANK = high (R2)
                          M       endif
                          M     endif
001EA4 6A06               M         clrf    (R2)   + 1
                      00803         DEBUGHEX?       
                          M         MOVE?CW DEBUGJ, R8
                          M     ifdef USE_LINKER
                          M         CHK?RP  R8
                          M         movlw   low (DEBUGJ)
                          M         movwf   R8
                          M         movlw   high (DEBUGJ)
                          M         movwf   (R8)   + 1
                          M     else
                          M         MOVE?CB low (DEBUGJ), R8
                          M         CHK?RP  R8
                          M     if (((R8)    & 8000h) != PREV_ALT)
                          M       if ((R8)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R8)    & 8000h
                          M     endif
                          M     if ((((R8)    & 0fffh) > BANKA_END) & (((R8)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R8)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R8)
                          M PREV_BANK = high (R8)
                          M       endif
                          M     endif
                          M     if (low (low (DEBUGJ)) == 0)
                          M         clrf    R8
                          M     else
                          M       if (low (low (DEBUGJ)) == 255)
                          M         setf    R8
                          M       else
001EA6 0E04               M         movlw   low (low (DEBUGJ))
001EA8 6E11               M         movwf   R8
                          M       endif
                          M     endif
                          M         MOVE?CB high (DEBUGJ), (R8) + 1
                          M         CHK?RP  (R8) + 1
                          M     if ((((R8) + 1) & 8000h) != PREV_ALT)
                          M       if (((R8) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 226


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((R8) + 1) & 8000h
                          M     endif
                          M     if (((((R8) + 1) & 0fffh) > BANKA_END) & ((((R8) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((R8) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((R8) + 1)
                          M PREV_BANK = high ((R8) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (DEBUGJ)) == 0)
                          M         clrf    (R8) + 1
                          M     else
                          M       if (low (high (DEBUGJ)) == 255)
                          M         setf    (R8) + 1
                          M       else
001EAA 0E10               M         movlw   low (high (DEBUGJ))
001EAC 6E12               M         movwf   (R8) + 1
                          M       endif
                          M     endif
                          M     endif
                          M         L?CALL  SEROUT2HEX
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    SEROUT2HEX
                          M     else
                          M       if ((SEROUT2HEX) < 1)
                          M         call    SEROUT2HEX
                          M       else
                          M         if ((SEROUT2HEX) > $)
                          M         call    SEROUT2HEX
                          M         else
                          M           if ((SEROUT2HEX) < ($ - 3ffh))
001EAE EC1D F008          M         call    SEROUT2HEX
                          M           else
                          M         rcall   SEROUT2HEX
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00804         DEBUG?C 02Dh
001EB2 0E2D               M         movlw   02Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 227


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
001EB4 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00805 
                      00806 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00188        if ((i = 0)  and (usbbuffer[i] <= 2
                            40)) then
                      00807         CMPEQ?BCB       _i, 000h, T1
                          M     if (((000h) > -100h) & ((000h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001EB8 5022               M         movf    _i,  W
001EBA 0800               M         sublw   000h
001EBC A4D8               M         btfss   STATUS, Z
001EBE 68E8               M         setf    WREG
001EC0 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 228


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001EC2 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00808         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001EC4 5022               M         movf    _i,  W
001EC6 0F28               M         addlw   low (_USBBuffer)
001EC8 6EE9               M         movwf   FSR0L
001ECA 0E00               M         movlw   (_USBBuffer) >> 8
001ECC 6AEA               M         clrf    FSR0H
001ECE 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
001ED0 CFEF F015          M         movff   INDF0, T2
                      00809         CMPLE?BCB       T2, 0F0h, T2
                          M     if ((0F0h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((0F0h) >= 0)
                          M         MOVE?BB T2,  R0
001ED4 C015 F001          M         movff   T2,  R0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 229


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?CA 0F0h
001ED8 0EF0               M         movlw   low (0F0h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
                          M           if ((CMPLEB) < ($ - 3ffh))
001EDA EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001EDE 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00810         LAND?BBW        T1, T2, T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 230


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?BB T1,   R0
001EE0 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001EE4 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001EE6 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 231


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001EEA 6E15               M         movwf   T2
001EEC 6E16               M         movwf   T2   + 1
                      00811         CMPF?WL T2, L00035
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001EEE 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001EF0 5015               M         movf    T2,  W
001EF2 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00035
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00035))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 232


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M       else
                          M         if ((L00035) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M         else
                          M           if ((L00035) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M           else
                          M             if ((L00035) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M             else
                          M         bov     L00035
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001EF4 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00035
                          M       else
                          M         if ((L00035) < 1)
                          M         goto    L00035
                          M         else
                          M           if ((L00035) > $)
001EF6 EF92 F00F          M         goto    L00035
                          M           else
                          M             if ((L00035) < ($ - 3ffh))
                          M         goto    L00035
                          M             else
                          M         bra     L00035
                          M             endif
                          M           endif
                          M         endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 233


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      00812 
                      00813 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00189          usbbuffer[i] = usbbuffer[i] + var
                            1
                      00814         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001EFA 5022               M         movf    _i,  W
001EFC 0F28               M         addlw   low (_USBBuffer)
001EFE 6EE9               M         movwf   FSR0L
001F00 0E00               M         movlw   (_USBBuffer) >> 8
001F02 6AEA               M         clrf    FSR0H
001F04 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
001F06 CFEF F013          M         movff   INDF0, T1
                      00815         ADD?BBW T1, _var1, T1
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F0A 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 234


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
001F0C 2427               M         addwf   _var1, W
                          M         MOVE?AW T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F0E 6E13               M         movwf   T1
001F10 6A14               M         clrf    (T1)   + 1
001F12 3614               M         rlcf    (T1)   + 1, F
                      00816         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F14 5022               M         movf    _i,  W
001F16 0F28               M         addlw   low (_USBBuffer)
001F18 6EE9               M         movwf   FSR0L
001F1A 0E00               M         movlw   (_USBBuffer) >> 8
001F1C 6AEA               M         clrf    FSR0H
001F1E 22EA               M         addwfc  FSR0H, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 235


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
001F20 C013 FFEF          M         movff   T1,  INDF0
                      00817 
                      00818 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00190        endif
                      00819         LABEL?L L00035  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00035
                          M         XALL
                          M     else
001F24                    M L00035
                          M     endif
                      00820 
                      00821 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00191        if ((i = 1)  and (usbbuffer[i] <= 2
                            40)) then
                      00822         CMPEQ?BCB       _i, 001h, T1
                          M     if (((001h) > -100h) & ((001h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F24 5022               M         movf    _i,  W
001F26 0801               M         sublw   001h
001F28 A4D8               M         btfss   STATUS, Z
001F2A 68E8               M         setf    WREG
001F2C 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 236


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F2E 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00823         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F30 5022               M         movf    _i,  W
001F32 0F28               M         addlw   low (_USBBuffer)
001F34 6EE9               M         movwf   FSR0L
001F36 0E00               M         movlw   (_USBBuffer) >> 8
001F38 6AEA               M         clrf    FSR0H
001F3A 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
001F3C CFEF F015          M         movff   INDF0, T2
                      00824         CMPLE?BCB       T2, 0F0h, T2
                          M     if ((0F0h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((0F0h) >= 0)
                          M         MOVE?BB T2,  R0
001F40 C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 0F0h
001F44 0EF0               M         movlw   low (0F0h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 237


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
                          M           if ((CMPLEB) < ($ - 3ffh))
001F46 EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001F4A 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00825         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001F4C C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 238


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001F50 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001F52 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 239


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001F56 6E15               M         movwf   T2
001F58 6E16               M         movwf   T2   + 1
                      00826         CMPF?WL T2, L00037
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001F5A 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001F5C 5015               M         movf    T2,  W
001F5E 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00037
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00037))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00037
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 240


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((L00037) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M         else
                          M           if ((L00037) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M           else
                          M             if ((L00037) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M             else
                          M         bov     L00037
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001F60 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00037
                          M       else
                          M         if ((L00037) < 1)
                          M         goto    L00037
                          M         else
                          M           if ((L00037) > $)
001F62 EFC8 F00F          M         goto    L00037
                          M           else
                          M             if ((L00037) < ($ - 3ffh))
                          M         goto    L00037
                          M             else
                          M         bra     L00037
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00827 
                      00828 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00192          usbbuffer[i] = usbbuffer[i] + var
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 241


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            1
                      00829         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F66 5022               M         movf    _i,  W
001F68 0F28               M         addlw   low (_USBBuffer)
001F6A 6EE9               M         movwf   FSR0L
001F6C 0E00               M         movlw   (_USBBuffer) >> 8
001F6E 6AEA               M         clrf    FSR0H
001F70 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
001F72 CFEF F013          M         movff   INDF0, T1
                      00830         ADD?BBW T1, _var1, T1
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F76 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 242


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
001F78 2427               M         addwf   _var1, W
                          M         MOVE?AW T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F7A 6E13               M         movwf   T1
001F7C 6A14               M         clrf    (T1)   + 1
001F7E 3614               M         rlcf    (T1)   + 1, F
                      00831         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F80 5022               M         movf    _i,  W
001F82 0F28               M         addlw   low (_USBBuffer)
001F84 6EE9               M         movwf   FSR0L
001F86 0E00               M         movlw   (_USBBuffer) >> 8
001F88 6AEA               M         clrf    FSR0H
001F8A 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
001F8C C013 FFEF          M         movff   T1,  INDF0
                      00832 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 243


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00833 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00193        endif
                      00834         LABEL?L L00037  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00037
                          M         XALL
                          M     else
001F90                    M L00037
                          M     endif
                      00835 
                      00836 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00194        if ((i = 2) and (usbbuffer[i] >= 28
                            )) then    '28
                      00837         CMPEQ?BCB       _i, 002h, T1
                          M     if (((002h) > -100h) & ((002h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F90 5022               M         movf    _i,  W
001F92 0802               M         sublw   002h
001F94 A4D8               M         btfss   STATUS, Z
001F96 68E8               M         setf    WREG
001F98 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 244


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001F9A 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00838         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001F9C 5022               M         movf    _i,  W
001F9E 0F28               M         addlw   low (_USBBuffer)
001FA0 6EE9               M         movwf   FSR0L
001FA2 0E00               M         movlw   (_USBBuffer) >> 8
001FA4 6AEA               M         clrf    FSR0H
001FA6 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
001FA8 CFEF F015          M         movff   INDF0, T2
                      00839         CMPGE?BCB       T2, 01Ch, T2
                          M     if ((01Ch) <= 0)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((01Ch) < 100h)
                          M         MOVE?BB T2,  R0
001FAC C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 01Ch
001FB0 0E1C               M         movlw   low (01Ch)
                          M         L?CALL  CMPGEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 245


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGEB
                          M     else
                          M       if ((CMPGEB) < 1)
                          M         call    CMPGEB
                          M       else
                          M         if ((CMPGEB) > $)
                          M         call    CMPGEB
                          M         else
                          M           if ((CMPGEB) < ($ - 3ffh))
001FB2 EC59 F008          M         call    CMPGEB
                          M           else
                          M         rcall   CMPGEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001FB6 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00840         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001FB8 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 246


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001FBC 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001FBE EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 247


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001FC2 6E15               M         movwf   T2
001FC4 6E16               M         movwf   T2   + 1
                      00841         CMPF?WL T2, L00039
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001FC6 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001FC8 5015               M         movf    T2,  W
001FCA 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00039
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00039))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M       else
                          M         if ((L00039) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00039
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 248


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00039) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M           else
                          M             if ((L00039) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M             else
                          M         bov     L00039
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001FCC B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00039
                          M       else
                          M         if ((L00039) < 1)
                          M         goto    L00039
                          M         else
                          M           if ((L00039) > $)
001FCE EF05 F010          M         goto    L00039
                          M           else
                          M             if ((L00039) < ($ - 3ffh))
                          M         goto    L00039
                          M             else
                          M         bra     L00039
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00842 
                      00843 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00195          usbbuffer[i] = usbbuffer[i] // va
                            r1
                      00844         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 249


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001FD2 5022               M         movf    _i,  W
001FD4 0F28               M         addlw   low (_USBBuffer)
001FD6 6EE9               M         movwf   FSR0L
001FD8 0E00               M         movlw   (_USBBuffer) >> 8
001FDA 6AEA               M         clrf    FSR0H
001FDC 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
001FDE CFEF F013          M         movff   INDF0, T1
                      00845         MOD?BBW T1, _var1, T1
                          M         MOVE?BW T1,   R0
                          M         MOVE?BB T1,  R0
001FE2 C013 F001          M         movff   T1,  R0
                          M         CHK?RP  R0
                          M     if (((R0)    & 8000h) != PREV_ALT)
                          M       if ((R0)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R0)    & 8000h
                          M     endif
                          M     if ((((R0)    & 0fffh) > BANKA_END) & (((R0)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R0)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R0)
                          M PREV_BANK = high (R0)
                          M       endif
                          M     endif
001FE6 6A02               M         clrf    (R0)   + 1
                          M         MOVE?BW _var1, R1
                          M         MOVE?BB _var1, R1
001FE8 C027 F003          M         movff   _var1, R1
                          M         CHK?RP  R1
                          M     if (((R1)    & 8000h) != PREV_ALT)
                          M       if ((R1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R1)    & 8000h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 250


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((R1)    & 0fffh) > BANKA_END) & (((R1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R1)
                          M PREV_BANK = high (R1)
                          M       endif
                          M     endif
001FEC 6A04               M         clrf    (R1)   + 1
                          M         L?CALL  DIV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DIV
                          M     else
                          M       if ((DIV)   < 1)
                          M         call    DIV
                          M       else
                          M         if ((DIV)   > $)
                          M         call    DIV
                          M         else
                          M           if ((DIV)   < ($ - 3ffh))
001FEE EC7A F008          M         call    DIV
                          M           else
                          M         rcall   DIV
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?WW R2, T1
                          M         MOVE?BB R2,  T1
001FF2 C005 F013          M         movff   R2,  T1
                          M         MOVE?BB (R2)  + 1, (T1)   + 1
001FF6 C006 F014          M         movff   (R2) + 1, (T1) + 1
                      00846         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 251


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
001FFA 5022               M         movf    _i,  W
001FFC 0F28               M         addlw   low (_USBBuffer)
001FFE 6EE9               M         movwf   FSR0L
002000 0E00               M         movlw   (_USBBuffer) >> 8
002002 6AEA               M         clrf    FSR0H
002004 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
002006 C013 FFEF          M         movff   T1,  INDF0
                      00847 
                      00848 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00196        endif
                      00849         LABEL?L L00039  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00039
                          M         XALL
                          M     else
00200A                    M L00039
                          M     endif
                      00850 
                      00851 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00197        if ((i = 3) and (usbbuffer[i] <= 17
                            )) then    '28
                      00852         CMPEQ?BCB       _i, 003h, T1
                          M     if (((003h) > -100h) & ((003h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 252


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
00200A 5022               M         movf    _i,  W
00200C 0803               M         sublw   003h
00200E A4D8               M         btfss   STATUS, Z
002010 68E8               M         setf    WREG
002012 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
002014 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00853         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002016 5022               M         movf    _i,  W
002018 0F28               M         addlw   low (_USBBuffer)
00201A 6EE9               M         movwf   FSR0L
00201C 0E00               M         movlw   (_USBBuffer) >> 8
00201E 6AEA               M         clrf    FSR0H
002020 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
002022 CFEF F015          M         movff   INDF0, T2
                      00854         CMPLE?BCB       T2, 011h, T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 253


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((011h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((011h) >= 0)
                          M         MOVE?BB T2,  R0
002026 C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 011h
00202A 0E11               M         movlw   low (011h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
                          M           if ((CMPLEB) < ($ - 3ffh))
00202C EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 254


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002030 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00855         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
002032 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
002036 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
002038 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 255


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00203C 6E15               M         movwf   T2
00203E 6E16               M         movwf   T2   + 1
                      00856         CMPF?WL T2, L00041
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
002040 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
002042 5015               M         movf    T2,  W
002044 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00041
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00041))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 256


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M       else
                          M         if ((L00041) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M         else
                          M           if ((L00041) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M           else
                          M             if ((L00041) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M             else
                          M         bov     L00041
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
002046 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00041
                          M       else
                          M         if ((L00041) < 1)
                          M         goto    L00041
                          M         else
                          M           if ((L00041) > $)
002048 EF3C F010          M         goto    L00041
                          M           else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 257


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             if ((L00041) < ($ - 3ffh))
                          M         goto    L00041
                          M             else
                          M         bra     L00041
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00857 
                      00858 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00198          usbbuffer[i] = usbbuffer[i] * var
                            1
                      00859         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
00204C 5022               M         movf    _i,  W
00204E 0F28               M         addlw   low (_USBBuffer)
002050 6EE9               M         movwf   FSR0L
002052 0E00               M         movlw   (_USBBuffer) >> 8
002054 6AEA               M         clrf    FSR0H
002056 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
002058 CFEF F013          M         movff   INDF0, T1
                      00860         MUL?BBW T1, _var1, T1
                          M     ifndef DIV32_USED
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 258


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
00205C 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
00205E 0227               M         mulwf   _var1
                          M         MOVE?WW PRODL, T1
                          M         MOVE?BB PRODL, T1
002060 CFF3 F013          M         movff   PRODL, T1
                          M         MOVE?BB (PRODL) + 1, (T1) + 1
002064 CFF4 F014          M         movff   (PRODL) + 1, (T1) + 1
                          M     else
                          M         MOVE?BW T1,   R3
                          M         MOVE?BW _var1, R1
                          M         L?CALL  MUL
                          M         MOVE?AWW R2, T1
                          M     endif
                      00861         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002068 5022               M         movf    _i,  W
00206A 0F28               M         addlw   low (_USBBuffer)
00206C 6EE9               M         movwf   FSR0L
00206E 0E00               M         movlw   (_USBBuffer) >> 8
002070 6AEA               M         clrf    FSR0H
002072 22EA               M         addwfc  FSR0H, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 259


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
002074 C013 FFEF          M         movff   T1,  INDF0
                      00862 
                      00863 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00199        endif
                      00864         LABEL?L L00041  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00041
                          M         XALL
                          M     else
002078                    M L00041
                          M     endif
                      00865 
                      00866 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00200        if ((i = 4)  and (usbbuffer[i] <= 2
                            40)) then
                      00867         CMPEQ?BCB       _i, 004h, T1
                          M     if (((004h) > -100h) & ((004h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002078 5022               M         movf    _i,  W
00207A 0804               M         sublw   004h
00207C A4D8               M         btfss   STATUS, Z
00207E 68E8               M         setf    WREG
002080 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 260


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
002082 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00868         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002084 5022               M         movf    _i,  W
002086 0F28               M         addlw   low (_USBBuffer)
002088 6EE9               M         movwf   FSR0L
00208A 0E00               M         movlw   (_USBBuffer) >> 8
00208C 6AEA               M         clrf    FSR0H
00208E 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
002090 CFEF F015          M         movff   INDF0, T2
                      00869         CMPLE?BCB       T2, 0F0h, T2
                          M     if ((0F0h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((0F0h) >= 0)
                          M         MOVE?BB T2,  R0
002094 C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 0F0h
002098 0EF0               M         movlw   low (0F0h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 261


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
                          M           if ((CMPLEB) < ($ - 3ffh))
00209A EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00209E 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00870         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
0020A0 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 262


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0020A4 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
0020A6 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 263


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0020AA 6E15               M         movwf   T2
0020AC 6E16               M         movwf   T2   + 1
                      00871         CMPF?WL T2, L00043
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0020AE 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0020B0 5015               M         movf    T2,  W
0020B2 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00043
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00043))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00043
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 264


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((L00043) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M         else
                          M           if ((L00043) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M           else
                          M             if ((L00043) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M             else
                          M         bov     L00043
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0020B4 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00043
                          M       else
                          M         if ((L00043) < 1)
                          M         goto    L00043
                          M         else
                          M           if ((L00043) > $)
0020B6 EF72 F010          M         goto    L00043
                          M           else
                          M             if ((L00043) < ($ - 3ffh))
                          M         goto    L00043
                          M             else
                          M         bra     L00043
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00872 
                      00873 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00201          usbbuffer[i] = usbbuffer[i] + var
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 265


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            1
                      00874         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0020BA 5022               M         movf    _i,  W
0020BC 0F28               M         addlw   low (_USBBuffer)
0020BE 6EE9               M         movwf   FSR0L
0020C0 0E00               M         movlw   (_USBBuffer) >> 8
0020C2 6AEA               M         clrf    FSR0H
0020C4 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
0020C6 CFEF F013          M         movff   INDF0, T1
                      00875         ADD?BBW T1, _var1, T1
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0020CA 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 266


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
0020CC 2427               M         addwf   _var1, W
                          M         MOVE?AW T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0020CE 6E13               M         movwf   T1
0020D0 6A14               M         clrf    (T1)   + 1
0020D2 3614               M         rlcf    (T1)   + 1, F
                      00876         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0020D4 5022               M         movf    _i,  W
0020D6 0F28               M         addlw   low (_USBBuffer)
0020D8 6EE9               M         movwf   FSR0L
0020DA 0E00               M         movlw   (_USBBuffer) >> 8
0020DC 6AEA               M         clrf    FSR0H
0020DE 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
0020E0 C013 FFEF          M         movff   T1,  INDF0
                      00877 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 267


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00878 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00202        endif
                      00879         LABEL?L L00043  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00043
                          M         XALL
                          M     else
0020E4                    M L00043
                          M     endif
                      00880 
                      00881 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00203        if ((i = 5) and (usbbuffer[i] >= 17
                            )) then
                      00882         CMPEQ?BCB       _i, 005h, T1
                          M     if (((005h) > -100h) & ((005h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0020E4 5022               M         movf    _i,  W
0020E6 0805               M         sublw   005h
0020E8 A4D8               M         btfss   STATUS, Z
0020EA 68E8               M         setf    WREG
0020EC 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 268


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0020EE 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00883         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0020F0 5022               M         movf    _i,  W
0020F2 0F28               M         addlw   low (_USBBuffer)
0020F4 6EE9               M         movwf   FSR0L
0020F6 0E00               M         movlw   (_USBBuffer) >> 8
0020F8 6AEA               M         clrf    FSR0H
0020FA 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
0020FC CFEF F015          M         movff   INDF0, T2
                      00884         CMPGE?BCB       T2, 011h, T2
                          M     if ((011h) <= 0)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((011h) < 100h)
                          M         MOVE?BB T2,  R0
002100 C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 011h
002104 0E11               M         movlw   low (011h)
                          M         L?CALL  CMPGEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 269


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGEB
                          M     else
                          M       if ((CMPGEB) < 1)
                          M         call    CMPGEB
                          M       else
                          M         if ((CMPGEB) > $)
                          M         call    CMPGEB
                          M         else
                          M           if ((CMPGEB) < ($ - 3ffh))
002106 EC59 F008          M         call    CMPGEB
                          M           else
                          M         rcall   CMPGEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00210A 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00885         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
00210C C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 270


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
002110 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
002112 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 271


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
002116 6E15               M         movwf   T2
002118 6E16               M         movwf   T2   + 1
                      00886         CMPF?WL T2, L00045
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00211A 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00211C 5015               M         movf    T2,  W
00211E 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00045
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00045))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M       else
                          M         if ((L00045) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00045
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 272


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00045) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M           else
                          M             if ((L00045) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M             else
                          M         bov     L00045
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
002120 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00045
                          M       else
                          M         if ((L00045) < 1)
                          M         goto    L00045
                          M         else
                          M           if ((L00045) > $)
002122 EFA9 F010          M         goto    L00045
                          M           else
                          M             if ((L00045) < ($ - 3ffh))
                          M         goto    L00045
                          M             else
                          M         bra     L00045
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00887 
                      00888 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00204          usbbuffer[i] = usbbuffer[i] - var
                            1
                      00889         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 273


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002126 5022               M         movf    _i,  W
002128 0F28               M         addlw   low (_USBBuffer)
00212A 6EE9               M         movwf   FSR0L
00212C 0E00               M         movlw   (_USBBuffer) >> 8
00212E 6AEA               M         clrf    FSR0H
002130 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
002132 CFEF F013          M         movff   INDF0, T1
                      00890         SUB?BBW T1, _var1, T1
                          M         MOVE?BA _var1
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
002136 5027               M         movf    _var1, W
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 274


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
002138 5C13               M         subwf   T1,   W
                          M         MOVE?AW T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
00213A 6E13               M         movwf   T1
00213C 6A14               M         clrf    (T1)   + 1
00213E A0D8               M         btfss   STATUS, C
002140 0614               M         decf    (T1)   + 1, F
                      00891         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002142 5022               M         movf    _i,  W
002144 0F28               M         addlw   low (_USBBuffer)
002146 6EE9               M         movwf   FSR0L
002148 0E00               M         movlw   (_USBBuffer) >> 8
00214A 6AEA               M         clrf    FSR0H
00214C 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
00214E C013 FFEF          M         movff   T1,  INDF0
                      00892 
                      00893 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00205        endif
                      00894         LABEL?L L00045  
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 275


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00045
                          M         XALL
                          M     else
002152                    M L00045
                          M     endif
                      00895 
                      00896 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00206        if ((i = 6) and (usbbuffer[i] <= 17
                            )) then
                      00897         CMPEQ?BCB       _i, 006h, T1
                          M     if (((006h) > -100h) & ((006h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002152 5022               M         movf    _i,  W
002154 0806               M         sublw   006h
002156 A4D8               M         btfss   STATUS, Z
002158 68E8               M         setf    WREG
00215A 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 276


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
00215C 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00898         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
00215E 5022               M         movf    _i,  W
002160 0F28               M         addlw   low (_USBBuffer)
002162 6EE9               M         movwf   FSR0L
002164 0E00               M         movlw   (_USBBuffer) >> 8
002166 6AEA               M         clrf    FSR0H
002168 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
00216A CFEF F015          M         movff   INDF0, T2
                      00899         CMPLE?BCB       T2, 011h, T2
                          M     if ((011h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((011h) >= 0)
                          M         MOVE?BB T2,  R0
00216E C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 011h
002172 0E11               M         movlw   low (011h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 277


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
                          M           if ((CMPLEB) < ($ - 3ffh))
002174 EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
002178 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00900         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
00217A C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 278


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00217E 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
002180 EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
002184 6E15               M         movwf   T2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 279


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002186 6E16               M         movwf   T2   + 1
                      00901         CMPF?WL T2, L00047
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
002188 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00218A 5015               M         movf    T2,  W
00218C 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00047
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00047))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M       else
                          M         if ((L00047) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M         else
                          M           if ((L00047) > $)
                          M         btfsc   STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 280


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00047
                          M           else
                          M             if ((L00047) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M             else
                          M         bov     L00047
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
00218E B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00047
                          M       else
                          M         if ((L00047) < 1)
                          M         goto    L00047
                          M         else
                          M           if ((L00047) > $)
002190 EFE0 F010          M         goto    L00047
                          M           else
                          M             if ((L00047) < ($ - 3ffh))
                          M         goto    L00047
                          M             else
                          M         bra     L00047
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00902 
                      00903 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00207          usbbuffer[i] = usbbuffer[i] * var
                            1
                      00904         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 281


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002194 5022               M         movf    _i,  W
002196 0F28               M         addlw   low (_USBBuffer)
002198 6EE9               M         movwf   FSR0L
00219A 0E00               M         movlw   (_USBBuffer) >> 8
00219C 6AEA               M         clrf    FSR0H
00219E 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
0021A0 CFEF F013          M         movff   INDF0, T1
                      00905         MUL?BBW T1, _var1, T1
                          M     ifndef DIV32_USED
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0021A4 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 282


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0021A6 0227               M         mulwf   _var1
                          M         MOVE?WW PRODL, T1
                          M         MOVE?BB PRODL, T1
0021A8 CFF3 F013          M         movff   PRODL, T1
                          M         MOVE?BB (PRODL) + 1, (T1) + 1
0021AC CFF4 F014          M         movff   (PRODL) + 1, (T1) + 1
                          M     else
                          M         MOVE?BW T1,   R3
                          M         MOVE?BW _var1, R1
                          M         L?CALL  MUL
                          M         MOVE?AWW R2, T1
                          M     endif
                      00906         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0021B0 5022               M         movf    _i,  W
0021B2 0F28               M         addlw   low (_USBBuffer)
0021B4 6EE9               M         movwf   FSR0L
0021B6 0E00               M         movlw   (_USBBuffer) >> 8
0021B8 6AEA               M         clrf    FSR0H
0021BA 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
0021BC C013 FFEF          M         movff   T1,  INDF0
                      00907 
                      00908 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00208        endif
                      00909         LABEL?L L00047  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00047
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 283


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
0021C0                    M L00047
                          M     endif
                      00910 
                      00911 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00209        if ((i = 7)  and (usbbuffer[i] <= 2
                            40)) then
                      00912         CMPEQ?BCB       _i, 007h, T1
                          M     if (((007h) > -100h) & ((007h) < 100h))
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0021C0 5022               M         movf    _i,  W
0021C2 0807               M         sublw   007h
0021C4 A4D8               M         btfss   STATUS, Z
0021C6 68E8               M         setf    WREG
0021C8 0AFF               M         xorlw   0ffh
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0021CA 6E13               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      00913         AOUT?BBB        _USBBuffer, _i, T2
                          M         MOVE?BA _i
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 284


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0021CC 5022               M         movf    _i,  W
0021CE 0F28               M         addlw   low (_USBBuffer)
0021D0 6EE9               M         movwf   FSR0L
0021D2 0E00               M         movlw   (_USBBuffer) >> 8
0021D4 6AEA               M         clrf    FSR0H
0021D6 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T2
0021D8 CFEF F015          M         movff   INDF0, T2
                      00914         CMPLE?BCB       T2, 0F0h, T2
                          M     if ((0F0h) >= 0ffh)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((0F0h) >= 0)
                          M         MOVE?BB T2,  R0
0021DC C015 F001          M         movff   T2,  R0
                          M         MOVE?CA 0F0h
0021E0 0EF0               M         movlw   low (0F0h)
                          M         L?CALL  CMPLEB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLEB
                          M     else
                          M       if ((CMPLEB) < 1)
                          M         call    CMPLEB
                          M       else
                          M         if ((CMPLEB) > $)
                          M         call    CMPLEB
                          M         else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 285


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((CMPLEB) < ($ - 3ffh))
0021E2 EC5E F008          M         call    CMPLEB
                          M           else
                          M         rcall   CMPLEB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0021E6 6E15               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      00915         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
0021E8 C013 F001          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0021EC 5015               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 286


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
0021EE EC73 F008          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0021F2 6E15               M         movwf   T2
0021F4 6E16               M         movwf   T2   + 1
                      00916         CMPF?WL T2, L00049
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0021F6 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 287


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0021F8 5015               M         movf    T2,  W
0021FA 1016               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00049
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00049))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M       else
                          M         if ((L00049) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M         else
                          M           if ((L00049) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M           else
                          M             if ((L00049) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M             else
                          M         bov     L00049
                          M             endif
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 288


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0021FC B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00049
                          M       else
                          M         if ((L00049) < 1)
                          M         goto    L00049
                          M         else
                          M           if ((L00049) > $)
0021FE EF16 F011          M         goto    L00049
                          M           else
                          M             if ((L00049) < ($ - 3ffh))
                          M         goto    L00049
                          M             else
                          M         bra     L00049
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00917 
                      00918 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00210          usbbuffer[i] = usbbuffer[i] + var
                            1
                      00919         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 289


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002202 5022               M         movf    _i,  W
002204 0F28               M         addlw   low (_USBBuffer)
002206 6EE9               M         movwf   FSR0L
002208 0E00               M         movlw   (_USBBuffer) >> 8
00220A 6AEA               M         clrf    FSR0H
00220C 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
00220E CFEF F013          M         movff   INDF0, T1
                      00920         ADD?BBW T1, _var1, T1
                          M         MOVE?BA T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
002212 5013               M         movf    T1,  W
                          M         CHK?RP  _var1
                          M     if (((_var1) & 8000h) != PREV_ALT)
                          M       if ((_var1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_var1) & 8000h
                          M     endif
                          M     if ((((_var1) & 0fffh) > BANKA_END) & (((_var1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_var1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_var1)
                          M PREV_BANK = high (_var1)
                          M       endif
                          M     endif
002214 2427               M         addwf   _var1, W
                          M         MOVE?AW T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 290


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
002216 6E13               M         movwf   T1
002218 6A14               M         clrf    (T1)   + 1
00221A 3614               M         rlcf    (T1)   + 1, F
                      00921         AIN?WBB T1, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
00221C 5022               M         movf    _i,  W
00221E 0F28               M         addlw   low (_USBBuffer)
002220 6EE9               M         movwf   FSR0L
002222 0E00               M         movlw   (_USBBuffer) >> 8
002224 6AEA               M         clrf    FSR0H
002226 22EA               M         addwfc  FSR0H, F
                          M         MOVE?WB T1,  INDF0
                          M         MOVE?BB T1,  INDF0
002228 C013 FFEF          M         movff   T1,  INDF0
                      00922 
                      00923 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00211        endif
                      00924         LABEL?L L00049  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00049
                          M         XALL
                          M     else
00222C                    M L00049
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 291


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00925 
                      00926 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00212        pause 10
                      00927         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
00222C 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
00222E EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00928 
                      00929 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00213      next
                      00930         NEXT?BCL        _i, 001h, L00017
                          M     if ((001h) == 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 292


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002232 2A22               M         incf    _i,  F
                          M     else
                          M         movlw   001h
                          M         CHK?RP  _i
                          M         addwf   _i,  F
                          M     endif
                          M     if ((001h) <= 255)
                          M         BIT?GOTO 0, STATUS, C, L00017
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00017))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M       else
                          M         if ((L00017) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M         else
                          M           if ((L00017) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M           else
                          M             if ((L00017) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M             else
                          M         bov     L00017
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 293


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002234 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00017
                          M       else
                          M         if ((L00017) < 1)
                          M         goto    L00017
                          M         else
                          M           if ((L00017) > $)
                          M         goto    L00017
                          M           else
                          M             if ((L00017) < ($ - 3ffh))
002236 EFFF F00E          M         goto    L00017
                          M             else
                          M         bra     L00017
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00931         LABEL?L L00018  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00018
                          M         XALL
                          M     else
00223A                    M L00018
                          M     endif
                      00932 
                      00933 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00215      debug 13, "Dato USB LOCAL enviado... 
                            ",13
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 294


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00934         DEBUG?C 00Dh
00223A 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00223C EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00935         DEBUG?C 044h
002240 0E44               M         movlw   044h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 295


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002242 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00936         DEBUG?C 061h
002246 0E61               M         movlw   061h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002248 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00937         DEBUG?C 074h
00224C 0E74               M         movlw   074h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 296


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00224E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00938         DEBUG?C 06Fh
002252 0E6F               M         movlw   06Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002254 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00939         DEBUG?C 020h
002258 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 297


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00225A EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00940         DEBUG?C 055h
00225E 0E55               M         movlw   055h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002260 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00941         DEBUG?C 053h
002264 0E53               M         movlw   053h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 298


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002266 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00942         DEBUG?C 042h
00226A 0E42               M         movlw   042h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00226C EC03 F008          M         call    DEBUG
                          M           else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 299


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00943         DEBUG?C 020h
002270 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002272 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00944         DEBUG?C 04Ch
002276 0E4C               M         movlw   04Ch
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 300


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002278 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00945         DEBUG?C 04Fh
00227C 0E4F               M         movlw   04Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00227E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00946         DEBUG?C 043h
002282 0E43               M         movlw   043h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 301


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002284 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00947         DEBUG?C 041h
002288 0E41               M         movlw   041h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00228A EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00948         DEBUG?C 04Ch
00228E 0E4C               M         movlw   04Ch
                          M         L?CALL  DEBUG
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 302


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002290 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00949         DEBUG?C 020h
002294 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002296 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 303


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     endif
                      00950         DEBUG?C 065h
00229A 0E65               M         movlw   065h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00229C EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00951         DEBUG?C 06Eh
0022A0 0E6E               M         movlw   06Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 304


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022A2 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00952         DEBUG?C 076h
0022A6 0E76               M         movlw   076h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022A8 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00953         DEBUG?C 069h
0022AC 0E69               M         movlw   069h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 305


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022AE EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00954         DEBUG?C 061h
0022B2 0E61               M         movlw   061h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022B4 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00955         DEBUG?C 064h
0022B8 0E64               M         movlw   064h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 306


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022BA EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00956         DEBUG?C 06Fh
0022BE 0E6F               M         movlw   06Fh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022C0 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 307


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00957         DEBUG?C 02Eh
0022C4 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022C6 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00958         DEBUG?C 02Eh
0022CA 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 308


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((DEBUG) < ($ - 3ffh))
0022CC EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00959         DEBUG?C 02Eh
0022D0 0E2E               M         movlw   02Eh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022D2 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00960         DEBUG?C 020h
0022D6 0E20               M         movlw   020h
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 309


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022D8 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00961         DEBUG?C 00Dh
0022DC 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
0022DE EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00962 
                      00963 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00217      for i = 0 to 7
                      00964         MOVE?CB 000h, _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 310


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0022E2 6A22               M         clrf    _i
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _i
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _i
                          M       endif
                          M     endif
                      00965         LABEL?L L00051  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00051
                          M         XALL
                          M     else
0022E4                    M L00051
                          M     endif
                      00966         CMPGT?BCL       _i, 007h, L00052
                          M     if ((007h) < 0)
                          M         L?GOTO  L00052
                          M     else
                          M       if ((007h) < 0ffh)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0022E4 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (007h) + 1
0022E6 0E08               M         movlw   low ((007h) + 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 311


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0022E8 5C22               M         subwf   _i,  W
                          M         BIT?GOTO 1, STATUS, C, L00052
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00052))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00052
                          M       else
                          M         if ((L00052) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00052
                          M         else
                          M           if ((L00052) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00052
                          M           else
                          M             if ((L00052) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00052
                          M             else
                          M         bov     L00052
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 312


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
0022EA B0D8               M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00052
                          M       else
                          M         if ((L00052) < 1)
                          M         goto    L00052
                          M         else
                          M           if ((L00052) > $)
0022EC EF93 F011          M         goto    L00052
                          M           else
                          M             if ((L00052) < ($ - 3ffh))
                          M         goto    L00052
                          M             else
                          M         bra     L00052
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
                      00967 
                      00968 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00218        debug hex usbbuffer[i], "-"
                      00969         DEBUGCOUNT?C    000h
                          M         MOVE?CB 000h, R4 + 1
                          M         CHK?RP  R4 + 1
                          M     if (((R4 + 1) & 8000h) != PREV_ALT)
                          M       if ((R4 + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R4 + 1) & 8000h
                          M     endif
                          M     if ((((R4 + 1) & 0fffh) > BANKA_END) & (((R4 + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R4 + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R4 + 1)
                          M PREV_BANK = high (R4 + 1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 313


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0022F0 6A0A               M         clrf    R4 + 1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    R4 + 1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   R4 + 1
                          M       endif
                          M     endif
                      00970         AOUT?BBB        _USBBuffer, _i, T1
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0022F2 5022               M         movf    _i,  W
0022F4 0F28               M         addlw   low (_USBBuffer)
0022F6 6EE9               M         movwf   FSR0L
0022F8 0E00               M         movlw   (_USBBuffer) >> 8
0022FA 6AEA               M         clrf    FSR0H
0022FC 22EA               M         addwfc  FSR0H, F
                          M         MOVE?BB INDF0, T1
0022FE CFEF F013          M         movff   INDF0, T1
                      00971         DEBUGNUM?B      T1
                          M         MOVE?BW T1,  R2
                          M         MOVE?BB T1,  R2
002302 C013 F005          M         movff   T1,  R2
                          M         CHK?RP  R2
                          M     if (((R2)    & 8000h) != PREV_ALT)
                          M       if ((R2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R2)    & 8000h
                          M     endif
                          M     if ((((R2)    & 0fffh) > BANKA_END) & (((R2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R2)
                          M PREV_BANK = high (R2)
                          M       endif
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 314


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002306 6A06               M         clrf    (R2)   + 1
                      00972         DEBUGHEX?       
                          M         MOVE?CW DEBUGJ, R8
                          M     ifdef USE_LINKER
                          M         CHK?RP  R8
                          M         movlw   low (DEBUGJ)
                          M         movwf   R8
                          M         movlw   high (DEBUGJ)
                          M         movwf   (R8)   + 1
                          M     else
                          M         MOVE?CB low (DEBUGJ), R8
                          M         CHK?RP  R8
                          M     if (((R8)    & 8000h) != PREV_ALT)
                          M       if ((R8)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (R8)    & 8000h
                          M     endif
                          M     if ((((R8)    & 0fffh) > BANKA_END) & (((R8)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R8)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R8)
                          M PREV_BANK = high (R8)
                          M       endif
                          M     endif
                          M     if (low (low (DEBUGJ)) == 0)
                          M         clrf    R8
                          M     else
                          M       if (low (low (DEBUGJ)) == 255)
                          M         setf    R8
                          M       else
002308 0E04               M         movlw   low (low (DEBUGJ))
00230A 6E11               M         movwf   R8
                          M       endif
                          M     endif
                          M         MOVE?CB high (DEBUGJ), (R8) + 1
                          M         CHK?RP  (R8) + 1
                          M     if ((((R8) + 1) & 8000h) != PREV_ALT)
                          M       if (((R8) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((R8) + 1) & 8000h
                          M     endif
                          M     if (((((R8) + 1) & 0fffh) > BANKA_END) & ((((R8) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((R8) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((R8) + 1)
                          M PREV_BANK = high ((R8) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (DEBUGJ)) == 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 315


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         clrf    (R8) + 1
                          M     else
                          M       if (low (high (DEBUGJ)) == 255)
                          M         setf    (R8) + 1
                          M       else
00230C 0E10               M         movlw   low (high (DEBUGJ))
00230E 6E12               M         movwf   (R8) + 1
                          M       endif
                          M     endif
                          M     endif
                          M         L?CALL  SEROUT2HEX
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    SEROUT2HEX
                          M     else
                          M       if ((SEROUT2HEX) < 1)
                          M         call    SEROUT2HEX
                          M       else
                          M         if ((SEROUT2HEX) > $)
                          M         call    SEROUT2HEX
                          M         else
                          M           if ((SEROUT2HEX) < ($ - 3ffh))
002310 EC1D F008          M         call    SEROUT2HEX
                          M           else
                          M         rcall   SEROUT2HEX
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00973         DEBUG?C 02Dh
002314 0E2D               M         movlw   02Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 316


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002316 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00974 
                      00975 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00219        pause 10
                      00976         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
00231A 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
00231C EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 317


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      00977 
                      00978 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00220      next
                      00979         NEXT?BCL        _i, 001h, L00051
                          M     if ((001h) == 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
002320 2A22               M         incf    _i,  F
                          M     else
                          M         movlw   001h
                          M         CHK?RP  _i
                          M         addwf   _i,  F
                          M     endif
                          M     if ((001h) <= 255)
                          M         BIT?GOTO 0, STATUS, C, L00051
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00051))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M       else
                          M         if ((L00051) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00051
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 318


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00051) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M           else
                          M             if ((L00051) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M             else
                          M         bov     L00051
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002322 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00051
                          M       else
                          M         if ((L00051) < 1)
                          M         goto    L00051
                          M         else
                          M           if ((L00051) > $)
                          M         goto    L00051
                          M           else
                          M             if ((L00051) < ($ - 3ffh))
                          M         goto    L00051
                          M             else
002324 D7DF               M         bra     L00051
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      00980         LABEL?L L00052  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 319


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00052
                          M         XALL
                          M     else
002326                    M L00052
                          M     endif
                      00981 
                      00982 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00221      debug 13,13
                      00983         DEBUG?C 00Dh
002326 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
002328 EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00984         DEBUG?C 00Dh
00232C 0E0D               M         movlw   00Dh
                          M         L?CALL  DEBUG
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 320


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DEBUG
                          M     else
                          M       if ((DEBUG) < 1)
                          M         call    DEBUG
                          M       else
                          M         if ((DEBUG) > $)
                          M         call    DEBUG
                          M         else
                          M           if ((DEBUG) < ($ - 3ffh))
00232E EC03 F008          M         call    DEBUG
                          M           else
                          M         rcall   DEBUG
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      00985 
                      00986 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00233      portb.0 = 1
                      00987         MOVE?CT 001h, _PORTB??0
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
002332 8081               M         bsf     PORTB,  000h
                          M     else
                          M         bcf     PORTB,  000h
                          M     endif
                      00988 
                      00989 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00234      pause 10
                      00990         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
002334 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 321


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
002336 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      00991 
                      00992 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00235      gosub DoUSBOut
                      00993         GOSUB?L _DoUSBOut
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBOut
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 322


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBOut
                          M     else
                          M       if ((_DoUSBOut) < 1)
                          M         call    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) > $)
00233A ECC8 F011          M         call    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) < ($ - 3ffh))
                          M         call    _DoUSBOut
                          M           else
                          M         rcall   _DoUSBOut
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00233E                    M dlabel
                      00994 
                      00995 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00236      portb.0 = 0
                      00996         MOVE?CT 000h, _PORTB??0
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  000h
                          M     else
00233E 9081               M         bcf     PORTB,  000h
                          M     endif
                      00997 
                      00998 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00237      pause 10
                      00999         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 323


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002340 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
002342 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01000 
                      01001 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00238      goto ProgramStart  
                      01002         GOTO?L  _ProgramStart
                          M         L?GOTO  _ProgramStart
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_ProgramStart))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 324


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _ProgramStart
                          M     else
                          M       if ((_ProgramStart) < 1)
                          M         goto    _ProgramStart
                          M       else
                          M         if ((_ProgramStart) > $)
                          M         goto    _ProgramStart
                          M         else
                          M           if ((_ProgramStart) < ($ - 3ffh))
002346 EF08 F00E          M         goto    _ProgramStart
                          M           else
                          M         bra     _ProgramStart
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01003 
                      01004 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00243   DoUSBIn:
                      01005 
                      01006         LABEL?L _DoUSBIn        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _DoUSBIn
                          M         XALL
                          M     else
00234A                    M _DoUSBIn
                          M     endif
                      01007 
                      01008 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00244      USBBufferCount = USBBufferSizeRX     
                                     ' RX buffer size
                      01009         MOVE?CB _USBBufferSizeRX, _USBBufferCount
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 325


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
                          M     if (low (_USBBufferSizeRX) == 0)
                          M         clrf    _USBBufferCount
                          M     else
                          M       if (low (_USBBufferSizeRX) == 255)
                          M         setf    _USBBufferCount
                          M       else
00234A 0E08               M         movlw   low (_USBBufferSizeRX)
00234C 6E26               M         movwf   _USBBufferCount
                          M       endif
                          M     endif
                      01010 
                      01011 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00245      USBService                           
                                     ' keep connection alive
                      01012         USBSERVICE?     
                          M         L?CALL  USBDeviceTasks  ; Interrupt or polling method
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceTasks
                          M     else
                          M       if ((USBDeviceTasks) < 1)
                          M         call    USBDeviceTasks
                          M       else
                          M         if ((USBDeviceTasks) > $)
                          M         call    USBDeviceTasks
                          M         else
                          M           if ((USBDeviceTasks) < ($ - 3ffh))
00234E ECDF F008          M         call    USBDeviceTasks
                          M           else
                          M         rcall   USBDeviceTasks
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 326


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
002352 ECB6 F008          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01013 
                      01014 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00246      portb.4 = 1
                      01015         MOVE?CT 001h, _PORTB??4
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
002356 8881               M         bsf     PORTB,  004h
                          M     else
                          M         bcf     PORTB,  004h
                          M     endif
                      01016 
                      01017 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00247      pause 10
                      01018         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
002358 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 327


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
00235A EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01019 
                      01020 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00248      portb.4 = 0
                      01021         MOVE?CT 000h, _PORTB??4
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  004h
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 328


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00235E 9881               M         bcf     PORTB,  004h
                          M     endif
                      01022 
                      01023 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00249      pause 10
                      01024         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
002360 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
002362 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01025 
                      01026 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00250      USBIn 1, USBBuffer, USBBufferCount, D
                            oUSBIn   ' read data, if available
                      01027         USBIN?CBBL      001h, _USBBuffer, _USBBufferCount, _DoUSBIn
                          M         MOVE?CB 001h,     FSR0L ; Store Endpoint number
                          M         CHK?RP  FSR0L
                          M     if (((FSR0L) & 8000h) != PREV_ALT)
                          M       if ((FSR0L) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 329


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (FSR0L) & 8000h
                          M     endif
                          M     if ((((FSR0L) & 0fffh) > BANKA_END) & (((FSR0L) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((FSR0L) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (FSR0L)
                          M PREV_BANK = high (FSR0L)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    FSR0L
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    FSR0L
                          M       else
002366 0E01               M         movlw   low (001h)
002368 6EE9               M         movwf   FSR0L
                          M       endif
                          M     endif
00236A EE10 F028          M         lfsr    1, _USBBuffer   ; Point to Buffer
                          M         MOVE?BA _USBBufferCount ; Max allowed length to W
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
00236E 5026               M         movf    _USBBufferCount, W
                          M         L?CALL  GetUSB          ; Do the get
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    GetUSB
                          M     else
                          M       if ((GetUSB) < 1)
                          M         call    GetUSB
                          M       else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 330


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if ((GetUSB) > $)
                          M         call    GetUSB
                          M         else
                          M           if ((GetUSB) < ($ - 3ffh))
002370 ECDC F00B          M         call    GetUSB
                          M           else
                          M         rcall   GetUSB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
002374 ECB6 F008          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB _USBBufferCount ; Store number of bytes received
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 331


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
002378 6E26               M         movwf   _USBBufferCount
                          M         BIT?GOTO 0, STATUS, C, _DoUSBIn ; If nothing received then jump to Label
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_DoUSBIn))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBIn
                          M       else
                          M         if ((_DoUSBIn) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBIn
                          M         else
                          M           if ((_DoUSBIn) > $)
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBIn
                          M           else
                          M             if ((_DoUSBIn) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBIn
                          M             else
                          M         bov     _DoUSBIn
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 332


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
00237A A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    _DoUSBIn
                          M       else
                          M         if ((_DoUSBIn) < 1)
                          M         goto    _DoUSBIn
                          M         else
                          M           if ((_DoUSBIn) > $)
                          M         goto    _DoUSBIn
                          M           else
                          M             if ((_DoUSBIn) < ($ - 3ffh))
                          M         goto    _DoUSBIn
                          M             else
00237C D7E6               M         bra     _DoUSBIn
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01028 
                      01029 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00251      portb.5 = 1
                      01030         MOVE?CT 001h, _PORTB??5
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00237E 8A81               M         bsf     PORTB,  005h
                          M     else
                          M         bcf     PORTB,  005h
                          M     endif
                      01031 
                      01032 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00252      pause 10
                      01033         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
002380 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 333


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
002382 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01034 
                      01035 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00253      portb.5 = 0
                      01036         MOVE?CT 000h, _PORTB??5
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  005h
                          M     else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 334


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002386 9A81               M         bcf     PORTB,  005h
                          M     endif
                      01037 
                      01038 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00254      pause 10
                      01039         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
002388 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
00238A EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01040 
                      01041 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00255      return
                      01042         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 335


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
00238E 0012               M         return
                      01043 
                      01044 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00260   DoUSBOut:
                      01045 
                      01046         LABEL?L _DoUSBOut       
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _DoUSBOut
                          M         XALL
                          M     else
002390                    M _DoUSBOut
                          M     endif
                      01047 
                      01048 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00261      USBBufferCount = USBBufferSizeTX     
                                     ' TX buffer size
                      01049         MOVE?CB _USBBufferSizeTX, _USBBufferCount
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
                          M     if (low (_USBBufferSizeTX) == 0)
                          M         clrf    _USBBufferCount
                          M     else
                          M       if (low (_USBBufferSizeTX) == 255)
                          M         setf    _USBBufferCount
                          M       else
002390 0E08               M         movlw   low (_USBBufferSizeTX)
002392 6E26               M         movwf   _USBBufferCount
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 336


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01050 
                      01051 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00262      USBService                           
                                     ' keep connection alive
                      01052         USBSERVICE?     
                          M         L?CALL  USBDeviceTasks  ; Interrupt or polling method
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceTasks
                          M     else
                          M       if ((USBDeviceTasks) < 1)
                          M         call    USBDeviceTasks
                          M       else
                          M         if ((USBDeviceTasks) > $)
                          M         call    USBDeviceTasks
                          M         else
                          M           if ((USBDeviceTasks) < ($ - 3ffh))
002394 ECDF F008          M         call    USBDeviceTasks
                          M           else
                          M         rcall   USBDeviceTasks
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 337


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((DUNN)  < ($ - 3ffh))
002398 ECB6 F008          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01053 
                      01054 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00263      portb.6 = 1
                      01055         MOVE?CT 001h, _PORTB??6
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00239C 8C81               M         bsf     PORTB,  006h
                          M     else
                          M         bcf     PORTB,  006h
                          M     endif
                      01056 
                      01057 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00264      pause 10
                      01058         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
00239E 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 338


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
0023A0 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01059 
                      01060 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00265      portb.6 = 0
                      01061         MOVE?CT 000h, _PORTB??6
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  006h
                          M     else
0023A4 9C81               M         bcf     PORTB,  006h
                          M     endif
                      01062 
                      01063 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00266      pause 10
                      01064         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
0023A6 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 339


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
0023A8 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01065 
                      01066 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00267      USBOut 1, USBBuffer, USBBufferCount, 
                            DoUSBOut ' if bus available, transmit data
                      01067         USBOUT?CBBL     001h, _USBBuffer, _USBBufferCount, _DoUSBOut
                          M         MOVE?CB 001h,     FSR0L ; Store Endpoint number
                          M         CHK?RP  FSR0L
                          M     if (((FSR0L) & 8000h) != PREV_ALT)
                          M       if ((FSR0L) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (FSR0L) & 8000h
                          M     endif
                          M     if ((((FSR0L) & 0fffh) > BANKA_END) & (((FSR0L) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((FSR0L) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (FSR0L)
                          M PREV_BANK = high (FSR0L)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    FSR0L
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    FSR0L
                          M       else
0023AC 0E01               M         movlw   low (001h)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 340


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0023AE 6EE9               M         movwf   FSR0L
                          M       endif
                          M     endif
0023B0 EE10 F028          M         lfsr    1, _USBBuffer   ; Point to Buffer
                          M         MOVE?BA _USBBufferCount ; Get number of bytes to send
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
0023B4 5026               M         movf    _USBBufferCount, W
                          M         L?CALL  PutUSB          ; Send them
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PutUSB
                          M     else
                          M       if ((PutUSB) < 1)
                          M         call    PutUSB
                          M       else
                          M         if ((PutUSB) > $)
                          M         call    PutUSB
                          M         else
                          M           if ((PutUSB) < ($ - 3ffh))
0023B6 EC07 F00C          M         call    PutUSB
                          M           else
                          M         rcall   PutUSB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 341


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
0023BA ECB6 F008          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, C, _DoUSBOut ; If can't send then jump to Label
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_DoUSBOut))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) > $)
                          M         btfsc   STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 342


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    _DoUSBOut
                          M           else
                          M             if ((_DoUSBOut) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M             else
                          M         bov     _DoUSBOut
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0023BE A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) < 1)
                          M         goto    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) > $)
                          M         goto    _DoUSBOut
                          M           else
                          M             if ((_DoUSBOut) < ($ - 3ffh))
                          M         goto    _DoUSBOut
                          M             else
0023C0 D7E7               M         bra     _DoUSBOut
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01068 
                      01069 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00268      portb.7 = 1
                      01070         MOVE?CT 001h, _PORTB??7
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 343


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0023C2 8E81               M         bsf     PORTB,  007h
                          M     else
                          M         bcf     PORTB,  007h
                          M     endif
                      01071 
                      01072 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00269      pause 10
                      01073         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
0023C4 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
0023C6 EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 344


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01074 
                      01075 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00270      portb.7 = 0
                      01076         MOVE?CT 000h, _PORTB??7
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTB,  007h
                          M     else
0023CA 9E81               M         bcf     PORTB,  007h
                          M     endif
                      01077 
                      01078 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00271      pause 10
                      01079         PAUSE?C 00Ah
                          M     if (((00Ah) >> 8) == 0)
                          M         MOVE?CA 00Ah
0023CC 0E0A               M         movlw   low (00Ah)
                          M         L?CALL  PAUSE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSE
                          M     else
                          M       if ((PAUSE) < 1)
                          M         call    PAUSE
                          M       else
                          M         if ((PAUSE) > $)
                          M         call    PAUSE
                          M         else
                          M           if ((PAUSE) < ($ - 3ffh))
0023CE EC40 F008          M         call    PAUSE
                          M           else
                          M         rcall   PAUSE
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 345


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (00Ah) >> 8, R1 + 1
                          M         MOVE?CA low (00Ah)
                          M         L?CALL  PAUSEL
                          M     endif
                      01080 
                      01081 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00272      return
                      01082         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
0023D2 0012               M         return
                      01083 
                      01084 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00274   buscar1:
                      01085 
                      01086         LABEL?L _buscar1        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar1
                          M         XALL
                          M     else
0023D4                    M _buscar1
                          M     endif
                      01087 
                      01088 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00275     lookup aux,[1,8,3,2,3,3,4,2],var1
                      01089         LOOKUP?BCLB     _aux, 008h, L00001, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 346


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
0023D4 5021               M         movf    _aux, W
0023D6 6EF6               M         movwf   TBLPTRL
0023D8 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00001
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00001))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M       else
                          M         if ((L00001) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M         else
                          M           if ((L00001) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M           else
                          M             if ((L00001) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M             else
                          M         bov     L00001
                          M             endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 347


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0023DA A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00001
                          M       else
                          M         if ((L00001) < 1)
                          M         goto    L00001
                          M         else
                          M           if ((L00001) > $)
0023DC EF08 F012          M         goto    L00001
                          M           else
                          M             if ((L00001) < ($ - 3ffh))
                          M         goto    L00001
                          M             else
                          M         bra     L00001
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0023E0 6AF7               M         clrf    TBLPTRH
0023E2 6AF8               M         clrf    TBLPTRU
0023E4 90D8               M         bcf     STATUS, C
0023E6 36F6               M         rlcf    TBLPTRL, F
0023E8 36F7               M         rlcf    TBLPTRH, F
0023EA 0E00               M         movlw   low (valtbl)
0023EC 26F6               M         addwf   TBLPTRL, F
0023EE 0E24               M         movlw   high (valtbl)
0023F0 22F7               M         addwfc  TBLPTRH, F
0023F2 0E00               M         movlw   upper (valtbl)
0023F4 22F8               M         addwfc  TBLPTRU, F
0023F6 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
0023F8 CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00001
                          M     ifdef USE_LINKER
                          M         CLRWDT?
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 348


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ($ == (L00001))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00001
                          M     else
                          M       if ((L00001) < 1)
                          M         goto    L00001
                          M       else
                          M         if ((L00001) > $)
0023FC EF08 F012          M         goto    L00001
                          M         else
                          M           if ((L00001) < ($ - 3ffh))
                          M         goto    L00001
                          M           else
                          M         bra     L00001
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002400                    M valtbl
                      01090         LURET?C 001h
002400 0C01               M         retlw   001h
                      01091         LURET?C 008h
002402 0C08               M         retlw   008h
                      01092         LURET?C 003h
002404 0C03               M         retlw   003h
                      01093         LURET?C 002h
002406 0C02               M         retlw   002h
                      01094         LURET?C 003h
002408 0C03               M         retlw   003h
                      01095         LURET?C 003h
00240A 0C03               M         retlw   003h
                      01096         LURET?C 004h
00240C 0C04               M         retlw   004h
                      01097         LURET?C 002h
00240E 0C02               M         retlw   002h
                      01098 
                      01099         LABEL?L L00001  
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 349


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00001
                          M         XALL
                          M     else
002410                    M L00001
                          M     endif
                      01100 
                      01101 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00276   return 
                      01102         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
002410 0012               M         return
                      01103 
                      01104 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00277   buscar2:
                      01105 
                      01106         LABEL?L _buscar2        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar2
                          M         XALL
                          M     else
002412                    M _buscar2
                          M     endif
                      01107 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 350


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01108 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00278     lookup aux,[8,2,5,4,7,4,3,6],var1
                      01109         LOOKUP?BCLB     _aux, 008h, L00002, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
002412 5021               M         movf    _aux, W
002414 6EF6               M         movwf   TBLPTRL
002416 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00002
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00002))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00002
                          M       else
                          M         if ((L00002) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00002
                          M         else
                          M           if ((L00002) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00002
                          M           else
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 351


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             if ((L00002) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00002
                          M             else
                          M         bov     L00002
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002418 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00002
                          M       else
                          M         if ((L00002) < 1)
                          M         goto    L00002
                          M         else
                          M           if ((L00002) > $)
00241A EF27 F012          M         goto    L00002
                          M           else
                          M             if ((L00002) < ($ - 3ffh))
                          M         goto    L00002
                          M             else
                          M         bra     L00002
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00241E 6AF7               M         clrf    TBLPTRH
002420 6AF8               M         clrf    TBLPTRU
002422 90D8               M         bcf     STATUS, C
002424 36F6               M         rlcf    TBLPTRL, F
002426 36F7               M         rlcf    TBLPTRH, F
002428 0E3E               M         movlw   low (valtbl)
00242A 26F6               M         addwf   TBLPTRL, F
00242C 0E24               M         movlw   high (valtbl)
00242E 22F7               M         addwfc  TBLPTRH, F
002430 0E00               M         movlw   upper (valtbl)
002432 22F8               M         addwfc  TBLPTRU, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 352


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002434 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
002436 CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00002
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00002))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00002
                          M     else
                          M       if ((L00002) < 1)
                          M         goto    L00002
                          M       else
                          M         if ((L00002) > $)
00243A EF27 F012          M         goto    L00002
                          M         else
                          M           if ((L00002) < ($ - 3ffh))
                          M         goto    L00002
                          M           else
                          M         bra     L00002
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00243E                    M valtbl
                      01110         LURET?C 008h
00243E 0C08               M         retlw   008h
                      01111         LURET?C 002h
002440 0C02               M         retlw   002h
                      01112         LURET?C 005h
002442 0C05               M         retlw   005h
                      01113         LURET?C 004h
002444 0C04               M         retlw   004h
                      01114         LURET?C 007h
002446 0C07               M         retlw   007h
                      01115         LURET?C 004h
002448 0C04               M         retlw   004h
                      01116         LURET?C 003h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 353


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00244A 0C03               M         retlw   003h
                      01117         LURET?C 006h
00244C 0C06               M         retlw   006h
                      01118 
                      01119         LABEL?L L00002  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00002
                          M         XALL
                          M     else
00244E                    M L00002
                          M     endif
                      01120 
                      01121 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00279   return 
                      01122         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
00244E 0012               M         return
                      01123 
                      01124 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00280   buscar3:
                      01125 
                      01126         LABEL?L _buscar3        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 354


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M _buscar3
                          M         XALL
                          M     else
002450                    M _buscar3
                          M     endif
                      01127 
                      01128 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00281     lookup aux,[3,7,8,7,5,1,2,9],var1
                      01129         LOOKUP?BCLB     _aux, 008h, L00003, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
002450 5021               M         movf    _aux, W
002452 6EF6               M         movwf   TBLPTRL
002454 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00003
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00003))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M       else
                          M         if ((L00003) < 1)
                          M         btfsc   STATUS, OV
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 355


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00003
                          M         else
                          M           if ((L00003) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M           else
                          M             if ((L00003) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M             else
                          M         bov     L00003
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002456 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00003
                          M       else
                          M         if ((L00003) < 1)
                          M         goto    L00003
                          M         else
                          M           if ((L00003) > $)
002458 EF46 F012          M         goto    L00003
                          M           else
                          M             if ((L00003) < ($ - 3ffh))
                          M         goto    L00003
                          M             else
                          M         bra     L00003
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00245C 6AF7               M         clrf    TBLPTRH
00245E 6AF8               M         clrf    TBLPTRU
002460 90D8               M         bcf     STATUS, C
002462 36F6               M         rlcf    TBLPTRL, F
002464 36F7               M         rlcf    TBLPTRH, F
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 356


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002466 0E7C               M         movlw   low (valtbl)
002468 26F6               M         addwf   TBLPTRL, F
00246A 0E24               M         movlw   high (valtbl)
00246C 22F7               M         addwfc  TBLPTRH, F
00246E 0E00               M         movlw   upper (valtbl)
002470 22F8               M         addwfc  TBLPTRU, F
002472 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
002474 CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00003
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00003))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00003
                          M     else
                          M       if ((L00003) < 1)
                          M         goto    L00003
                          M       else
                          M         if ((L00003) > $)
002478 EF46 F012          M         goto    L00003
                          M         else
                          M           if ((L00003) < ($ - 3ffh))
                          M         goto    L00003
                          M           else
                          M         bra     L00003
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00247C                    M valtbl
                      01130         LURET?C 003h
00247C 0C03               M         retlw   003h
                      01131         LURET?C 007h
00247E 0C07               M         retlw   007h
                      01132         LURET?C 008h
002480 0C08               M         retlw   008h
                      01133         LURET?C 007h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 357


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002482 0C07               M         retlw   007h
                      01134         LURET?C 005h
002484 0C05               M         retlw   005h
                      01135         LURET?C 001h
002486 0C01               M         retlw   001h
                      01136         LURET?C 002h
002488 0C02               M         retlw   002h
                      01137         LURET?C 009h
00248A 0C09               M         retlw   009h
                      01138 
                      01139         LABEL?L L00003  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00003
                          M         XALL
                          M     else
00248C                    M L00003
                          M     endif
                      01140 
                      01141 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00282   return 
                      01142         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
00248C 0012               M         return
                      01143 
                      01144 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00283   buscar4:
                      01145 
                      01146         LABEL?L _buscar4        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 358


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar4
                          M         XALL
                          M     else
00248E                    M _buscar4
                          M     endif
                      01147 
                      01148 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00284     lookup aux,[2,6,7,3,1,6,5,1],var1
                      01149         LOOKUP?BCLB     _aux, 008h, L00004, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
00248E 5021               M         movf    _aux, W
002490 6EF6               M         movwf   TBLPTRL
002492 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00004
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00004))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 359


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00004
                          M       else
                          M         if ((L00004) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00004
                          M         else
                          M           if ((L00004) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00004
                          M           else
                          M             if ((L00004) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00004
                          M             else
                          M         bov     L00004
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002494 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00004
                          M       else
                          M         if ((L00004) < 1)
                          M         goto    L00004
                          M         else
                          M           if ((L00004) > $)
002496 EF65 F012          M         goto    L00004
                          M           else
                          M             if ((L00004) < ($ - 3ffh))
                          M         goto    L00004
                          M             else
                          M         bra     L00004
                          M             endif
                          M           endif
                          M         endif
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 360


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
00249A 6AF7               M         clrf    TBLPTRH
00249C 6AF8               M         clrf    TBLPTRU
00249E 90D8               M         bcf     STATUS, C
0024A0 36F6               M         rlcf    TBLPTRL, F
0024A2 36F7               M         rlcf    TBLPTRH, F
0024A4 0EBA               M         movlw   low (valtbl)
0024A6 26F6               M         addwf   TBLPTRL, F
0024A8 0E24               M         movlw   high (valtbl)
0024AA 22F7               M         addwfc  TBLPTRH, F
0024AC 0E00               M         movlw   upper (valtbl)
0024AE 22F8               M         addwfc  TBLPTRU, F
0024B0 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
0024B2 CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00004
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00004))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00004
                          M     else
                          M       if ((L00004) < 1)
                          M         goto    L00004
                          M       else
                          M         if ((L00004) > $)
0024B6 EF65 F012          M         goto    L00004
                          M         else
                          M           if ((L00004) < ($ - 3ffh))
                          M         goto    L00004
                          M           else
                          M         bra     L00004
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0024BA                    M valtbl
                      01150         LURET?C 002h
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 361


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0024BA 0C02               M         retlw   002h
                      01151         LURET?C 006h
0024BC 0C06               M         retlw   006h
                      01152         LURET?C 007h
0024BE 0C07               M         retlw   007h
                      01153         LURET?C 003h
0024C0 0C03               M         retlw   003h
                      01154         LURET?C 001h
0024C2 0C01               M         retlw   001h
                      01155         LURET?C 006h
0024C4 0C06               M         retlw   006h
                      01156         LURET?C 005h
0024C6 0C05               M         retlw   005h
                      01157         LURET?C 001h
0024C8 0C01               M         retlw   001h
                      01158 
                      01159         LABEL?L L00004  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00004
                          M         XALL
                          M     else
0024CA                    M L00004
                          M     endif
                      01160 
                      01161 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00285   return 
                      01162         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
0024CA 0012               M         return
                      01163 
                      01164 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00286   buscar5:
                      01165 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 362


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01166         LABEL?L _buscar5        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar5
                          M         XALL
                          M     else
0024CC                    M _buscar5
                          M     endif
                      01167 
                      01168 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00287     lookup aux,[9,8,1,2,3,5,4,2],var1
                      01169         LOOKUP?BCLB     _aux, 008h, L00005, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
0024CC 5021               M         movf    _aux, W
0024CE 6EF6               M         movwf   TBLPTRL
0024D0 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00005
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00005))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 363


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M       else
                          M         if ((L00005) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M         else
                          M           if ((L00005) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M           else
                          M             if ((L00005) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M             else
                          M         bov     L00005
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0024D2 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00005
                          M       else
                          M         if ((L00005) < 1)
                          M         goto    L00005
                          M         else
                          M           if ((L00005) > $)
0024D4 EF84 F012          M         goto    L00005
                          M           else
                          M             if ((L00005) < ($ - 3ffh))
                          M         goto    L00005
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 364


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bra     L00005
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0024D8 6AF7               M         clrf    TBLPTRH
0024DA 6AF8               M         clrf    TBLPTRU
0024DC 90D8               M         bcf     STATUS, C
0024DE 36F6               M         rlcf    TBLPTRL, F
0024E0 36F7               M         rlcf    TBLPTRH, F
0024E2 0EF8               M         movlw   low (valtbl)
0024E4 26F6               M         addwf   TBLPTRL, F
0024E6 0E24               M         movlw   high (valtbl)
0024E8 22F7               M         addwfc  TBLPTRH, F
0024EA 0E00               M         movlw   upper (valtbl)
0024EC 22F8               M         addwfc  TBLPTRU, F
0024EE 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
0024F0 CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00005
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00005))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00005
                          M     else
                          M       if ((L00005) < 1)
                          M         goto    L00005
                          M       else
                          M         if ((L00005) > $)
0024F4 EF84 F012          M         goto    L00005
                          M         else
                          M           if ((L00005) < ($ - 3ffh))
                          M         goto    L00005
                          M           else
                          M         bra     L00005
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 365


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
0024F8                    M valtbl
                      01170         LURET?C 009h
0024F8 0C09               M         retlw   009h
                      01171         LURET?C 008h
0024FA 0C08               M         retlw   008h
                      01172         LURET?C 001h
0024FC 0C01               M         retlw   001h
                      01173         LURET?C 002h
0024FE 0C02               M         retlw   002h
                      01174         LURET?C 003h
002500 0C03               M         retlw   003h
                      01175         LURET?C 005h
002502 0C05               M         retlw   005h
                      01176         LURET?C 004h
002504 0C04               M         retlw   004h
                      01177         LURET?C 002h
002506 0C02               M         retlw   002h
                      01178 
                      01179         LABEL?L L00005  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00005
                          M         XALL
                          M     else
002508                    M L00005
                          M     endif
                      01180 
                      01181 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00288   return 
                      01182         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 366


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
002508 0012               M         return
                      01183 
                      01184 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00289   buscar6:
                      01185 
                      01186         LABEL?L _buscar6        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar6
                          M         XALL
                          M     else
00250A                    M _buscar6
                          M     endif
                      01187 
                      01188 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00290     lookup aux,[8,1,1,4,5,4,3,6],var1
                      01189         LOOKUP?BCLB     _aux, 008h, L00006, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
00250A 5021               M         movf    _aux, W
00250C 6EF6               M         movwf   TBLPTRL
00250E 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00006
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00006))
                          M         CLRWDT?
                          M       endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 367


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00006
                          M       else
                          M         if ((L00006) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00006
                          M         else
                          M           if ((L00006) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00006
                          M           else
                          M             if ((L00006) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00006
                          M             else
                          M         bov     L00006
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
002510 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00006
                          M       else
                          M         if ((L00006) < 1)
                          M         goto    L00006
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 368


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00006) > $)
002512 EFA3 F012          M         goto    L00006
                          M           else
                          M             if ((L00006) < ($ - 3ffh))
                          M         goto    L00006
                          M             else
                          M         bra     L00006
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002516 6AF7               M         clrf    TBLPTRH
002518 6AF8               M         clrf    TBLPTRU
00251A 90D8               M         bcf     STATUS, C
00251C 36F6               M         rlcf    TBLPTRL, F
00251E 36F7               M         rlcf    TBLPTRH, F
002520 0E36               M         movlw   low (valtbl)
002522 26F6               M         addwf   TBLPTRL, F
002524 0E25               M         movlw   high (valtbl)
002526 22F7               M         addwfc  TBLPTRH, F
002528 0E00               M         movlw   upper (valtbl)
00252A 22F8               M         addwfc  TBLPTRU, F
00252C 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
00252E CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00006
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00006))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00006
                          M     else
                          M       if ((L00006) < 1)
                          M         goto    L00006
                          M       else
                          M         if ((L00006) > $)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 369


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002532 EFA3 F012          M         goto    L00006
                          M         else
                          M           if ((L00006) < ($ - 3ffh))
                          M         goto    L00006
                          M           else
                          M         bra     L00006
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002536                    M valtbl
                      01190         LURET?C 008h
002536 0C08               M         retlw   008h
                      01191         LURET?C 001h
002538 0C01               M         retlw   001h
                      01192         LURET?C 001h
00253A 0C01               M         retlw   001h
                      01193         LURET?C 004h
00253C 0C04               M         retlw   004h
                      01194         LURET?C 005h
00253E 0C05               M         retlw   005h
                      01195         LURET?C 004h
002540 0C04               M         retlw   004h
                      01196         LURET?C 003h
002542 0C03               M         retlw   003h
                      01197         LURET?C 006h
002544 0C06               M         retlw   006h
                      01198 
                      01199         LABEL?L L00006  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00006
                          M         XALL
                          M     else
002546                    M L00006
                          M     endif
                      01200 
                      01201 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00291   return 
                      01202         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 370


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
002546 0012               M         return
                      01203 
                      01204 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00292   buscar7:
                      01205 
                      01206         LABEL?L _buscar7        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar7
                          M         XALL
                          M     else
002548                    M _buscar7
                          M     endif
                      01207 
                      01208 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00293     lookup aux,[3,2,8,2,5,1,2,9],var1
                      01209         LOOKUP?BCLB     _aux, 008h, L00007, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
                          M       endif
                          M     endif
002548 5021               M         movf    _aux, W
00254A 6EF6               M         movwf   TBLPTRL
00254C 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00007
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 371


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00007))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M       else
                          M         if ((L00007) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M         else
                          M           if ((L00007) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M           else
                          M             if ((L00007) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M             else
                          M         bov     L00007
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00254E A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 372


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00007
                          M       else
                          M         if ((L00007) < 1)
                          M         goto    L00007
                          M         else
                          M           if ((L00007) > $)
002550 EFC2 F012          M         goto    L00007
                          M           else
                          M             if ((L00007) < ($ - 3ffh))
                          M         goto    L00007
                          M             else
                          M         bra     L00007
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002554 6AF7               M         clrf    TBLPTRH
002556 6AF8               M         clrf    TBLPTRU
002558 90D8               M         bcf     STATUS, C
00255A 36F6               M         rlcf    TBLPTRL, F
00255C 36F7               M         rlcf    TBLPTRH, F
00255E 0E74               M         movlw   low (valtbl)
002560 26F6               M         addwf   TBLPTRL, F
002562 0E25               M         movlw   high (valtbl)
002564 22F7               M         addwfc  TBLPTRH, F
002566 0E00               M         movlw   upper (valtbl)
002568 22F8               M         addwfc  TBLPTRU, F
00256A 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
00256C CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00007
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00007))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 373


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00007
                          M     else
                          M       if ((L00007) < 1)
                          M         goto    L00007
                          M       else
                          M         if ((L00007) > $)
002570 EFC2 F012          M         goto    L00007
                          M         else
                          M           if ((L00007) < ($ - 3ffh))
                          M         goto    L00007
                          M           else
                          M         bra     L00007
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002574                    M valtbl
                      01210         LURET?C 003h
002574 0C03               M         retlw   003h
                      01211         LURET?C 002h
002576 0C02               M         retlw   002h
                      01212         LURET?C 008h
002578 0C08               M         retlw   008h
                      01213         LURET?C 002h
00257A 0C02               M         retlw   002h
                      01214         LURET?C 005h
00257C 0C05               M         retlw   005h
                      01215         LURET?C 001h
00257E 0C01               M         retlw   001h
                      01216         LURET?C 002h
002580 0C02               M         retlw   002h
                      01217         LURET?C 009h
002582 0C09               M         retlw   009h
                      01218 
                      01219         LABEL?L L00007  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00007
                          M         XALL
                          M     else
002584                    M L00007
                          M     endif
                      01220 
                      01221 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00294   return 
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 374


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01222         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
002584 0012               M         return
                      01223 
                      01224 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00295   buscar8:
                      01225 
                      01226         LABEL?L _buscar8        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _buscar8
                          M         XALL
                          M     else
002586                    M _buscar8
                          M     endif
                      01227 
                      01228 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00296     lookup aux,[1,2,7,3,5,6,5,1],var1
                      01229         LOOKUP?BCLB     _aux, 008h, L00008, _var1
  0000                    M     local valtbl
                          M         MOVE?BA _aux
                          M         CHK?RP  _aux
                          M     if (((_aux)  & 8000h) != PREV_ALT)
                          M       if ((_aux)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_aux)  & 8000h
                          M     endif
                          M     if ((((_aux)  & 0fffh) > BANKA_END) & (((_aux)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_aux)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_aux)
                          M PREV_BANK = high (_aux)
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 375


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
002586 5021               M         movf    _aux, W
002588 6EF6               M         movwf   TBLPTRL
00258A 0807               M         sublw   (008h) - 1
                          M         BIT?GOTO 0, STATUS, C, L00008
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00008))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00008
                          M       else
                          M         if ((L00008) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00008
                          M         else
                          M           if ((L00008) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00008
                          M           else
                          M             if ((L00008) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00008
                          M             else
                          M         bov     L00008
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 376


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00258C A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00008
                          M       else
                          M         if ((L00008) < 1)
                          M         goto    L00008
                          M         else
                          M           if ((L00008) > $)
00258E EFE1 F012          M         goto    L00008
                          M           else
                          M             if ((L00008) < ($ - 3ffh))
                          M         goto    L00008
                          M             else
                          M         bra     L00008
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
002592 6AF7               M         clrf    TBLPTRH
002594 6AF8               M         clrf    TBLPTRU
002596 90D8               M         bcf     STATUS, C
002598 36F6               M         rlcf    TBLPTRL, F
00259A 36F7               M         rlcf    TBLPTRH, F
00259C 0EB2               M         movlw   low (valtbl)
00259E 26F6               M         addwf   TBLPTRL, F
0025A0 0E25               M         movlw   high (valtbl)
0025A2 22F7               M         addwfc  TBLPTRH, F
0025A4 0E00               M         movlw   upper (valtbl)
0025A6 22F8               M         addwfc  TBLPTRU, F
0025A8 0008               M         tblrd   *
                          M         MOVE?BB TABLAT, _var1
0025AA CFF5 F027          M         movff   TABLAT, _var1
                          M         L?GOTO  L00008
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00008))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 377


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00008
                          M     else
                          M       if ((L00008) < 1)
                          M         goto    L00008
                          M       else
                          M         if ((L00008) > $)
0025AE EFE1 F012          M         goto    L00008
                          M         else
                          M           if ((L00008) < ($ - 3ffh))
                          M         goto    L00008
                          M           else
                          M         bra     L00008
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0025B2                    M valtbl
                      01230         LURET?C 001h
0025B2 0C01               M         retlw   001h
                      01231         LURET?C 002h
0025B4 0C02               M         retlw   002h
                      01232         LURET?C 007h
0025B6 0C07               M         retlw   007h
                      01233         LURET?C 003h
0025B8 0C03               M         retlw   003h
                      01234         LURET?C 005h
0025BA 0C05               M         retlw   005h
                      01235         LURET?C 006h
0025BC 0C06               M         retlw   006h
                      01236         LURET?C 005h
0025BE 0C05               M         retlw   005h
                      01237         LURET?C 001h
0025C0 0C01               M         retlw   001h
                      01238 
                      01239         LABEL?L L00008  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00008
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 378


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
0025C2                    M L00008
                          M     endif
                      01240 
                      01241 ; C:\HIRO\ELECTR~1\USBPRO~1\OLIVIA~1\ORIGUS~1.PBP       00297   return 
                      01242         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
0025C2 0012               M         return
                      01243 
                      01244         END
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 379


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ABDEN                             00000000
ABDOVF                            00000007
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ACTVIE                            00000002
ACTVIF                            00000002
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADC_BITS                          00000008
ADC_CLOCK                         00000003
ADC_SAMPLEUS                      00000032
ADD?BBW                           
ADD?BCW                           
ADDEN                             00000003
ADDR0                             00000000
ADDR1                             00000001
ADDR2                             00000002
ADDR3                             00000003
ADDR4                             00000004
ADDR5                             00000005
ADDR6                             00000006
ADDRESS_STATE                     0x10
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
ADRH                              3
ADRL                              2
ADR_PENDING_STATE                 0x08
AIN?BBW                           
AIN?WBB                           
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000003
AN4                               00000005
AOUT?BBB                          
ASM?                              
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 380


SYMBOL TABLE
  LABEL                             VALUE 

ATTACHED_STATE                    0x01
BANK0_END                         000000FF
BANK0_START                       00000060
BANK1_END                         000001FF
BANK1_START                       00000100
BANK2_END                         000002FF
BANK2_START                       00000200
BANK3_END                         000003FF
BANK3_START                       00000300
BANK4_END                         000004FF
BANK4_START                       00000400
BANK5_END                         000005FF
BANK5_START                       00000500
BANK6_END                         000006FF
BANK6_START                       00000600
BANK7_END                         000007FF
BANK7_START                       00000700
BANKA_END                         0000005F
BANKA_START                       00000000
BANKED                            00000001
BAUDCON                           00000FB8
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BF                                00000000
BGST                              00000005
BIT?FLIP                          
BIT?GOTO                          
BIT?R1                            
BIT?R2                            
BIT?W                             
BLOCK_SIZE                        00000020
BOOT_INTF_SUBCLASS                0x01
BOOT_PROTOCOL                     0x00
BOR                               00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000FE0
BSTALL                            2
BTOEE                             00000004
BTOEF                             00000004
BTSEE                             00000007
BTSEF                             00000007
BUTTON_PAUSE                      0000000A
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1                              00000002
CCP1AS                            00000FB6
CCP1CON                           00000FBD
CCP1DEL                           00000FB7
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 381


SYMBOL TABLE
  LABEL                             VALUE 

CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1_BIT                          00000002
CCP1_REG                          00000F82
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2_BIT                          00000001
CCP2_REG                          00000F82
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CFGS                              00000006
CHK?RP                            
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CIS                               00000003
CK                                00000006
CKE                               00000006
CKP                               00000004
CLASS                             0x01
CLRWDT?                           
CLRWDT?NOP                        
CLR_FEATURE                       1
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
CMIP                              00000006
CMP                               000010C6
CMPEQ?BCB                         
CMPF?WL                           
CMPGE                             000010B6
CMPGE?BCB                         
CMPGEB                            000010B2
CMPGEB_USED                       00000001
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 382


SYMBOL TABLE
  LABEL                             VALUE 

CMPGEW                            000010B4
CMPGEW_USED                       00000001
CMPGE_USED                        00000001
CMPGT?BCL                         
CMPLE                             000010C0
CMPLE?BCB                         
CMPLE?BCL                         
CMPLEB                            000010BC
CMPLEB_USED                       00000001
CMPLEW                            000010BE
CMPLEW_USED                       00000001
CMPLE_USED                        00000001
CMPNE?BCL                         
CMP_USED                          00000001
CONFIGURED_STATE                  0x20
CRC16EE                           00000002
CRC16EF                           00000002
CRC5EE                            00000001
CRC5EF                            00000001
CREN                              00000004
CSRC                              00000007
CTRL_TRF_RX                       2
CTRL_TRF_TX                       1
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000004
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CVRSS                             00000004
Cnt                               1
Config1                           000019CA
Config1Len                        000019CE
Configs                           000019C6
CtrlTrfData                       00000466
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DEBUG                             00001006
DEBUG?C                           
DEBUGCOUNT?C                      
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 383


SYMBOL TABLE
  LABEL                             VALUE 

DEBUGDELAY_USED                   00000001
DEBUGHEX?                         
DEBUGIN_BIT                       00000000
DEBUGIN_MODE                      00000001
DEBUGIN_REG                       00000F80
DEBUGJ                            00001004
DEBUGJ_USED                       00000001
DEBUGNUM?B                        
DEBUG_BAUD                        9600
DEBUG_BIT                         0
DEBUG_DELAY                       00000067
DEBUG_MODE                        1
DEBUG_REG                         PORTA
DEBUG_USED                        00000001
DEFAULT_STATE                     0x04
DETACHED_STATE                    0x00
DEVICE_REMOTE_WAKEUP              0x01
DEV_TO_HOST                       1
DFN8EE                            00000003
DFN8EF                            00000003
DIR                               00000002
DIV                               000010F4
DIV32DIV                          000010F8
DIV_USED                          00000001
DONE                              00000001
DSC_HID                           0x21
DSC_PHY                           0x23
DSC_RPT                           0x22
DTS                               6
DTSEN                             3
DUNN                              0000116C
DUNN5                             0000116E
DUNN_USED                         00000001
D_A                               00000005
DataDir                           7
DeviceDescriptor                  000019A2
ECCP1AS                           00000FB6
ECCP1DEL                          00000FB7
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
EEPROM_START                      00F00000
ENDASM?                           
ENDP0                             00000003
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 384


SYMBOL TABLE
  LABEL                             VALUE 

ENDP1                             00000004
ENDP2                             00000005
ENDP3                             00000006
ENDPOINT_HALT                     0x00
EPCONDIS                          00000003
EPDir                             7
EPHSHK                            00000004
EPINEN                            00000001
EPNum                             0
EPOUTEN                           00000002
EPSTALL                           00000000
EP_CTRL                           0x06
EP_IN                             0x0A
EP_OUT                            0x0C
EP_OUT_IN                         0x0E
EndConfig1                        00001A1C
EndDeviceDescriptor               000019C6
EndPoint1Out                      00001A0E
EndReportDescriptor1              00001A6C
Endpoint1In                       00001A00
FAST                              00000001
FERR                              00000002
FLAGS                             00000000
FLTS                              00000002
FREE                              00000004
FRM0                              00000000
FRM1                              00000001
FRM10                             00000002
FRM2                              00000002
FRM3                              00000003
FRM4                              00000004
FRM5                              00000005
FRM6                              00000006
FRM7                              00000007
FRM8                              00000000
FRM9                              00000001
FSEN                              00000002
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GCEN                              00000007
GET_CFG                           8
GET_DSC                           6
GET_IDLE                          0x02
GET_INTF                          10
GET_PROTOCOL                      0x03
GET_REPORT                        0x01
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 385


SYMBOL TABLE
  LABEL                             VALUE 

GET_STATUS                        0
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GO                                00000001
GOP                               00000019
GOSUB?L                           
GOTO?L                            
GO_DONE                           00000001
GetPutUSBZero                     000017FE
GetUSB                            000017B8
GetUSBLoop                        000017F6
GetUSBNotReady                    000017D8
HIDDescriptor1                    000019EE
HIDGetReportHandler               00001958
HIDSetReportHandler               0000195A
HID_EP                            1
HID_INTF                          0x03
HID_INTF_ID                       0x00
HID_INT_IN_EP_SIZE                64
HID_INT_OUT_EP_SIZE               64
HID_NUM_OF_DSC                    1
HID_PROTOCOL_KEYBOARD             0x01
HID_PROTOCOL_MOUSE                0x02
HID_PROTOCOL_NONE                 0x00
HIGH?T                            
HLVDCON                           00000FD2
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
HLVDIN                            00000005
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
HLVDL3                            00000003
HOST_TO_DEV                       0
HSER2_BAUD                        00000960
HSER2_BITS                        00000008
HSER2_RCSTA                       00000090
HSER2_SPBRG                       00000138
HSER2_TXSTA                       00000020
HSER_BAUD                         00000960
HSER_BITS                         00000008
HSER_PORT                         00000001
HSER_RCSTA                        00000090
HSER_SPBRG                        00000138
HSER_TXSTA                        00000020
I2CFIRSTFLAG                      FLAGS, 2
I2CREADFLAG                       FLAGS, 3
I2CSTOPFLAG                       FLAGS, 5
I2CSTOPSTRFLAG                    FLAGS, 6
I2CWRITEFLAG                      FLAGS, 4
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 386


SYMBOL TABLE
  LABEL                             VALUE 

I2C_DAT                           00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IDLEIE                            00000004
IDLEIF                            00000004
IDLEN                             00000007
INCDIS                            4
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INIT                              00001172
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTSRC                            00000007
IN_TOKEN                          0x09
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRVST                             00000005
IVRST                             00000005
Interface1                        000019DC
JUMPMAN                           00001160
JUMPMAN_USED                      00000001
KEN                               5
L00001                            00002410
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 387


SYMBOL TABLE
  LABEL                             VALUE 

L00002                            0000244E
L00003                            0000248C
L00004                            000024CA
L00005                            00002508
L00006                            00002546
L00007                            00002584
L00008                            000025C2
L00009                            00001C46
L00010                            00001C80
L00011                            00001C90
L00012                            00001CA2
L00013                            00001CFC
L00015                            00001D56
L00017                            00001DFE
L00018                            0000223A
L00019                            00001E1E
L00021                            00001E2E
L00023                            00001E3E
L00025                            00001E4E
L00027                            00001E5E
L00029                            00001E6E
L00031                            00001E7E
L00033                            00001E8E
L00035                            00001F24
L00037                            00001F90
L00039                            0000200A
L00041                            00002078
L00043                            000020E4
L00045                            00002152
L00047                            000021C0
L00049                            0000222C
L00051                            000022E4
L00052                            00002326
L?CALL                            
L?GOTO                            
LABEL?L                           
LAND                              000010E6
LAND?BBW                          
LAND?WBW                          
LAND_USED                         00000001
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 388


SYMBOL TABLE
  LABEL                             VALUE 

LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC6                             00000006
LATC7                             00000007
LCDCDFLAG                         FLAGS, 0
LCDINITFLAG                       FLAGS, 1
LCD_BITS                          00000004
LCD_COMMANDUS                     000007D0
LCD_DATAUS                        00000032
LCD_DBIT                          00000000
LCD_DREG                          00000F80
LCD_EBIT                          00000003
LCD_EREG                          00000F81
LCD_LINES                         00000002
LCD_RSBIT                         00000004
LCD_RSREG                         00000F80
LCD_RWBIT                         00000004
LCD_RWREG                         00000F80
LOOKUP?BCLB                       
LOW?T                             
LURET?C                           
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
LVV0                              00000000
LVV1                              00000001
LVV2                              00000002
LVV3                              00000003
MOD?BBW                           
MOVE?AB                           
MOVE?AT                           
MOVE?AW                           
MOVE?AWW                          
MOVE?BA                           
MOVE?BB                           
MOVE?BT                           
MOVE?BW                           
MOVE?CA                           
MOVE?CB                           
MOVE?CT                           
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 389


SYMBOL TABLE
  LABEL                             VALUE 

MOVE?CW                           
MOVE?TA                           
MOVE?TB                           
MOVE?TT                           
MOVE?TW                           
MOVE?WA                           
MOVE?WB                           
MOVE?WT                           
MOVE?WW                           
MOVE?WWA                          
MUL                               00001124
MUL?BBW                           
MUL_USED                          00000001
N                                 00000004
NEXT?BCL                          
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_IPEN                          00000007
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RI                            00000004
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_W                             00000002
NOT_WRITE                         00000002
NUM_CONFIGURATIONS                1
NUM_INTERFACES                    1
OERR                              00000001
OSC                               48
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUNE                           00000F9B
OSC_VALID                         00000001
OSTS                              00000003
OUT_TOKEN                         0x01
OV                                00000003
P                                 00000004
P1A                               00000002
PAUSE                             00001080
PAUSE?C                           
PAUSEL                            00001082
PAUSEUS                           0000109A
PAUSEUSL                          0000109C
PAUSEUS_USED                      00000001
PAUSE_DELAY                       000003E7
PAUSE_USED                        00000001
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 390


SYMBOL TABLE
  LABEL                             VALUE 

PB01                              00000020
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PEIE                              00000006
PEN                               00000002
PGC                               00000006
PGD                               00000007
PGM                               00000005
PID                               2
PIDEE                             00000000
PIDEF                             00000000
PIE1                              00000F9D
PIE2                              00000FA0
PIR                               00000F9E
PIR1                              00000F9E
PIR2                              00000FA1
PKTDIS                            00000004
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
POWERED_STATE                     0x02
PPB0                              00000000
PPB1                              00000001
PPBI                              00000001
PPBRST                            00000006
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PREV_ALT                          00000000
PREV_BANK                         00000000
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEN                             00000007
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 391


SYMBOL TABLE
  LABEL                             VALUE 

PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PutUSB                            0000180E
PutUSBLoop                        0000184C
PutUSBNotReady                    0000182E
R                                 00000002
R0                                00000001
R1                                00000003
R2                                00000005
R3                                00000007
R4                                00000009
R5                                0000000B
R6                                0000000D
R7                                0000000F
R8                                00000011
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RAM_BANKS                         00000008
RAM_END                           000007FF
RAM_START                         00000000
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCPT_DEV                          0
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 392


SYMBOL TABLE
  LABEL                             VALUE 

RCPT_EP                           2
RCPT_INTF                         1
RCPT_OTH                          3
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD16                              00000007
RE3                               00000003
READ_WRITE                        00000002
RESET_ORG                         1000h
RESUME                            00000002
RETURN?                           
RI                                00000004
RM1                               0000001A
RM2                               0000001B
RPT_PROTOCOL                      0x01
RR1                               0000001C
RR2                               0000001D
RS1                               0000001E
RS2                               0000001F
RSEN                              00000001
RST?RP                            
RX                                00000007
RX9                               00000006
RX9D                              00000000
RXDTP                             00000005
R_W                               00000002
Recipient                         0
RemoteWakeup                      00000425
ReportDescriptor1                 00001A1C
ReportDescriptor1Len              000019FC
RequestType                       5
S                                 00000003
SBOREN                            00000006
SCKP                              00000004
SCS0                              00000000
SCS1                              00000001
SE0                               00000005
SEN                               00000000
SENDB                             00000003
SEROUT2HEX                        0000103A
SEROUT2HEX_USED                   00000001
SEROUT2SEND                       00001060
SEROUT2SEND_USED                  00000001
SETUP_TOKEN                       0x0D
SET_ADR                           5
SET_CFG                           9
SET_DSC                           7
SET_FEATURE                       3
SET_IDLE                          0x0A
SET_INTF                          11
SET_PROTOCOL                      0x0B
SET_REPORT                        0x09
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 393


SYMBOL TABLE
  LABEL                             VALUE 

SHORT_PKT_NOT_USED                0
SHORT_PKT_PENDING                 1
SHORT_PKT_SENT                    2
SMP                               00000007
SOFIE                             00000006
SOFIF                             00000006
SPBRG                             00000FAF
SPBRGH                            00000FB0
SPEN                              00000007
SREN                              00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STALLIE                           00000005
STALLIF                           00000005
STANDARD                          0x00
STATUS                            00000FD8
STKFUL                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SUB?BBW                           
SUB?BCB                           
SUSPND                            00000001
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
SYNCH_FRAME                       12
SetupPkt                          00000426
Stat                              0
String0                           00001A7C
String1                           00001A84
String2                           00001AA4
String3                           00001AC0
String4                           00001AD4
Strings                           00001A6C
T08BIT                            00000006
T0CKI                             00000004
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 394


SYMBOL TABLE
  LABEL                             VALUE 

T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T1                                00000013
T13CKI                            00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2                                00000015
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T3                                00000017
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3NSYNC                           00000002
T3SYNC                            00000002
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 395


SYMBOL TABLE
  LABEL                             VALUE 

TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC6                            00000006
TRISC7                            00000007
TRMT                              00000001
TRNIE                             00000003
TRNIF                             00000003
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX                                00000006
TX9                               00000006
TX9D                              00000000
TXCKP                             00000004
TXEN                              00000005
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 396


SYMBOL TABLE
  LABEL                             VALUE 

TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXSTA                             00000FAC
UA                                00000001
UADDR                             00000F6E
UCFG                              00000F6F
UCFG_VAL                          USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_FULL_SPEED|USB_PING_PONG__NO_PING_PONG
UCON                              00000F6D
UEIE                              00000F6B
UEIR                              00000F6A
UEP0                              00000F70
UEP1                              00000F71
UEP10                             00000F7A
UEP11                             00000F7B
UEP12                             00000F7C
UEP13                             00000F7D
UEP14                             00000F7E
UEP15                             00000F7F
UEP2                              00000F72
UEP3                              00000F73
UEP4                              00000F74
UEP5                              00000F75
UEP6                              00000F76
UEP7                              00000F77
UEP8                              00000F78
UEP9                              00000F79
UEP_STALL                         0x0001
UERRIE                            00000001
UERRIF                            00000001
UFRM                              00000F66
UFRMH                             00000F67
UFRML                             00000F66
UIE                               00000F69
UIR                               00000F68
UOEMON                            00000006
UOWN                              7
UPUEN                             00000004
URSTIE                            00000000
URSTIF                            00000000
USBActiveConfiguration            00000418
USBAlternateInterface             00000419
USBCBCheckOtherReq                00001964
USBCBErrorHandler                 00001962
USBCBInitEP                       00001968
USBCBSendResume                   0000198C
USBCBSendResumeLoop               00001996
USBCBStdSetDscHandler             00001966
USBCBSuspend                      0000195C
USBCBWakeFromSuspend              0000195E
USBCB_SOF_Handler                 00001960
USBCalcEPAddress                  00001468
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 397


SYMBOL TABLE
  LABEL                             VALUE 

USBCheckHIDRequest                00001856
USBCheckHIDRequest1               000018A0
USBCheckHIDRequest2               000018DA
USBCheckHIDRequestClass           000018E4
USBCheckHIDRequestClass1          00001918
USBCheckHIDRequestClass2          00001928
USBCheckHIDRequestClass3          00001948
USBCheckHIDRequestExit            00001864
USBCheckStdRequest                0000137E
USBCheckStdRequest1               00001396
USBCheckStdRequest3               000013A4
USBCheckStdRequest4               000013C2
USBCheckStdRequest5               000013CA
USBCheckStdRequest8               000013F8
USBCheckStdRequest9               0000140C
USBCheckStdRequestExit            00001394
USBCtrlEPService                  000012A0
USBCtrlEPService1                 000012B4
USBCtrlEPServiceComplete          00001592
USBCtrlEPServiceComplete0         000015BA
USBCtrlEPServiceComplete1         000015D0
USBCtrlEPServiceComplete11        000015EE
USBCtrlEPServiceComplete2         00001614
USBCtrlEPServiceCompleteCopy      000015E6
USBCtrlTrfInHandler               000012E4
USBCtrlTrfInHandler1              00001300
USBCtrlTrfInHandler2              0000131E
USBCtrlTrfOutHandler              000012DA
USBCtrlTrfRxService               000016CE
USBCtrlTrfRxService1              000016DE
USBCtrlTrfRxService2              0000171E
USBCtrlTrfRxServiceExit           00001706
USBCtrlTrfRxServiceLoop           000016F6
USBCtrlTrfSetupHandler            000012BE
USBCtrlTrfTxService               00001630
USBCtrlTrfTxServiceExit           000016CC
USBCtrlTrfTxServiceGreater        0000165E
USBCtrlTrfTxServiceNotEQ          00001644
USBCtrlTrfTxServiceNotEQ1         00001652
USBCtrlTrfTxServiceNotLess        00001666
USBCtrlTrfTxServiceRam            000016B0
USBCtrlTrfTxServiceRamLoop        000016B8
USBCtrlTrfTxServiceRomLoop        00001692
USBDeviceInit                     00001176
USBDeviceInitEPLoop               0000118A
USBDeviceInitFlush1               000011A4
USBDeviceInitFlushLoop            00001196
USBDeviceState                    00000417
USBDeviceTasks                    000011BE
USBDeviceTasks1                   000011FA
USBDeviceTasks2                   0000121E
USBDeviceTasks3                   0000122A
USBDeviceTasks4                   00001236
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 398


SYMBOL TABLE
  LABEL                             VALUE 

USBDeviceTasks5                   0000123E
USBDeviceTasks6                   0000124A
USBDeviceTasks7                   0000125C
USBDeviceTasksA                   000011F2
USBDeviceTasksCDLoop              000011CA
USBDeviceTasksCheckAttached       000011DA
USBDeviceTasksCheckDetached       000011C0
USBDriverTasksExit                0000126C
USBEN                             00000003
USBEnableEndpointIn               0000178C
USBEnableEndpointOut              00001758
USBIE                             00000005
USBIF                             00000005
USBIN?CBBL                        
USBINIT?                          
USBIP                             00000005
USBOUT?CBBL                       
USBPrepareForNextSetupTrf         00001328
USBPrepareForNextSetupTrf1        00001362
USBPrepareForNextSetupTrf2        0000137A
USBPrepareForNextSetupTrfLoop     00001358
USBRxOnePacket                    000017B8
USBSERVICE?                       
USBStallEndpoint1                 000017B8
USBStallHandler                   0000126E
USBStallHandlerExit               00001286
USBStdFeatureReqHandler           00001414
USBStdFeatureReqHandler1          0000142E
USBStdFeatureReqHandler2          00001452
USBStdFeatureReqHandlerExit       00001432
USBStdGetDscHandler               00001478
USBStdGetDscHandler1              000014AC
USBStdGetDscHandler2              000014FC
USBStdGetDscHandler3              0000153E
USBStdGetStatusHandler            00001542
USBStdGetStatusHandler1           00001558
USBStdGetStatusHandler2           00001564
USBStdGetStatusHandlerExit        00001578
USBStdSetCfgHandler               0000172A
USBStdSetCfgHandler1              00001752
USBStdSetCfgHandlerClearAltLoop   00001740
USBStdSetCfgHandlerClearEPLoop    00001734
USBSuspend                        0000128A
USBTxOnePacket                    0000180E
USBWakeFromSuspend                00001292
USBWakeFromSuspendLoop            00001298
USB_ALLOW_SETUP                   0x00
USB_CD_Ptr                        000019C6
USB_DESCRIPTOR_CONFIGURATION      0x02
USB_DESCRIPTOR_DEVICE             0x01
USB_DESCRIPTOR_DEVICE_QUALIFIER   0x06
USB_DESCRIPTOR_ENDPOINT           0x05
USB_DESCRIPTOR_INTERFACE          0x04
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 399


SYMBOL TABLE
  LABEL                             VALUE 

USB_DESCRIPTOR_INTERFACE_POWER    0x08
USB_DESCRIPTOR_OTG                0x09
USB_DESCRIPTOR_OTHER_SPEED        0x07
USB_DESCRIPTOR_STRING             0x03
USB_DISALLOW_SETUP                0x08
USB_EP0_BUFF_SIZE                 64
USB_EP0_BUSY                      USB_INPIPES_BUSY
USB_EP0_INCLUDE_ZERO              USB_INPIPES_INCLUDE_ZERO
USB_EP0_NO_DATA                   USB_INPIPES_NO_DATA
USB_EP0_NO_OPTIONS                USB_INPIPES_NO_OPTIONS
USB_EP0_RAM                       USB_INPIPES_RAM
USB_EP0_ROM                       USB_INPIPES_ROM
USB_EXTERNAL_TRANSCEIVER          0x08
USB_FULL_SPEED                    0x04
USB_HANDSHAKE_DISABLED            0x00
USB_HANDSHAKE_ENABLED             0x10
USB_INPIPES_BUSY                  0x80
USB_INPIPES_INCLUDE_ZERO          0x40
USB_INPIPES_NO_DATA               0x00
USB_INPIPES_NO_OPTIONS            0x00
USB_INPIPES_RAM                   0x01
USB_INPIPES_ROM                   0x00
USB_INTERNAL_TRANSCEIVER          0x00
USB_IN_DISABLED                   0x00
USB_IN_ENABLED                    0x02
USB_LOW_SPEED                     0x00
USB_MAX_EP_NUMBER                 1
USB_MAX_NUM_INT                   1
USB_OUT_DISABLED                  0x00
USB_OUT_ENABLED                   0x04
USB_PING_PONG__ALL_BUT_EP0        0x03
USB_PING_PONG__EP0_OUT_ONLY       0x01
USB_PING_PONG__FULL_PING_PONG     0x02
USB_PING_PONG__NO_PING_PONG       0x00
USB_POLLING                       
USB_PULLUP_DISABLED               0x00
USB_PULLUP_ENABLE                 0x10
USB_SD_Ptr                        00001A6C
USB_STALL_ENDPOINT                0x01
USB_USE_HID                       
USTAT                             00000F6C
USTAT_EP0_IN                      0x04
USTAT_EP0_OUT                     0x00
USTAT_EP0_PP_MASK                 ~0x02
USTAT_EP_MASK                     0x7E
USTATcopy                         00000420
UTEYE                             00000007
UTRDIS                            00000003
VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VENDOR                            0x02
VREFM                             00000002
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 400


SYMBOL TABLE
  LABEL                             VALUE 

VREFP                             00000003
W                                 00000000
WAIT_SETUP                        0
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WUE                               00000001
Z                                 00000002
_BORV_0_2L                        000000E7
_BORV_1_2L                        000000EF
_BORV_2_2L                        000000F7
_BORV_3_2L                        000000FF
_BOR_OFF_2L                       000000F9
_BOR_ON_2L                        000000FF
_BOR_ON_ACTIVE_2L                 000000FD
_BOR_SOFT_2L                      000000FB
_BSTALL                           0x04
_BULK                             0x02
_CCP2MX_OFF_3H                    000000FE
_CCP2MX_ON_3H                     000000FF
_CONFIG1H                         00300001
_CONFIG1L                         00300000
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
_CPUDIV_OSC1_PLL2_1L              000000E7
_CPUDIV_OSC2_PLL3_1L              000000EF
_CPUDIV_OSC3_PLL4_1L              000000F7
_CPUDIV_OSC4_PLL6_1L              000000FF
_CTRL                             0x00
_DAT0                             0x00
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 401


SYMBOL TABLE
  LABEL                             VALUE 

_DAT1                             0x40
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEFAULT                          (0x01<<7)
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_DTSEN                            0x08
_DTSMASK                          0x40
_DoUSBIn                          0000234A
_DoUSBOut                         00002390
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_EP_IN                            0x80
_EP_OUT                           0x00
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_FOSC_ECIO_EC_1H                  000000F4
_FOSC_ECPLLIO_EC_1H               000000F6
_FOSC_ECPLL_EC_1H                 000000F7
_FOSC_EC_EC_1H                    000000F5
_FOSC_HSPLL_HS_1H                 000000FE
_FOSC_HS_1H                       000000FC
_FOSC_INTOSCIO_EC_1H              000000F8
_FOSC_INTOSC_EC_1H                000000F9
_FOSC_INTOSC_HS_1H                000000FB
_FOSC_INTOSC_XT_1H                000000FA
_FOSC_XTPLL_XT_1H                 000000F2
_FOSC_XT_XT_1H                    000000F0
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_INCDIS                           0x10
_INT                              0x03
_ISO                              0x01
_KEN                              0x20
_LPT1OSC_OFF_3H                   000000FB
_LPT1OSC_ON_3H                    000000FF
_LVP_OFF_4L                       000000FB
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 402


SYMBOL TABLE
  LABEL                             VALUE 

_LVP_ON_4L                        000000FF
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_PBADEN_OFF_3H                    000000FD
_PBADEN_ON_3H                     000000FF
_PLLDIV_10_1L                     000000FE
_PLLDIV_12_1L                     000000FF
_PLLDIV_1_1L                      000000F8
_PLLDIV_2_1L                      000000F9
_PLLDIV_3_1L                      000000FA
_PLLDIV_4_1L                      000000FB
_PLLDIV_5_1L                      000000FC
_PLLDIV_6_1L                      000000FD
_PORTB??0                         PORTB, 000h
_PORTB??1                         PORTB, 001h
_PORTB??2                         PORTB, 002h
_PORTB??3                         PORTB, 003h
_PORTB??4                         PORTB, 004h
_PORTB??5                         PORTB, 005h
_PORTB??6                         PORTB, 006h
_PORTB??7                         PORTB, 007h
_PORTH                            00000F82
_PORTL                            00000F81
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_ProgramStart                     00001C10
_RWU                              (0x01<<5)
_SELF                             (0x01<<6)
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_TRISH                            00000F94
_TRISL                            00000F93
_UCPU                             0x00
_USBBuffer                        00000028
_USBBufferCount                   00000026
_USBBufferSizeMax                 00000008
_USBBufferSizeRX                  00000008
_USBBufferSizeTX                  00000008
_USBBufferaux                     00000030
_USBDIV_1_1L                      000000DF
_USBDIV_2_1L                      000000FF
_USBMEMORYADDRESS                 00000400
_USBMEMORYSIZE                    00000100
_USBReservedMemory                00000400
_USED                             00000001
_USIE                             0x80
_VREGEN_OFF_2L                    000000DF
_VREGEN_ON_2L                     000000FF
_WDTPS_1024_2H                    000000F5
_WDTPS_128_2H                     000000EF
_WDTPS_16384_2H                   000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1_2H                       000000E1
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 403


SYMBOL TABLE
  LABEL                             VALUE 

_WDTPS_2048_2H                    000000F7
_WDTPS_256_2H                     000000F1
_WDTPS_2_2H                       000000E3
_WDTPS_32768_2H                   000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4096_2H                    000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8192_2H                    000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XINST_OFF_4L                     000000BF
_XINST_ON_4L                      000000FF
__18F2550                         00000001
_aux                              00000021
_buscar1                          000023D4
_buscar2                          00002412
_buscar3                          00002450
_buscar4                          0000248E
_buscar5                          000024CC
_buscar6                          0000250A
_buscar7                          00002548
_buscar8                          00002586
_hid_desc_end                     00001AD4
_i                                00000022
_pin1                             PB01, 000h
_pos                              00000023
_sw1                              00000024
_temp                             00000025
_var1                             00000027
active_protocol                   000004A7
bAltID                            2
bAltID_H                          3
bCfgRSD                           3
bConfigurationValue               2
bDescriptorType                   3
bDevADR                           2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 404


SYMBOL TABLE
  LABEL                             VALUE 

bDevADRH                          3
bDscIndex                         2
bEPID                             4
bEPID_H                           5
bFeature                          2
bIntfID                           4
bIntfID_H                         5
bReportID                         2
bReportType                       3
bRequest                          1
bTRNIFCount                       00000422
bmRequestType                     0
busy                              7
cmpnoteq                          000010D2
controlTransferState              0000041A
ctrl_trf_mem                      0
debugbh                           0000102C
debugbit                          00001022
debugdelay                        00001030
debugloop                         00001010
divloop                           000010FC
divok                             00001116
ep0Bi                             00000404
ep0Bo                             00000400
ep1Bi                             0000040C
ep1Bo                             00000408
hid_report_in                     000004E9
hid_report_out                    000004A8
idle_rate                         000004A6
inCount                           0000041B
includeZero                       6
info                              00000423
lastDTS                           00000421
mGetRomTableCount                 
mSetDestinationPointer            
mSetSourcePointer                 
main                              00001172
outCount                          0000041D
outfo                             00000424
pDst                              00000415
pSrc                              00000412
pauseloop                         00001084
pauseusloop                       000010A0
serout2hdig                       00001054
serout2send1                      00001070
shortPacketStatus                 0000041F
usb_temp                          00000410
wIndex                            4
wLangID                           4
wLength                           6
wValue                            2
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 405


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
13C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
14C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
15C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
16C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
17C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
18C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
19C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 406


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


1B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
20C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
21C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
22C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
23C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
24C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
2580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
25C0 : XXXX------------ ---------------- ---------------- ----------------
0000 : XXXXXXXX-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  5580
Program Memory Bytes Free: 27188


MPASM  5.35                      ORIGUS~1.ASM   5-5-2014  17:06:04         PAGE 407





Errors   :     0
Warnings :     0 reported,     6 suppressed
Messages :     0 reported,     0 suppressed

